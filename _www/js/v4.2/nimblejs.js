// NimbleJS Build #381 on 05/02/2024 10:02 AM.
'use strict';function cU(bq){Object.freeze(bq);Object.seal(bq);return bq;};function _secureacct(_prot){var fld,sv=cU||_prot;if(!USER.acct){USER.acct={};}for(fld in USER){if(['acct','_libs'].indexOf(fld)== -1){USER.acct[fld]=USER[fld];delete USER[fld];}}sv(USER.acct);cU=null;return sv;};if(typeof(DESKTOP)=='undefined'){var DESKTOP={};}if(typeof(KERNEL)=='undefined'){var KERNEL={};}String.prototype.isJSON=function(){var str=this.valueOf();try{JSON.parse(str);}catch(e){return false;}return true;};String.prototype.left=function(width){var n=this.valueOf();return n.substr(0,width);};String.prototype.right=function(width){var n=this.valueOf();return n.substr(n.length-width,width);};String.prototype.lPad=function(chr,width){var n=this.valueOf();chr=chr||'0';return n.length>=width?n:new Array(width-n.length+1).join(chr)+n;};String.prototype.rPad=function(chr,width){var n=this.valueOf();chr=chr||'0';return n.length>=width?n:n+new Array(width-n.length+1).join(chr);};String.prototype.serialize=function(){var strval=this.valueOf();var i,F,ret="";F=strval.length;for(i=0;i<F;++i){switch(strval[i]){case ":":case "[":case "]":case "~":case "(":case ")":case ".":ret+='-';break;default:ret+=strval[i];break;}}return ret;};String.prototype.jQryName=function(){var strval=this.valueOf();var i,F,ret="";F=strval.length;for(i=0;i<F;++i){switch(strval[i]){case ":":ret+='-';break;case "[":case "]":case "~":case "(":case ")":case ".":ret+='\\'+strval[i];break;default:ret+=strval[i];break;}}return ret;};String.prototype.item=function(bS){var strval=this.valueOf();return strval+'('+bS+')';};String.prototype.nav=function(bq,delim,blExact){delim=delim||".";var navstr=this.valueOf();var isNav=navstr.indexOf('.')> -1,bZ=navstr.split(delim);var err=false,index=0,field='',chk,ct=bq||{};for(var x=0;x<bZ.length;x++){if(bZ[x].indexOf('[')> -1){field=bZ[x].split('[')[0];index=Number(bZ[x].split('[')[1].split(']')[0]);chk=(ct&& !$nim.undef(ct[field])&& !$nim.undef(ct[field][index]));ct=chk?ct[field][index]:blExact?"":undefined;if(!chk&& !err){err=true;if(isNav)console.warn('NIMJS:* Object Nav Failed : "'+navstr+'"');}}else{chk=(ct&& !$nim.undef(ct[bZ[x]]));ct=chk?ct[bZ[x]]:blExact?"":undefined;if(!chk&& !err){err=true;if(isNav)console.warn('NIMJS:* Object Nav Failed : "'+navstr+'"');}}}return ct;};String.prototype.resolveName=function(field){var bq,bZ,prefx,af,ret='',tmp,iname=this.valueOf();bq={id:iname,App:"",AppIndex:0,Form:"",FormIndex:0,Control:"",ControlIndex: -1,Component:"",ListIndex: -1,ItemName:""};if(!$nim.undef(iname)){if(iname.indexOf($nim.bs)> -1){tmp=$nim.G.getStrParam(iname,'~');bq.App=tmp.item.split($nim.as)[0];bq.AppIndex=tmp.item.split($nim.as)[1]?dA(tmp.item.split($nim.as)[1]):0;tmp=$nim.G.getStrParam(tmp.remainder,'.');bq.Form=tmp.item.split($nim.dP)[0];bq.FormIndex=tmp.item.split($nim.dP)[1]?dA(tmp.item.split($nim.dP)[1]):0;}else{tmp=$nim.G.getStrParam(iname,'.');}if((tmp.item.indexOf($nim.cb)> -1)&& !bq.Form){bq.Form=tmp.item.split($nim.dP)[0];bq.FormIndex=tmp.item.split($nim.dP)[1]?dA(tmp.item.split($nim.dP)[1]):0;}if(bq.Form){bq.InstForm=bq.Form+'('+bq.FormIndex+')';}tmp=tmp.remainder;if(tmp.split($nim.aY)[0]=='page'&&tmp.split($nim.aY)[1]=='back'){bq.Control=tmp.split($nim.aY)[0]?tmp.split($nim.aY)[0]:'';bq.Control+=tmp.split($nim.aY)[1]?$nim.aY+tmp.split($nim.aY)[1]:'';bq.Control+=tmp.split($nim.aY)[2]?$nim.aY+tmp.split($nim.aY)[2]:'';}else{bq.Control=tmp.split($nim.aY)[0]?tmp.split($nim.aY)[0]:'';bq.Component=tmp.split($nim.aY)[1]?tmp.split($nim.aY)[1]:'';bq.Property=tmp.split($nim.aY)[2]?tmp.split($nim.aY)[2]:'';}if(iname.indexOf($nim.aY+"item"+$nim.aY)> -1){bq.isListItem=true;tmp=iname.split($nim.aY+"item"+$nim.aY)[1];bq.ItemName=tmp.split($nim.aY)[0];bq.Property=tmp.split($nim.aY)[1];}else{bq.isListItem=false;bq.ItemName="";bq.ListIndex= -1;}if(bq.Control&&bq.Control.indexOf('(')> -1){bZ=bq.Control.split(/[()]/);if(bZ[1]){bq.ControlIndex=Number(bZ[1]);}}}switch(field){case 'controlDiv':case 'ctrlDiv':ret=(iname.indexOf('.div')== -1)?iname+'.div':iname;break;case 'controlName':case 'ctrlName':ret=$nim.aX($nim.aY+"div",'',iname);break;case 'isValid':ret=(bq.App||bq.Form||bq.Control)?true:false;break;case 'app':ret=bq.App?bq.App:'';break;case 'appindex':ret=bq.AppIndex?bq.AppIndex:0;break;case 'form':ret=bq.Form?bq.Form:'';break;case 'formindex':ret=bq.FormIndex?bq.FormIndex:0;break;case 'basectrl':ret=(bq.Control?bq.Control.split('(')[0]:'').split(':')[0];break;case 'control':ret=bq.Control?bq.Control:'';break;case 'controlindex':ret=bq.ControlIndex?bq.ControlIndex: -1;break;case 'component':ret=bq.Component?bq.Component:'';break;case 'property':ret=bq.Property?bq.Property:'';break;case 'itemname':ret=bq.ItemName?bq.ItemName:'';break;case 'listindex':ret=bq.ListIndex?bq.ListIndex: -1;break;case 'appinst':case 'instname':ret=bq.App+'['+bq.AppIndex+']';break;case 'instform':ret=bq.Form+'('+bq.FormIndex+')';break;case 'forminst':ret=bq.App+'['+bq.AppIndex+']'+$nim.bs+bq.Form+'('+bq.FormIndex+')';break;case 'instctrl':case 'ctrlinst':ret+=bq.Control?(bq.Control+$nim.aY):'';ret+=bq.Component?(bq.Component+$nim.aY):'';ret+=bq.Property?(bq.Property+$nim.aY):'';ret=(ret.right(1)==$nim.aY)?ret.left(ret.length-1):ret;break;case 'ctrlitem':ret+=bq.Control?(bq.Control+$nim.aY):'';ret+=bq.Component?(bq.Component+$nim.aY):'';ret+=bq.ItemName?(bq.ItemName+$nim.aY):'';ret+=bq.Property?(bq.Property+$nim.aY):'';ret=(ret.right(1)==$nim.aY)?ret.left(ret.length-1):ret;break;case 'compinst':ret+=bq.Control?(bq.Control+$nim.aY):'';ret+=bq.Component?(bq.Component+$nim.aY):'';ret=(ret.right(1)==$nim.aY)?ret.left(ret.length-1):ret;break;default:ret=bq;break;}if(typeof(ret)=='object'&&ret.Control){prefx=ret.Control.indexOf(':')> -1?(ret.Control.split(':')[0]+':'):'';af=prefx?ret.Control.split(':').pop():ret.Control;ret.BaseControl=prefx+af.split('(')[0];}return ret;};Date.prototype.Format=function(pattern){var months=["January","February","March","April","May","June","July","August","September","October","November","December"];var days=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];var YYYY,YY,MMMM,MMM,MM,M,DDDD,DDD,DD,D;var hhhh,hhh,hh,h,mm,m,ss,s,ampm,AMPM;YY=((YYYY=this.getFullYear())+"").slice(-2);MM=((M=this.getMonth()+1)<10)?('0'+M):M;MMM=(MMMM=months[M-1]).substring(0,3);DD=((D=this.getDate())<10)?('0'+D):D;DDD=(DDDD=days[this.getDay()]).substring(0,3);pattern=pattern.replace("#YY#",YY).replace("#YYYY#",YYYY).replace("#M#",M).replace("#MM#",MM).replace("#MMM#",MMM).replace("#MMMM#",MMMM).replace("#D#",D).replace("#DD#",DD).replace("#DDD#",DDD).replace("#DDDD#",DDDD);h=(hhh=this.getHours());if(h===0){h=24;}if(h>12){h-=12;}hh=(h<10)?('0'+h):h;hhhh=(hhh<10)?('0'+hhh):hhh;AMPM=(ampm=(hhh<12)?'am':'pm').toUpperCase();mm=((m=this.getMinutes())<10)?('0'+m):m;ss=((s=this.getSeconds())<10)?('0'+s):s;return pattern.replace("#h#",h).replace("#hh#",hh).replace("#hhh#",hhh).replace("#hhhh#",hhhh).replace("#m#",m).replace("#mm#",mm).replace("#s#",s).replace("#ss#",ss).replace("#ampm#",ampm).replace("#AMPM#",AMPM);};var event;function dA(val){return(val&&val.indexOf&&val.indexOf('calc')> -1)?val:parseInt(val,10);};if(!$nim){var $nim={_:{}};}if(!$nim._){$nim._={};}if(!$heap){var $heap={};}$heap._validate=function(f1,f2,f3,f4,f5,f6){var ret=true;if(f1&& !$heap[f1]){return false;}if(f2&& !$heap[f1][f2]){return false;}if(f3&& !$heap[f1][f2][f3]){return false;}if(f4&& !$heap[f1][f2][f3][f4]){return false;}if(f5&& !$heap[f1][f2][f3][f4][f5]){return false;}if(f6&& !$heap[f1][f2][f3][f4][f5][f6]){return false;}return ret;};$nim.security={};$nim.security.level=1;$nim.security.login="";$nim.security.email="";$nim.security.ip=null;$nim.animFn=function(anim){if(anim.pos==100){console.log("Anim '"+anim.dialog+"' completed.");}};$nim._.filter={filtered:[],bZ:[]};$nim._.sorter={bZ:[],index:'',sorttype:''};$nim._.cgi={count:0,running:false,sequence:false,list:[],response:[],LoadComplete:null,responseText:'',rawResponse:''};$nim._.csv={header:[],lowercase:false,delim:",",datatype:'',data:[],result:[]};$nim._.post={msgs:[],running:false};$nim._.fctry={list:[]};$nim._.svcs={list:[]};$nim._.ntfy={count:0,list:[]};$nim._.ajax={_callcount:0,callbacks:{},response:null,ip:$nim.security.ip};$nim._.core={windowid:0,lastFocus:'',docDimensions:null,winDimensions:null};$nim._.drag={dragid:null,sizeid:null,isDragging:false,isSizing:false,bL:null,ao:null,mouseXinit:null,mouseYinit:null,ap:null,lastdragged_id:null,cI:null,lastsized_id:null,zones:[],reSizeItems:[]};$nim._u="undefined";$nim._o="object";$nim._f="function";$nim._t="string";$nim._n="number";$nim._d="dialog";$nim._s="surface";$nim._p="plain";$nim._k="skin";$nim._pop='min-width,max-width,min-height,max-height';$nim.undef=function(e){return typeof(e)==$nim._u;};$nim.isfnc=function(e){return typeof(e)==$nim._f;};$nim.isobj=function(e){return typeof(e)==$nim._o;};$nim.isstr=function(e){return typeof(e)==$nim._t;};$nim.isnum=function(e){return typeof(e)==$nim._n;};if(!globals){var globals={};}if(!defaults){var defaults={};}$nim.UpdateObject=function(bq,usr){var bE;for(bE in bq){if($nim.isobj(bq[bE])){if($nim.undef(usr[bE])){usr[bE]={};}$nim.UpdateObject(bq[bE],usr[bE]);}if($nim.undef(usr)){usr={};}if($nim.undef(usr[bE])){usr[bE]=bq[bE];}}};$nim.cK=globals;$nim.cn=defaults;$nim.cg={_core:{eventScan:8,timerInterval:50,timerStep:32},_services:{recurselimit:8,demostatus:401},j32Ver:"v4.1",ideVer:"v4.0",revision:"0",fluidDesktop:true,silentErrors:true,suppressliding:false};$nim.cg.DlgStyles={sizablex:1,sizabley:2,sizable:3,dragablex:4,dragabley:8,dragable:12,help:16,min:32,max:64,close:128,shadow:256,docklft:512,dockrgt:1024,caption:2048,docktop:4096,dockbot:8192,fullscrn:16384};$nim.cZ={};$nim.cZ.preload={disabledesktop:false,workspaces:4,standardcontrols:true,extendedcontrols:false};$nim.cZ.sounds={background:'',close_dialog:'',pickup_dialog:'',putdown_dialog:'media/click.mp3',launch_app:'',typed_key:'',button_click:'',minimize:'',maximize:'',restore:''};$nim.cZ.scaletype={minWidth:1,maxWidth:99999,minFont:1,maxFont:40,chrPerLine:40};$nim.cZ.dialog={docking:false,hideChildrenWhenSliding:false,max_padleft:5,max_padtop:5,max_padright:5,max_padbottom:5,max_spacing:5,min_padleft:40,min_padtop:0,min_padright:0,min_padbottom:45,min_spacing:5,min_width:170,min_height:30,dlg_width:400,dlg_height:300,dlg_minwidth:160,dlg_minheight:26,dlg_color:'#f0f0f0',dlg_border:3,dlg_bdrradius:3,bdr_color:'rgba(128,128,128, .35)',back_color:'rgba(180,180,180, 1)',doc_color:'#f0f0f0',bdr_text:'#000000',title_height:26,title_font:'Tahoma',title_fontsize:10,tab_height:20,resize_width:26,resize_height:28,btn_color:'#202020'};$nim.cZ.menus={menu_width:150,menu_height:26,menu_bordercolor:'#5970B2',menu_backcolor:'#5970B2',menu_forecolor:'#FFF',menu_fontfamily:'Arial',menu_fontsize:'18px',submenu_bordercolor:'#5970B2',submenu_backcolor:'#EAEBD8',subitem_backcolor:'#EAEBD8',subitem_highlight2:'rgba(0,0,128,.3)',subitem_highlight1:'rgba(250,250,250,0.45)',subitem_forecolor:'#2875DE',subitem_fontfamily:'Arial',subitem_fontsize:'14px'};$nim.themes={'v3.2':'v3.2','v4.0':'v3.2'};$nim.file={'v4.0':{menu:'j32menus.cgi',lib:'j32library.cgi',dialog:'j40dialog.cgi',help:'j32helper.cgi',stable:true},'v4.1':{menu:'j32menus.cgi',lib:'j41library.cgi',dialog:'j41dialog.cgi',help:'j41helper.cgi',stable:true},'v4.2':{menu:'j32menus.cgi',lib:'j41library.cgi',dialog:'j41dialog.cgi',help:'j41helper.cgi',stable:true}};if(!$nim.cn.dlg_border&&$nim.cn.dr){$nim.cn.dlg_border=$nim.cn.dr;delete $nim.cn.dr;}$nim.UpdateObject($nim.cZ,$nim.cn);$nim.UpdateObject($nim.cg,$nim.cK);$nim.cZ=null;delete $nim.cZ;$nim.cg=null;delete $nim.cg;$nim.mv=globals.suppressliding?'moveto':'slideto';$nim.home_server=$nim.home_server||"http://www.nimble-ide.com/";$nim.theme="v4.0";$nim.dP="(";$nim.cb=")";$nim.as="[";$nim.bN="[";$nim.bM="]";$nim.aS="]";$nim.aY=".";$nim.bJ=".";$nim.bs="~";$nim.bc="~";$nim.nDelm=" ";$nim.infinite=99999;$nim.Mouse={timer:null,eventMsg:{message:null,id:null},clickcount:0,mousedown:false,x:0,y:0,click:function(e){event=e||window.event;$nim.Mouse.mousedown=false;$nim.Mouse.dragdone=false;if(event&& !event.button){if(event.target){if(!$nim.undef(event.target.getAttribute)){var etype=event.target.getAttribute('type');if((etype!='submenu')){$nim.Menu.CloseAll();}if(DESKTOP.update){if($nim.bi.ProductName){DESKTOP.iniFields($nim.bi.ProductName,$nim.bi.Copyright+' - '+$nim.bi.Author,'Updated On : '+$nim.bi.CompiledOn,'Logged on as : LEET');}else{DESKTOP.iniFields('Virtual Desktop','(c) 2014 by Nimble Solutions','Updated On : 2-1-2014','');}DESKTOP.update=false;}}}}},onmouseup:function(e){var cc,curval='';event=e||window.event;$nim.Mouse.mousedown=false;$nim.Mouse.dragdone=false;$nim.Key.detectKeys(e);if(!$nim.undef(event)){if(!$nim.undef(event.target)){if(!$nim.undef(event.target.getAttribute)){var etype=event.target.getAttribute('type');if((etype!='submenu')){$nim.Menu.CloseAll();}}}}if($nim.Mouse.eventMsg.id){cc=$nim.G.V($nim.Mouse.eventMsg.id.resolveName('ctrlName'));$nim.Mouse.eventMsg={message:null,id:null};if(cc){if($nim.isfnc(cc.onmouseup)){cc.onmouseup($nim.Mouse.event);}if($nim.isfnc(cc.onclick)){cc.onclick($nim.Mouse.event);}}}cc=null;},onmousemove:function(e){var cc;event=e||window.event;$nim.Mouse.x=event?event.clientX:$nim.Mouse.x;$nim.Mouse.y=event?event.clientY:$nim.Mouse.y;$nim.Key.detectKeys(e);if($nim.Mouse.eventMsg.id){cc=$nim.G.V($nim.Mouse.eventMsg.id.resolveName('ctrlName'));if(cc){if($nim.isfnc(cc.onmouseover)){cc.onmouseover($nim.Mouse.event);}}}cc=null;if($nim._.drag.isSizing||$nim._.drag.isDragging){$nim.ab.onMouseMove(e);}},onmousedown:function(e){var cc;event=e||window.event;$nim.Mouse.mousedown=true;$nim.Mouse.dragdone=false;$nim.Mouse.event=event;$nim.Key.detectKeys(e);if($nim.Mouse["elemname"]===null){$nim.Mouse["elemname"]=event.target.id;$nim.Mouse.clickcount=1;}else if($nim.Mouse["elemname"]==event.target.id){$nim.Mouse.clickcount++;}else{$nim.Mouse["elemname"]=event.target.id;$nim.Mouse.clickcount=1;}cc=$nim.G.V($nim.Mouse["elemname"]);if(cc){if(event.button==2&&$nim.isfnc(cc.onmenu)){cc.onmenu($nim.Mouse.event);}}if($nim.Mouse.timer===null){$nim.Mouse.timer=setTimeout(function(){try{if($nim.Agent.isMobile){if($nim.Mouse.clickcount>1){cc=$nim.G.V($nim.Mouse["elemname"]);if($nim.isfnc(cc.ondblclick)){cc.ondblclick($nim.Mouse.event);}}else if($nim.Mouse.clickcount==1){if($nim.Mouse.mousedown===true){if($nim.isfnc(cc.longpress)){cc.longpress($nim.Mouse.event);}}}}}catch(e){}finally{$nim.Mouse.clickcount=0;$nim.Mouse.timer=null;$nim.Mouse["elemname"]=null;$nim.Mouse.event=null;}},300);}cc=null;}};if($nim.undef($nim.Agent)){$nim.Agent={};}$nim.AppHooks=cU({Load:function(id){if(ad[id-1]&&ad[id-1].Load){ad[id-1].Load();}},New:function(id){if(ad[id-1]&&ad[id-1].New){ad[id-1].New();}return $nim.bi.instId;},Start:function(id,start){$nim._.core.winDimensions=$nim.ax.findWindowDimensions();if(DESKTOP){if(DESKTOP.width===0){DESKTOP.width=$nim._.core.winDimensions.width;}if(DESKTOP.height===0){$nim.G.setDesktopHeight();}}if(ad[id-1]&&ad[id-1].Start){ad[id-1].Start(null,start);if(!$nim.undef(ad[id-1].target)){ad[id-1].target=FORMS.Target;}}},Resize:function(id){if(ad[id-1]&&ad[id-1].Resize){ad[id-1].Resize();}},NoStart:function(id){if(ad[id-1]&&ad[id-1].NoStart){ad[id-1].NoStart();}},End:function(id){if(ad[id-1]&&ad[id-1].End){ad[id-1].End();}}});var Me=null,Widgets=null,DlgCode=null,Model=null,PostBox=null,App=null,ad=[];$nim.prevTime=0;$nim.bi=null;$nim.instList=[];$nim.G={};$nim._._$=[];$nim["const"]={model:function(nspace,method){var str='App {0} Method.{1}() - MVC/MVVM Service not included in Build.';return str.replace('{0}',nspace).replace('{1}',method);},postbox:function(nspace,method){var str="App {0} Method.{1}() - PostBox Service not included in Build.";return str.replace('{0}',nspace).replace('{1}',method);},styles:{divOnly:['display','visibility','left','top','position','float','!left','!top','right','bottom'],nil:{'border-width':'0px','border-color':'transparent','border':'none'},borderGroup:['border','border-spacing','border-style','border-color','border-width','border-radius','border-left','border-top','border-right','border-bottom','border-left-spacing','border-left-style','border-left-color','border-left-width','border-top-left-radius','border-top-spacing','border-top-style','border-top-color','border-top-width','border-top-right-radius','border-right-spacing','border-right-style','border-right-color','border-right-width','border-bottom-right-radius','border-bottom-spacing','border-bottom-style','border-bottom-color','border-bottom-width','border-bottom-left-radius'],showGroup:['display','visibility'],positionGroup:['pos','left','top','position','float','!left','!top'],altPositionGroup:['right','bottom'],sizeGroup:['width','height','!width','!height'],overflowGroup:['overflow','overflow-x','overflow-y'],paddingGroup:['padding','padding-left','padding-right','padding-top','padding-bottom'],marginGroup:['margin','margin-left','margin-right','margin-top','margin-bottom'],rangeGroup:['max-width','max-height','min-width','min-height'],colorGroup:['color','background','background-color','border','border-color','box-shadow'],vendorGroup:['transform','transform-box','transform-origin','transform-style','transition','transition-property','transition-duration','animation-name','animation-duration','animation-timing-function','animation-delay','animation-iteration-count','animation-direction','animation-fill-mode','animation-play-state','linear-gradient','radial-gradient','box-sizing','align-content','align-items','align-self','flex','flex-basis','flex-direction','flex-flow','flex-grow','flex-shrink','flex-wrap','justify-content','order'],dockGroup:['!!!!','----',null],structGroup:['autosize','ctype','tag','events','dock','lock-left','lock-top','lock-width','lock-height','lock-pos','lock-size','drag.x','drag.y','size.x','size.y','posadj','negadj','sizeable','dragable','draggable','xdragrange','ydragrange','scale-cpl','scaletype','bind','bindid','curw','curh','flip','facing','xdrag%','ydrag%','prvsize','widget','origsize','restoresize','dlg_style','rtimer','stimer','ftimer','state','stateto','id_counter','font-family','font-weight','font-style','font-size','text-decoration','l%','lpx','t%','tpx','w%','wpx','h%','hpx','actw','acth','_init','_coords','_props','_styles','_events']}};$nim.copy=function(bq){return JSON.parse(JSON.stringify(bq));};$nim.resolve=function(dlg,af,G){var cc=$f.af(dlg,af);G=G||'instN';dlg=dlg||'';af=af||'';return{dlg:dlg,af:af,inst:$nim[G](dlg,af),cc:(cc&&cc.type=='tab-item')?cc.children[0]:cc,div:(cc&&cc.type=='tab-item')?cc:$f.cc(dlg,af)};};$nim.targId=function(e){return e&&e.target?e.target.id:'';};$nim.G.isCustom=function(dlg,af){var arr=Object.values($f.getprop(dlg,af,'lock-left,lock-top,lock-pos,lock-width,lock-height,lock-size'));return(arr.indexOf('!!!!')> -1);};$nim.G.type=function(bq){var ret=typeof(bq);ret=(Array.isArray(bq))?'array':ret;return ret;};$nim.pW=function(enme,inval,out){var ret,width,cc,isString=(typeof inval=='string');if(isString&&inval.indexOf('calc')> -1)return inval;cc=$nim.G.V(enme);width=(!enme)?DESKTOP.width:(cc&&$nim._syselems.indexOf(enme)== -1)?(cc.offsetWidth?cc.offsetWidth:$nim.G.dk(cc)):DESKTOP.width;ret=isString?((inval.indexOf('%')> -1)?(width*parseFloat(inval)/100).toFixed(2):(inval===null)?width:dA(inval)):(inval===null)?width:inval;ret=(out=='%')?(100*inval/width).toFixed(2):ret;return ret;};$nim.pH=function(enme,inval,out){var ret,height,cc,isString=(typeof inval=='string');if(isString&&inval.indexOf('calc')> -1)return inval;cc=$nim.G.V(enme);height=(!enme)?DESKTOP.height:(cc&&$nim._syselems.indexOf(enme)== -1)?(cc.offsetHeight?cc.offsetHeight:$nim.G.dC(cc)):DESKTOP.height;ret=isString?((inval.indexOf('%')> -1)?(height*parseFloat(inval)/100).toFixed(2):(inval===null)?height:dA(inval)):(inval===null)?height:inval;ret=(out=='%')?(100*inval/height).toFixed(2):ret;return ret;};$nim.G.i18n=function(cc,bE,text){var lng='',tooltip='',ret=text;if(App&&App.Code&&App.Code.i18n){lng=App.Code.i18n.current||App.Code.i18n["default"]||'';ret=lng?(App.Code.i18n[lng+'.lng'][text]||text):text;if(ret!=text){tooltip=ret;}}if(cc){cc[bE]=ret;if(ret.length>text.length){(USER._libs['tooltip.web'])?cc.setAttribute('tooltip',tooltip):cc.setAttribute('title',tooltip);}}return ret;};$nim.G.keyToObjString=function(dlg,key){var ret=dlg+":",keymsg="";if(!key)return "";keymsg+=key.isCtrl?"ctrl+":"";keymsg+=key.isShift?"shift+":"";keymsg+=key.isAlt?"alt+":"";keymsg=$nim.G.sortKeyString(keymsg);keymsg+=key.Char?key.Char:"";return(ret+keymsg).toLowerCase();};$nim.G.sortKeyString=function(kstr){kstr=kstr.split("+");var key=kstr.pop();return kstr.sort().join("+")+"+"+key;};$nim.G.attachHotkey=function(id,keys){var objId,af;if(id&&App){if(!App.keyMaps)App.keyMaps={};objId=id.resolveName();if(!$f.getprop(objId.Form,objId.Control,"sdkitem")){keys=keys.split(";")||[];if(keys&&keys.forEach){keys.forEach(function(key){key=(id.resolveName("instform")+":"+$nim.G.sortKeyString(key)).toLowerCase();if(!App.keyMaps[key])App.keyMaps[key]={};af=objId.Control+(objId.Component?"."+objId.Component:"");App.keyMaps[key][af]=objId;});}}}};$nim.G.triggerHotKey=function(){var e,chk,dlg=KERNEL.curId.resolveName("instform");var msg,af,msgCtrls,keyMsg=$nim.G.keyToObjString(dlg,$nim.Key);if(App&& !App.keyMaps)App.keyMaps={};msgCtrls=App.keyMaps[keyMsg];if(msgCtrls){for(af in msgCtrls){chk=af;if(['menu','submenu'].indexOf($f.getprop(dlg,chk,'type'))> -1){chk=chk.split('-');chk.pop();chk=chk.join('-');}if($f.isenabled(dlg,af)&&$f.isvisible(dlg,chk)){msg=msgCtrls[af];var sufx=$f.cc(msg.Form,msg.Control+"."+msg.Component)?"."+msg.Component:"";if(!sufx)sufx=$f.cc(msg.Form,msg.Control+".items")?".items":"";if(keyMsg.split("+").length==3&&keyMsg.indexOf("alt+ctrl+")> -1){$f.setfocus(msg.Form,msg.Control+sufx);}else{e=$nim.G.buildEvent('system',$f.af(msg.Form,msg.Control+sufx));if(!$nim.Key.isAlt&&$nim.Key.Char.length==1&&DESKTOP.isEnabled())return;if(!$nim.Key.isAlt&&['textbox','textarea','input','edit-list','edit-li'].indexOf($f.type(KERNEL.curId))> -1)return;if($f.af(msg.Form,msg.Control+sufx).onclick){$f.af(msg.Form,msg.Control+sufx).focus();$f.af(msg.Form,msg.Control+sufx).onclick(e);}else{if($f.cc(msg.Form,msg.Control+sufx).onclick){$f.cc(msg.Form,msg.Control+sufx).focus();$f.cc(msg.Form,msg.Control+sufx).onclick(e);}}}return;}}}};$nim.G.updateDlgCoords=function(cc,st){if($nim.G.cu(cc,$nim._d)){$nim.ab.updateChildren(null,cc,true,true,false);}var blRes=(['-','min','max'].indexOf(st)== -1);$nim.ab.setOrigCoords(null,cc,null,false,blRes,true);};$nim.G.findEvent=function(nmspc,frm,aM){return typeof(AppEvents)!='undefined'?(aM[2]||'').nav(AppEvents):$heap[nmspc][frm].Events[aM[2]];};$nim.G.transitionState=function(cc,dlg,hide,zorder,rsize,trans){var uGlb=$nim.cK.DlgStyles;var style=rsize?dA($f.getprop(dlg,'','dlg_style')):0;if(!dlg){return;}if((cc&&cc.style.display!='none')||hide)$nim.ab.hideChildren(null,cc,hide);$f.setvisible(dlg,'resize',((style&uGlb.sizablex)||(style&uGlb.sizabley))?rsize:false);if($nim.isnum(zorder))$f.zorder(dlg,zorder);if(trans)$f.setprop(dlg,'',[{name:'state',value:'-'},{name:'stateTo',value:trans}]);if(trans.indexOf('dock')> -1)$f.setprop(dlg,'','dockState',trans);if(trans=='restore')$f.setprop(dlg,'','dockState','');};$nim.G.triggerDlgResize=function(evntName,au,zorder,state,pop,cc){if(!au){return;}var prv,de=au.resolveName('form');var stateval=$f.getprop(de,'','stateTo')||'restore';$nim.SetId(au);$f.setprop(de,'',[{name:'state',value:stateval},{name:'stateTo',value:''}]);if($nim.isnum(zorder))$f.zorder(de,zorder);if(pop&&cc)$nim.G.popStyles(cc,pop);if(App&&de==KERNEL.curForm&&App.Dialog[de]){$f.events(de,evntName)(state,au.resolveName());}if(cc){switch(evntName){case 'FullScreen':$nim.df(cc.id,'prv-lock-size',$nim.dE(cc.id,'lock-size')||'null');$nim.df(cc.id,'lock-size','!!!!');break;default:prv=$nim.dE(cc.id,'prv-lock-size');prv=(prv=='null')?'':prv;$nim.df(cc.id,'lock-size',prv);}}if(KERNEL.sdkMode&&sdkMgr){if(stateval=='restore')sdkMgr.setFocus(Mgr.CurrentForm,Mgr.CurrentCtrl,true,false);}};$nim.G.triggerAppResize=function(){var curInst,state,x,F;$nim._.core.docDimensions=$nim.ax.findDocumentDimensions();$nim._.core.winDimensions=$nim.ax.findWindowDimensions();DESKTOP.width=$nim._.core.winDimensions.width;$nim.G.setDesktopHeight();$nim.ax.buildKey();if(App&&App.InstName){curInst=App.InstName;F=ad.length;for(x=0;x<F;x++){if(ad[x].App.isLoaded&&ad[x].InstName!==''){$nim.SetId(ad[x].InstName);if((ad[x].Vars["running"]||ad[x].Vars["forcenotify"])&&ad[x].Resize){ad[x].Resize();}for(var dlg in ad[x].Dialog){if(ad[x].Dialog[dlg].isActivated){state=$f.getprop(dlg,'','state');switch(state.toLowerCase()){case 'max':$f.setprop(dlg,'','state','restore');$f.max(dlg);break;default:break;}}}}}if(curInst){$nim.SetId(curInst);}}};$nim.G.DlgInstance={add:function(au){if(App){if(!App.Dialogs){App.Dialogs=[];}if(App.Dialogs.indexOf(au)== -1){App.Dialogs.push(au);}$nim.SetId(au);}},remove:function(au){var index;if(App){if(!App.Dialogs){App.Dialogs=[];}index=App.Dialogs.indexOf(au);if(index> -1){App.Dialogs.splice(index,1);}}}};$nim.G.addOption=function(before,cc,id,bS,txt,val){var style,selectBoxOption=document.createElement("option");var dir=cc.getAttribute('item-dir')||'vertical';var istyle=cc.getAttribute('item-style')||'';istyle=$nim.aX('=',':',istyle);val=val?val:'item.'+bS;selectBoxOption.value=val;selectBoxOption.text=txt;selectBoxOption.id=id;style="color:inherit;font:inherit;background:inherit;"+((dir=='horizontal')?'display:inline-block;':'');if(istyle)style+=istyle+((istyle.right(1)!=';')?';':'');selectBoxOption.style=style;if(before){cc.insertBefore(selectBoxOption,before);}else{cc.add(selectBoxOption,null);}};$nim.G.getRect=function(cc){var rec=cc.getClientRects();return rec[0]||{left:0,top:0,width:0,height:0};};$nim.G.resolveView=function(cc,l,t){var nl=l,nt=t;var rec=$nim.G.getRect(cc);var rgt=(rec.left+rec.width),bot=(rec.top+rec.height);var cc=$f.cc(DESKTOP.currentName+'.body');function adjClip(bit){if(bit&1)nl=(DESKTOP.width<rgt)?(l-(rgt-DESKTOP.width)-30):l;if(bit&2)nt=(DESKTOP.height<bot)?(t-(bot-DESKTOP.height)-30):t;};if(cc){cc=cc.style;if(['auto','scroll'].indexOf(cc["overflow"])== -1){adjClip(3);}else{if(['auto','scroll'].indexOf(cc["overflow-x"])== -1)adjClip(1);if(['auto','scroll'].indexOf(cc["overflow-y"])== -1)adjClip(2);}}else{adjClip(3);}return{left:nl,top:nt};};$nim.G.evalStyles=function(dlg,aI,style){var uGlb=$nim.cK.DlgStyles;if(aI&&(style&uGlb.shadow)==uGlb.shadow){aI.className+=' shadow-drop';}};$nim.G.escRegExp=function(text){return text.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,'\\$&');};$nim.G.getStrParam=function(inTxt,delim){var bZ=inTxt.split(delim),item=bZ.shift();inTxt=bZ.join(delim);return{item:item,remainder:inTxt};};$nim.G.isMenu=function(cc){if(cc&&cc["ctype"]){return(cc["ctype"].indexOf('menu')> -1);}};$nim.G.isInGroup=function(grpName,bE){var ret='',gList=$nim["const"].styles[grpName];if(gList.indexOf(bE)> -1){ret=bE;}return ret;};$nim.G.resetZIndex=function(dp,zVal){if(!dp)return;if(dp.getAttribute('ignorezorder')=='false'&&dp.style[$nim._keys(13)]<$nim.ab.POPUP){dp.style[$nim._keys(13)]=zVal;}};$nim.G.minMaxW=function(cc,newW){var itmStyle,minW,maxW,retW=newW;itmStyle=cc.style;minW=$nim.pW(cc.id,itmStyle.minWidth);retW=(cc.lockW=='!!!!')?cc.offsetWidth:(dA(newW)<minW)?minW:newW;if(itmStyle.maxWidth){maxW=$nim.pW(cc.id,itmStyle.maxWidth);retW=(cc.lockW=='!!!!')?cc.offsetWidth:(dA(retW)>maxW)?maxW:retW;}return dA(retW);};$nim.G.minMaxH=function(cc,newH){var itmStyle,minH,maxH,retH=newH;itmStyle=cc.style;minH=$nim.pW(cc.id,itmStyle.minHeight);retH=(cc.lockH=='!!!!')?cc.offsetHeight:(dA(newH)<minH)?minH:newH;if(itmStyle.maxHeight){maxH=$nim.pW(cc.id,itmStyle.maxHeight);retH=(cc.lockH=='!!!!')?cc.offsetHeight:(dA(retH)>maxH)?maxH:retH;}return dA(retH);};$nim.G.lockFlags=function(cc,elmDiv){if(!cc)return;var parent=cc.parentNode;if(parent.id==cc.id+'.div')cc=parent;cc.lockL=$nim.dE(cc.id,'lock-left')||$nim.dE(cc.id,'lock-pos');cc.lockT=$nim.dE(cc.id,'lock-top')||$nim.dE(cc.id,'lock-pos');cc.lockW=$nim.dE(cc.id,'lock-width')||$nim.dE(cc.id,'lock-size');cc.lockH=$nim.dE(cc.id,'lock-height')||$nim.dE(cc.id,'lock-size');cc.lockD=$nim.dE(cc.id,'lock-display');cc.dock=$nim.dE(cc.id,'dock');};$nim.G.tranStr=function(cc,af){return 'translate3d('+(cc.az||0)+','+(cc.ar||0)+','+(cc.bj||0)+') '+(af?'perspective(5000px) ':'perspective(10000px) ')+'rotateY('+(cc.rotateY||0)+'deg) rotateX('+(cc.rotateX||0)+'deg) rotateZ('+(cc.rotateZ||0)+'deg) '+'scale('+(cc.ba||0)+','+(cc.bA||0)+')';};$nim.G.cX=function(cc,out){return $nim.dE(cc.id,'l'+(out||'px'));};$nim.G.getR=function(cc,out){return $nim.dE(cc.id,'r'+(out||'px'));};$nim.G.cF=function(cc,out){return $nim.dE(cc.id,'t'+(out||'px'));};$nim.G.getB=function(cc,out){return $nim.dE(cc.id,'b'+(out||'px'));};$nim.G.dk=function(cc,out){return $nim.dE(cc.id,'w'+(out||'px'));};$nim.G.dC=function(cc,out){return $nim.dE(cc.id,'h'+(out||'px'));};$nim.G.cS=function(cc,L,force){if(!force&&cc.lockL=='!!!!')return;if(typeof(L)=='undefined')return;var aL,out,pL=$nim.pW,J,bE=$nim._keys(2),pNode=cc.parentNode;J=(pNode&&pNode.id.indexOf('start.')== -1)?pNode.id:(cc.getAttribute('parent')||pNode.id);out=(force)?(L.indexOf&&L.substr(-1)=='%')?'%':'px':(cc.style[bE].substr(-1)=='%')?'%':'px';if(L.indexOf){L=L.trim().toLowerCase();aL=(J&&L.substr(-1)=='%')?pL(J,L):dA(L);cc.style[bE]=(L.substr(-1)=='%'||L.indexOf('calc')> -1)?L:pL(J,L,out)+out;aL=aL.indexOf?cc.offsetLeft:aL;}else{L=(L<0)?0:L;aL=dA(L);cc.style[bE]=pL(J,L,out)+out;}if($nim._struct[cc.id]){$nim._struct[cc.id]['lpx']=Number(aL||0);$nim._struct[cc.id]['l%']=Number(pL(J,aL,'%'));}};$nim.G.setR=function(cc,R,force){if(!force&&cc.lockR=='!!!!')return;if(typeof(R)=='undefined')return;var aR,out,pR=$nim.pW,J,bE='right',pNode=cc.parentNode;J=(pNode&&pNode.id.indexOf('start.')== -1)?pNode.id:(cc.getAttribute('parent')||pNode.id);out=(force)?(R.indexOf&&R.substr(-1)=='%')?'%':'px':(cc.style[bE].substr(-1)=='%')?'%':'px';cc.style['left']='';if(R.indexOf){R=R.trim().toLowerCase();aR=(J&&R.substr(-1)=='%')?pR(J,R):dA(R);cc.style[bE]=(R.substr(-1)=='%'||R.indexOf('calc')> -1)?R:pR(J,R,out)+out;aR=aR.indexOf?cc.offsetLeft:aR;}else{R=(R<0)?0:R;aR=dA(R);cc.style[bE]=pR(J,R,out)+out;}if($nim._struct[cc.id]){$nim._struct[cc.id]['rpx']=Number(aR||0);$nim._struct[cc.id]['r%']=Number(pR(J,aR,'%'));}};$nim.G.cN=function(cc,T,force){if(!force&&cc.lockT=='!!!!')return;if(typeof(T)=='undefined')return;var aT,out,pT=$nim.pH,J,bE=$nim._keys(3),pNode=cc.parentNode;J=(pNode&&pNode.id.indexOf('start.')== -1)?pNode.id:(cc.getAttribute('parent')||pNode.id);out=(force)?(T.indexOf&&T.substr(-1)=='%')?'%':'px':(cc.style[bE].substr(-1)=='%')?'%':'px';if(T.indexOf){T=T.trim().toLowerCase();aT=(J&&T.substr(-1)=='%')?pT(J,T):dA(T);cc.style[bE]=(T.substr(-1)=='%'||T.indexOf('calc')> -1)?T:pT(J,aT,out)+out;aT=aT.indexOf?cc.offsetTop:aT;}else{T=(T<0)?0:T;aT=dA(T);cc.style[bE]=pT(J,T,out)+out;}if($nim._struct[cc.id]){$nim._struct[cc.id]['tpx']=Number(aT||0);$nim._struct[cc.id]['t%']=Number(pT(J,aT,'%'));}};$nim.G.setB=function(cc,B,force){if(!force&&cc.lockB=='!!!!')return;if(typeof(B)=='undefined')return;var aB,out,pB=$nim.pH,J,bE='bottom',pNode=cc.parentNode;J=(pNode&&pNode.id.indexOf('start.')== -1)?pNode.id:(cc.getAttribute('parent')||pNode.id);out=(force)?(B.indexOf&&B.substr(-1)=='%')?'%':'px':(cc.style[bE].substr(-1)=='%')?'%':'px';cc.style['top']='';if(B.indexOf){B=B.trim().toLowerCase();aB=(J&&B.substr(-1)=='%')?pB(J,B):dA(B);cc.style[bE]=(B.substr(-1)=='%'||B.indexOf('calc')> -1)?B:pB(J,aB,out)+out;aB=aB.indexOf?cc.offsetTop:aB;}else{B=(B<0)?0:B;aB=dA(B);cc.style[bE]=pB(J,B,out)+out;}if($nim._struct[cc.id]){$nim._struct[cc.id]['bpx']=Number(aB||0);$nim._struct[cc.id]['b%']=Number(pB(J,aB,'%'));}};$nim.G.cT=function(cc,W,force){if(!force&&cc.lockW=='!!!!')return;if(typeof(W)=='undefined')return;var aW,out,pW=$nim.pW,J,bE=$nim._keys(0),pNode=cc.parentNode;J=(pNode&&pNode.id.indexOf('start.')== -1)?pNode.id:(cc.getAttribute('parent')||pNode.id);out=(force)?(W.indexOf&&W.substr(-1)=='%')?'%':'px':(cc.style[bE].substr(-1)=='%')?'%':'px';if(W.indexOf){W=W.trim().toLowerCase();aW=(J&&W.substr(-1)=='%')?pW(J,W):dA(W);cc.style[bE]=(W.substr(-1)=='%'||W.indexOf('calc')> -1)?W:pW(J,aW,out)+out;aW=aW.indexOf?cc.offsetWidth:aW;}else{W=(W<0)?0:W;aW=dA(W);cc.style[bE]=pW(J,W,out)+out;}if($nim._struct[cc.id]){$nim._struct[cc.id]['actw']=Number(aW||0);$nim._struct[cc.id]['wpx']=Number(aW||0);$nim._struct[cc.id]['w%']=Number(pW(J,aW,'%'));}};$nim.G.cz=function(cc,H,force){if(!force&&cc.lockH=='!!!!')return;if(typeof(H)=='undefined')return;var aH,out,pH=$nim.pH,J,bE=$nim._keys(1),pNode=cc.parentNode;J=(pNode&&pNode.id.indexOf('start.')== -1)?pNode.id:(cc.getAttribute('parent')||pNode.id);out=(force)?(H.indexOf&&H.substr(-1)=='%')?'%':'px':(cc.style[bE].substr(-1)=='%')?'%':'px';if(H.indexOf){H=H.trim().toLowerCase();aH=(J&&H.substr(-1)=='%')?pH(J,H):dA(H);cc.style[bE]=(H.substr(-1)=='%'||H.indexOf('calc')> -1)?H:pH(J,aH,out)+out;aH=aH.indexOf?cc.offsetHeight:aH;}else{H=(H<0)?0:H;aH=dA(H);cc.style[bE]=pH(J,H,out)+out;}if($nim._struct[cc.id]){$nim._struct[cc.id]['acth']=Number(aH||0);$nim._struct[cc.id]['hpx']=Number(aH||0);$nim._struct[cc.id]['h%']=Number(pH(J,aH,'%'));}};$nim.G.cursorEnabled=function(div,cc,value){if(!div&&cc&&cc.type=='tab-item'){div=cc;cc=div.children[0];}else if(!div&&cc&&['menu','submenu'].indexOf(cc.type)> -1){div=cc;}else if(!div)return;if(cc){cc.style['cursor']='inherit';cc.style['pointer-events']=((div.getAttribute('disabled')!='true')&&value)?'auto':'none';}if(value){div.style['cursor']=div.getAttribute("cursor")||'auto';}else{if(!div.getAttribute("cursor"))div.setAttribute("cursor",div.style['cursor']||'auto');div.style['cursor']='not-allowed';}};$nim.G.boxSize=function(cc){var ret;cc.style['box-sizing']='';ret={width:cc.offetWidth,height:cc.offsetHeight};cc.style['box-sizing']='border-box';return ret;};$nim.G.cursorEvent=function(div,value){if(!div)return;if(div.getAttribute('disabled')!='true'){div.style['cursor']=value?'pointer':'auto';}div.setAttribute("cursor",value?'pointer':'auto');};$nim.G.setDisplay=function(cc,disp,force){if(!force&&cc.lockD=='!!!!')return;cc.style['display']=disp;};$nim.G.setVisibility=function(cc,disp,force){if(!force&&cc.lockD=='!!!!')return;cc.style['visibility']=disp;};$nim.G.setAttrs=function(cc,bq){for(var fld in bq){if(bq[fld]!==null){cc.attrib?cc.attrib(fld,bq[fld]):$nim.df(cc.id,fld,bq[fld]);}}};$nim.G.getAttrs=function(cc,bq){for(var fld in bq){bq[fld]=cc.getAttribute(fld);}return bq;};$nim.G.adjPad=function(body,dir,val){if(globals.ideVer=="v5.0"||body.getAttribute('version')=="v5.0"){return 0;}else{var maxD,pad,ret=val;if(body){maxD=$nim.dE(body.id,dir);pad=Math.abs(2*(8-defaults.dialog.dlg_border));ret=pad*val/maxD;}return Number(ret.toFixed(2));}};$nim.G.ce=function(G,args){var ret,widgInst,widgName,tmp,blConcat;var dlg,af,inst,arg=[].slice.call(args);inst=arg[0]?arg[0].split('.'):[];blConcat=(arg[0]&&arg[0].indexOf('.')> -1);function call(){var fnVal;if(!G|| !dlg)return null;if(!$f.isloaded(dlg))return null;switch(arg.length){case 8:fnVal=G(dlg,arg[1],arg[2],arg[3],arg[4],arg[5],arg[6],arg[7]);break;case 7:fnVal=G(dlg,arg[1],arg[2],arg[3],arg[4],arg[5],arg[6]);break;case 6:fnVal=G(dlg,arg[1],arg[2],arg[3],arg[4],arg[5]);break;case 5:fnVal=G(dlg,arg[1],arg[2],arg[3],arg[4]);break;case 4:fnVal=G(dlg,arg[1],arg[2],arg[3]);break;case 3:fnVal=G(dlg,arg[1],arg[2]);break;case 2:fnVal=G(dlg,arg[1]);break;case 1:fnVal=G(dlg);break;default:fnVal=G();break;}return fnVal;};if(!$k.isapirunning('excInContext',inst)){$k.instance.save();if(blConcat){widgName=$f.instform(inst[0])+"."+inst[1];}else{widgName=(typeof arg[1]=='string')?($f.instform(arg[0])+(arg[1]?"."+arg[1].split('.')[0]:"")):$f.instform(arg[0]);}if(App&&App.parent)$nim.SetId(App.parent);if(App&&App.Widgets&&App.Widgets[widgName]){try{widgInst=App.Widgets[widgName];$nim.SetId(widgInst);if(blConcat){arg[0]=$nim.G.getStrParam(arg[0],'.').remainder;arg[0]=$nim.G.getStrParam(arg[0],'.').remainder;dlg=$nim.instN(widgInst.resolveName('instform'))+'.'+arg[0];}else{dlg=widgInst.resolveName('instform');arg[1]=arg[1].split('.')[1]?arg[1].split('.')[1]:widgInst.resolveName('control');}if(G)ret=call();}catch(err){if($k.errhandler){$k.errhandler(err,null,'fn.excincontent');}}finally{$k.instance.restore();}}else{try{if(blConcat){dlg=inst[0].resolveName('form');af=inst[1];}else{dlg=arg[0];af=arg[1];}if(App&&App.parent)$nim.SetId(App.parent);if(App&&App.Dialog&&App.Dialog[dlg]&&App.Dialog[dlg].Controls&&App.Dialog[dlg].Controls.indexOf(af)> -1){if(blConcat){arg[0]=$nim.instN(dlg,af);}else{arg[0]=dlg;arg[1]=af;}if(G)ret=call();}}catch(err){if($k.errhandler){$k.errhandler(err,null,'fn.excincontext');}}finally{$k.instance.restore();}}}return ret||'';};$nim.G.objToStyle=function(inObj){var flds,pstyle='';for(flds in inObj){pstyle=pstyle+flds+':'+inObj[flds]+';';}return pstyle;};$nim.G.styleToObj=function(inStr){var bq={},x,bZ=inStr.split(';');var flds;for(x=0;x<bZ.length;x++){flds=bZ[x].split(':');(flds.length==2)?(bq[flds[0].trim()]=flds[1].trim()):null;}return bq;};$nim.G.applyStyle=function(cc,bE,val){var estyle=cc.attributes['style'],estyle=estyle?estyle.value:"";var arr,bS,style='';if(estyle){style=estyle.split(';').filter(function(it){return it.indexOf(bE)> -1?it.split(':')[0].trim()!=bE:true;}).join(';');cc.setAttribute('style',style);cc.style[bE]=val;}};$nim.G.pushStyles=function(cc,inStr){var pstyle='',popObj={},x,bZ=inStr.split(',');if(cc){pstyle=cc.getAttribute('pStyle')||'';popObj=$nim.G.styleToObj(pstyle);for(x=0;x<bZ.length;x++){if(bZ[x]&&cc.style[bZ[x]]){popObj[bZ[x]]=cc.style[bZ[x]];cc.style[bZ[x]]='';}}cc.setAttribute('pStyle',$nim.G.objToStyle(popObj));}};$nim.G.popStyles=function(cc,inStr,blPreserve){var popObj={},pstyle='',x,bZ=inStr.split(',');if(cc){pstyle=cc.getAttribute('pStyle')||'';popObj=$nim.G.styleToObj(pstyle);for(x=0;x<bZ.length;x++){if(bZ[x]&&popObj[bZ[x]]){cc.style[bZ[x]]=popObj[bZ[x]];if(!blPreserve)delete popObj[bZ[x]];}}cc.setAttribute('pStyle',$nim.G.objToStyle(popObj));}};$nim.G.setDesktopHeight=function(hVal){DESKTOP.header=DESKTOP.header||0;DESKTOP.footer=DESKTOP.footer||0;DESKTOP.actualHeight=$nim._.core.winDimensions.height;DESKTOP.height=$nim._.core.winDimensions.height-(DESKTOP.header+DESKTOP.footer+3);var cc=$d.cc('background.video');if(cc){cc.onmousemove=function(e){$nim.ab.onMouseMove(e);e.stopPropagation();}}};$nim.G.dragStyle=function(key){var ret=false;switch(key.toLowerCase()){case "true":case "xy":case "x,y":case "hv":case "h,v":ret=globals.DlgStyles.dragable;break;case "x":case "h":case "horiz":ret=globals.DlgStyles.dragablex;break;case "y":case "v":case "vert":ret=globals.DlgStyles.dragabley;break;default:break;}return ret;};$nim.G.copyBackColor=function(src,des,blForce){var esrc=$nim.G.V(src),edes=$nim.G.V(des);if(esrc&&edes&&(blForce||edes.className.indexOf(' nim-active')> -1)){edes.style['background']=esrc.style['background'];edes.style['background-color']=esrc.style['background-color'];edes.style['color']=esrc.style['color'];}else{if(!edes)return;edes.style['background']='';edes.style['background-color']='';edes.style['color']='';}};$nim.G.lookupColor=function(val){var arr,i;if(val.indexOf(' ')== -1){return $nim._palette[val]||val;}else{arr=val.split(' ');for(i=0;i<arr.length;i++){arr[i]=$nim._palette[arr[i]]||arr[i];}return arr.join(' ');}};$nim.G.buildEvent=function(type,cc){event={type:type,target:cc,altKey:$nim.Key.isAlt,ctrlKey:$nim.Key.isCtrl,shiftKey:$nim.Key.isShift,keyCode:$nim.Key.Code,stopPropagation:function(){},preventDefault:function(){}};return event;};$nim.G.logTime=function(msg){var d=new Date();if($nim.prevTime===0){$nim.prevTime=d.getTime();console.log(' - '+msg);}else{console.log((d.getTime()-$nim.prevTime)+'msg - '+msg);$nim.prevTime=0;}};$nim.G.isDocVisible=(function(){var stateKey,eventKey,keys;keys={hidden:"visibilitychange",webkitHidden:"webkitvisibilitychange",mozHidden:"mozvisibilitychange",msHidden:"msvisibilitychange"};for(stateKey in keys){if(stateKey in document){eventKey=keys[stateKey];break;}}return function(c){if(c)document.addEventListener(eventKey,c);return!document[stateKey];};})();$nim.G.isWidget=function(cc){var ret=false;var x,attr,cD=cc;attr=$nim.dE(cc.id,"widget")||false;if(attr=="false"||attr===''||attr===null){for(x=0;x<8;x++){attr=$nim.dE(cD.id,"widget")||false;if(attr=="false"||attr===''||attr===null){if(cD.id=='home.body'){cD=cD.parentNode;}else{x=10;break;}}else{ret=true;break;}}}else{ret=true;}return ret;};$nim.G.cu=function(cc,type){var ret=false;if(cc&& !$nim.undef(cc["ctype"])){if(cc["ctype"].indexOf(type)!= -1){ret=true;}}return ret;};$nim.G.vDOM=function(txt){'use strict';var o;o={};o.elementname=txt;o.attributes={};o.innerHTML='';o.innerText='';o.create=function(){var bm='',css_style_str='',cc,props=[];var id=o.attributes?o.attributes.id:'';o.id=id;if(!$nim._struct[id])$nim._struct[id]={};for(var anme in o.attributes){switch(anme.toLowerCase()){case 'style':css_style_str=o.attributes[anme];break;case $nim.G.isInGroup('structGroup',anme.toLowerCase()):if(id)$nim._struct[id][anme.toLowerCase()]=o.attributes[anme];delete o.attributes[anme];break;default:bm+=anme+"='";bm+=escape(o.attributes[anme])+"' ";}}try{if($nim.Agent.usingIE){cc=document.createElement("<"+o.elementname+" "+bm+">");}else{cc=document.createElement(o.elementname);for(var anme in o.attributes){cc.setAttribute(anme,o.attributes[anme]);}}}catch(e){}if(css_style_str.length>0){cc.style.cssText=css_style_str;}if(o.innerHTML){cc.innerHTML=o.innerHTML;}else if(o.innerText){cc.appendChild(document.createTextNode(o.innerText));}return cc;};o.attrib=function(attribute,val){o.attributes[attribute]=(!val&&isNaN(val))?'':val;};return o;};$nim.G.getElemCoords=function(cc){var ct=(parseInt($nim.G.cX(cc))||cc.offsetLeft||0)+","+(parseInt($nim.G.cF(cc))||cc.offsetTop||0)+",";if(['true','w','h','height','width'].indexOf($nim.dE(cc.id,'autosize'))> -1||['block','inline-block'].indexOf($nim.dE(cc.id,'displaymode'))> -1||$nim.G.isCustom(cc.id.resolveName('form'),cc.id.resolveName('control'))){ct+=(cc.offsetWidth)+","+(cc.offsetHeight);}else{ct+=(cc.offsetWidth||$nim.G.dk(cc))+","+(cc.offsetHeight||$nim.G.dC(cc));}return ct};$nim.G.DoesItemExist=function(ctype,listBox,value){var dq,exists=false;var x=0,F;switch(ctype){case 'list':dq=listBox.options;break;case 'treeview':dq=listBox.childNodes;break;default:dq=listBox.childNodes;break;}if(!$nim.undef(dq)){F=dq.length;for(x=0;x<F;x++){switch(ctype){case 'list':if(dq[x].value==value||dq[x].text==value){exists=true;}break;case 'treeview':if(dq[x].getAttribute('value')==value){exists=true;}else if(dq[x].id.indexOf(".group")> -1){if(dq[x].childNodes.length>0){exists=$nim.G.DoesItemExist(ctype,dq[x],value);if(exists){return exists;}}}break;default:if(dq[x].getAttribute('value')==value){exists=true;}break;}}}return exists;};$nim.G.Search=function(cc,attr,value){var x,ret=null,childs;if(cc){if(cc.getAttribute(attr)==value){ret=cc;}else{childs=cc.childNodes;for(x=0;x<childs.length;x++){if(ret===null){if(childs[x].childNodes.length>0){ret=$nim.G.Search(childs[x],attr,value);}if(ret===null){if(childs[x].getAttribute){if(childs[x].getAttribute(attr)==value){ret=cc;}}}else{break;}}else{break;}}}}return ret;};$nim.G.WrapTimeout=function(G,duration){var ret,fnInst,Inst;if(App){fnInst=(App.Previous)?App.Previous.id:KERNEL.curId;}else{fnInst=KERNEL.curId;}try{ret=setTimeout(function(){Inst=$k.instance.getapp();if(DESKTOP.visible){$nim.SetId(fnInst);G(ret);}$k.instance.setbymodule(Inst.App,Inst.Form,Inst.AppIndex);},duration);}catch(err){if($k.errhandler){$k.errhandler(err,null,'fn.wraptimeout');}}finally{if(Inst){$k.instance.setbymodule(Inst.App,Inst.Form,Inst.AppIndex);}}return ret;};$nim.G.WrapInterval=function(G,duration){var ret,fnInst,Inst;if(App){fnInst=(App.Previous)?App.Previous.id:KERNEL.curId;}else{fnInst=KERNEL.curId;}try{ret=setInterval(function(){Inst=$k.instance.getapp();if(DESKTOP.visible){$nim.SetId(fnInst);G(ret);}$k.instance.setbymodule(Inst.App,Inst.Form,Inst.AppIndex);},duration);}catch(err){if($k.errhandler){$k.errhandler(err,null,'fn.wrapinterval');}}finally{if(Inst){$k.instance.setbymodule(Inst.App,Inst.Form,Inst.AppIndex);}}return ret;};$nim.G.SetMe=function(id,de){Me=null;Model=null;Widgets=null;PostBox=null;DlgCode=null;if(App&&de){if(App.Dialog[de]){if($me&&$me.target){$me.target(id);}else{if($fctry.exists('Me')){$me=$fctry.new('Me',id);}}Me=App.Dialog[de].Events;if(!App.Model)App.Model=App.Dialog[de].Model;Model=App.Model;Model._focus=de;DlgCode=App.Dialog[de].Code;PostBox=App.PostBox;Widgets=App.Dialog[de].Widgets;}}};$nim.G.WrapEvent=function(cc,curFn,G,fnname){var func_name=fnname||'';if(G)cc.style.cursor='pointer';return function(e){var sfx,aM,fname,id,au;e=e||$nim.G.buildEvent('system',this||window.event.target)||window.event;if(func_name=='onmousemove'&&($nim._.drag.isSizing||$nim._.drag.isDragging)){$nim.ab.onMouseMove(e);}au=KERNEL.Events.initialize(e);id=(e&&e.target)?e.target.id||'':'';$nim.Key.detectKeys(e);try{if(curFn){curFn(e);}aM=id.resolveName();aM["ctrl"]={_name:aM.Control,_form:aM.Form,_type:$f.type(aM.Form,aM.Control),_coords:$f.getcoords(aM.Form,aM.Control),_widget:$f.iswidget(aM.Form,aM.Control),_visible:$f.isvisible(aM.Form,aM.Control),_enabled:$f.isenabled(aM.Form,aM.Control),_class:$f.class.get(aM.Form,aM.Control)};var _ref=aM["ctrl"];if(["combobox","listbox"].indexOf(_ref._type)> -1){_ref._caption=$f.gettext(aM.Form,aM.Control);_ref._value=$f.getvalue(aM.Form,aM.Control);_ref._listindex=$f.list.listindex(aM.Form,aM.Control);_ref._listcount=$f.list.listcount(aM.Form,aM.Control);}else if(["up-down","progress"].indexOf(_ref._type)> -1){sfx=(_ref._type=='progress')?'.bar':'.range';_ref._range={min:parseInt($f.getprop(aM.Form,aM.Control+sfx,'min')),max:parseInt($f.getprop(aM.Form,aM.Control+sfx,'max')),value:parseInt($f.getprop(aM.Form,aM.Control+sfx,'value')),step:parseInt($f.getprop(aM.Form,aM.Control+sfx,'step'))||0};}else if(["image","imagex"].indexOf(_ref._type)> -1){_ref._src=$f.getprop(aM.Form,aM.Control+'.image','src');}else if(["imgbutton","imgbuttonx"].indexOf(_ref._type)> -1){_ref._caption=$f.gettext(aM.Form,aM.Control);_ref._src=$f.getprop(aM.Form,aM.Control+'.image','src');}else if(["option","checkbox"].indexOf(_ref._type)> -1){_ref._caption=$f.gettext(aM.Form,aM.Control);_ref._checked=$f.getchecked(aM.Form,aM.Control);}else if(["textbox","textarea"].indexOf(_ref._type)> -1){_ref._value=$f.getvalue(aM.Form,aM.Control);}fname=aM.Form;$nim.G.SetMe(id,fname);aM.Mouse=$nim.by.CalcCoordsRelative(aM.Form,aM.Control,{left:e?e.clientX:0,top:e?e.clientY:0});return G(e,aM);}catch(err){if($k.errhandler){$k.errhandler(err,e,func_name,'fn.wrapevent');}}finally{KERNEL.Events.exit(au,e);if(e&&e.stopPropagation){e.stopPropagation();}}return null;};};$nim.G.WrapFn=function(curFn,G,dlg,fnname){var de=dlg,func_name=fnname||'';return function(){try{if(curFn){curFn();}var instID=$k.instance.save();$nim.SetId($nim.instN(de));return G.apply(G,arguments);}catch(err){if($k.errhandler){$k.errhandler(err,event,func_name,'fn.wrapfn');}}finally{$k.instance.restore(instID);}return null;};};$nim.G.WrapAllFunctions=function(bq,dlg){var G,de=dlg;for(G in bq){switch(typeof(bq[G])){case 'function':bq[G]=$nim.G.WrapFn(null,bq[G],de,G);break;case 'object':$nim.G.WrapAllFunctions(bq[G],de);break;default:break;}}};$nim.G.TriggerDlgEvent=function(dlg_inst,evt_name,evt_state){var ret,de;de=dlg_inst.resolveName('form')||dlg_inst;try{if(!KERNEL.isApiRunning(evt_name,de)){if(App&&App.Dialog){if(App.Dialog[de]&&App.Dialog[de].isLoaded){if($f.events(de,evt_name)){try{var instID=$k.instance.save();$nim.SetId(dlg_inst);ret=$f.events(de,evt_name)(evt_state,dlg_inst.resolveName());}catch(err){if($k.errhandler){$k.errhandler(err,null,'fn.triggerdlgevent');}}finally{$k.instance.restore(instID);}}}}}}catch(err){}finally{KERNEL.apiComplete(evt_name,de);}return ret;};$nim.G.AssignInstance=function(app,instId){if(app&&instId){if(!app.Previous){app.Previous={};}if(!app.Current){app.Current={};}if(!app.Current.id|| !app.Previous.id||(app.Previous.id!=app.Current.id)){app.Previous=app.Current;}app.Current=instId.resolveName();app.Current.id=instId;}};$nim.G.setElemStyle=function(type,de,bE,value){var cc=$nim.am(type+$nim.instN(de));if(cc){cc.style[bE]=value;}cc=null;};$nim.G.setElemProp=function(type,de,bE,value){var cc=$nim.am(type+$nim.instN(de));if(cc){cc.setAttribute(bE,value);}cc=null;};$nim.G.mergeObjects=function(bq,src){var key;for(key in src){if(src.hasOwnProperty(key))bq[key]=src[key];}return bq;};$nim.G.deepMerge=function(bq,...src){if(!src.length)return bq;var source=src.shift();function isObject(item){return(item&&typeof(item)=='object'&& !Array.isArray(item));};if(isObject(bq)&&isObject(source)){for(var key in source){if(isObject(source[key])){if(!bq[key])Object.assign(bq,{[key]:{}});$nim.G.deepMerge(bq[key],source[key]);}else{Object.assign(bq,{[key]:source[key]});}}}return bq;};$nim.G.flattenValueObjects=function(inObj){var fld,lObj=inObj;for(fld in lObj){if(lObj[fld]&&typeof lObj[fld]=='object'){if(lObj[fld].value){lObj[fld]=lObj[fld].value;}else{var dm=lObj[fld];lObj[fld]=$nim.G.flattenValueObjects(dm);}}}fld=null;dm=null;return lObj;};$nim.G.viewState=function(de,blRestore,blPreserve){var au=$nim.instN(de,''),cc=$nim.am(au),face=$nim.dE(cc.id,'facing'),aj=$nim.am($nim.instN(de,'body')),dw=$nim.am($nim.instN(de,'page.back'));if(blRestore){if(cc)$nim.G.popStyles(cc,'opacity,display,visibility',blPreserve);if(aj)$nim.G.popStyles(aj,'opacity,display,visibility',blPreserve);if(dw)$nim.G.popStyles(dw,'opacity,display,visibility',blPreserve);if(!blPreserve)cc.stateSaved=false;}else{if(cc.stateSaved)return;if(cc)$nim.G.pushStyles(cc,'opacity,display,visibility');if(aj)$nim.G.pushStyles(aj,'opacity,display,visibility');if(dw)$nim.G.pushStyles(dw,'opacity,display,visibility');cc.stateSaved=true;}};$nim.G.cloneChildren=function(de,K,target,basename,blSkipEvents){var chldrn,child,cObj,af,basetarget;var nextname,nxt,found;target=target.toLowerCase();if($f.type(de,K)=='div'&&basename){chldrn=$f.children(de,K);for(var chld=0;chld<chldrn;chld++){child=$f.children(de,K,chld);if(child){cObj=child.id.resolveName();if(cObj.ControlIndex== -1){af=cObj.BaseControl.split(':')[1]||cObj.BaseControl.split(':')[0];nextname=basename.split(':')[0]+(af?(':'+af):'');$f.clone(de,cObj.BaseControl,nextname,target,false,blSkipEvents);}else{$f.next(de,cObj.BaseControl,target,false,blSkipEvents);}}}}};$nim._tmr=0;$nim._ids=[];$nim._struct={};$nim._elems=[];$nim._palette={};$nim._syselems=['background.video','background.videosource','background.body','icon.body','home.body','desktop1.background','desktop1.body','desktop1.disabled','desktop1','desktop2.background','desktop2.body','desktop2.disabled','desktop2','desktop3.background','desktop3.body','desktop3.disabled','desktop3','desktop4.background','desktop4.body','desktop4.disabled','desktop4','desktop5.background','desktop5.body','desktop5.disabled','desktop5','desktop6.background','desktop6.body','desktop6.disabled','desktop6','desktop7.background','desktop7.body','desktop7.disabled','desktop7','desktop8.background','desktop8.body','desktop8.disabled','desktop8','desktop9.background','desktop9.body','desktop9.disabled','desktop9','app.logo','app.login','app.logon','app.library','`app.ip','app.title','app.about','app.author','app.date'];$nim["event"]=$nim.G.buildEvent;$nim.G.V=function(id){var bS,cc=null,ret;if(id&&id.indexOf){bS=$nim._syselems.indexOf(id);if(bS== -1){bS=$nim._ids.indexOf(id);cc=(bS!= -1)?$nim._elems[bS]:document.getElementById(id);if(bS> -1){$nim._ids.splice(bS,1);$nim._elems.splice(bS,1);}if(cc){$nim._ids.unshift(id);$nim._elems.unshift(cc);}if($nim._ids.length>25){$nim._ids.shift();$nim._elems.shift();}}else{cc=(bS!= -1)?document.getElementById(id):null;}if(!cc&&id.indexOf('.body')== -1)return $nim.G.V(id+'.body');}return cc;};$nim.G.DropId=function(id){var bS,del=[];bS=$nim._ids.indexOf(id);if(bS> -1){$nim._ids.forEach(function(it,bS){(it.indexOf(id)> -1)?del.push(bS):null;});for(var i=del.length;i>0;i--){$nim._ids.splice(del[i-1],1);$nim._elems.splice(del[i-1],1);}}id=id.split('.div')[0];for(var ids in $nim._struct){if(id==ids||ids.indexOf(id+'.')> -1)delete $nim._struct[ids];}};$nim.G.RenameId=function(dlg,type,oldid,newid){var newinst,bq,start,end;for(var ids in $nim._struct){if(ids.indexOf(dlg)> -1){bq=ids.resolveName();newinst='';start='';if(type=='form'){if(ids.indexOf(']~'+oldid+'(')> -1){start=']~';end='(';}if(ids.indexOf(']~'+oldid+' ')> -1){start=']~';end=' ';}}else{if(ids.indexOf(').'+oldid)> -1&&bq.Control==oldid){start=').';end='';}if(ids.indexOf('.'+oldid+':')> -1){start='.';end=':';}}if(start)newinst=$nim.aX(start+oldid+end,start+newid+end,ids);if(newinst){$nim._struct[newinst]=$nim.copy($nim._struct[ids]);delete $nim._struct[ids];}}}};$nim.G.UpdateIds=function(){var id='',x=$nim._ids.length-1;while(x> -1){id=$nim._ids[x];if(!document.getElementById(id)){$nim.G.DropId(id);}x--;}};$nim["fn"]=$nim.G;$nim.aK={tTimer:null,interval:globals._core.timerInterval,step:globals._core.timerStep,max:100,que:[],running:[],timers:[],next:function(){var self=$nim.aK;var qRun=self.running,qTmr=self.timers,qQue=self.que;var stimer,ok2Add;var bS,i,x;function bO(i){var cTmr=qRun[i];if(DESKTOP.visible){if(!cTmr.call|| !cTmr.bq){self.remove(cTmr.stimer);}else{if(cTmr.call){cTmr.call(cTmr.bq);}if(!cTmr.bq||(!cTmr.bq.call&& !dA($nim.dE(cTmr.cc.id,'stimer')))){self.remove(cTmr.stimer);}}}};function dK(i){var cTmr=qRun[i];stimer=setInterval(function(){bO(i);},cTmr.interval);cTmr.stimer=stimer;if(cTmr.cc){$nim.df(cTmr.cc.id,"stimer",stimer);}};if(qQue.length>0){for(x=0;x<self.step;x++){if(qTmr.length<self.max){if(!$nim.undef(qQue[0])){ok2Add=true;for(i=0;i<qRun.length;i++){if(qRun[i]&&qRun[i].stimer){if(qTmr.indexOf(qRun[i].stimer)== -1){bS=i;ok2Add=false;break;}}}if(ok2Add){bS=qRun.length;qRun.push(qQue[0]);}else{qRun[bS]=qQue[0];}dK(bS);qTmr.push(stimer);qQue.splice(0,1);}}}if(self.tTimer){clearTimeout(self.tTimer);}self.tTimer=setTimeout(function(){self.next();},self.interval);}else{window.clearTimeout(self.tTimer);self.tTimer=null;}},add:function(cc,bq,interval,callback){var self=$nim.aK;var i,cTmr,bS,blFound=false;var qQue=self.que;for(i=0;i<qQue.length;i++){if(qQue[i].cc.id==cc.id){blFound=true;bS=i;break;}}if(blFound){qQue[bS].bq=bq;qQue[bS].interval=interval;qQue[bS].call=callback;}else{cTmr={cc:cc,bq:bq,interval:interval,call:callback};qQue.push(cTmr);}if(self.tTimer===null){self.tTimer=setTimeout(function(){self.next();},self.interval);}},remove:function(stimer){var self=$nim.aK;var i,bS,cTmr,qRun=self.running,qTmr=self.timers;window.clearInterval(stimer);bS=qTmr.indexOf(stimer);if(bS> -1){qTmr.splice(bS,1);}for(i=0;i<qRun.length;i++){cTmr=qRun[i];if(cTmr.stimer==stimer){cTmr.cc=null;cTmr.call=null;if(cTmr.bq&&cTmr.bq._){cTmr.bq._.cc=null;}cTmr.bq=null;}}}};$nim.C=cU({aX:function(find,repl,str){var x,F,fld;function cB(find,repl,str){var ret="";if(str&&typeof str=='string'){find=$nim.G.escRegExp(find);ret=str.replace(new RegExp(find,'g'),repl);}else{return str||'';}return ret;};switch($nim.G.type(find)){case 'array':F=find.length;for(x=0;x<F;x++){str=cB(find[x].search,find[x].replace,str);}return str;break;case 'object':for(fld in find){if(typeof(find[fld])!='function')str=cB(fld,find[fld],str);}return str;break;default:return cB(find,repl,str);}return str||'';},fC:function(cc){if(typeof(cc.rotateX)==$nim._keys(4)){cc.rotateX=0;}if(typeof(cc.rotateY)==$nim._keys(4)){cc.rotateY=0;}if(typeof(cc.rotateZ)==$nim._keys(4)){cc.rotateZ=0;}if(typeof(cc.az)==$nim._keys(4)){cc.az='0px';}if(typeof(cc.ar)==$nim._keys(4)){cc.ar='0px';}if(typeof(cc.bj)==$nim._keys(4)){cc.bj='0px';}if(typeof(cc.ba)==$nim._keys(4)){cc.ba=1;}if(typeof(cc.bA)==$nim._keys(4)){cc.bA=1;}},afterEvent:function(J,ename){if(J.addEventListener){J.addEventListener(ename,function(e){$nim.aO.setInstance(e.target.id);if($nim.bi){KERNEL.focus=e.target.id.resolveName('app');}var x,scan=globals._core.eventScan,cD=e.target;for(x=0;x<scan;x++){if(cD.id.indexOf('.div')== -1){if(cD.parentNode){cD=cD.parentNode;}else{break;}}else{break;}}if(cD){if(cD.blStop&&e&&e.stopPropagation){e.stopPropagation();}}},false);}else if(J.attachEvent){J.attachEvent(ename,function(e){$nim.aO.setInstance(e.target.id);if($nim.bi){KERNEL.focus=e.target.id.resolveName('app');}var x,scan=globals._core.eventScan,cD=e.target;for(x=0;x<scan;x++){if(cD.id.indexOf('.div')== -1){if(cD.parentNode){cD=cD.parentNode;}else{break;}}else{break;}}if(cD){if(cD.blStop&&e&&e.stopPropagation){e.stopPropagation();}}});}},View:{_exists:function(de,vwName){return(App.Dialog[de].Views&&App.Dialog[de].Views[vwName]);},Hide:function(e,dp,trans){'use strict';var i,F,dkeys,child;if(!$nim.undef(dp["ctype"])){if($nim.G.cu(dp,$nim._d)){var dhnd=$nim.G.V(dp.id);var bf=$nim.G.V(dp.id+$nim.aY+"resize");if(dhnd){var dlgW=$nim.G.dk(dhnd),dlgH=$nim.G.dC(dhnd);if(bf){bf.style['display']='none';}if(dhnd.childNodes.length>0){for(i=0,F=dhnd.childNodes.length;i<F;i++){child=dhnd.childNodes[i];dkeys=child.dock;if(!$nim.undef(child)){if((dkeys!='!!!!')&&(dkeys!='----')&&(dkeys!==null)){if((!$nim.undef(child.id))&&(child.style)){var bq=child.id.resolveName(),disL=$nim.G.cX(child),disT=$nim.G.cF(child),cW=$nim.G.dk(child),cH=$nim.G.dC(child);var disR=Math.abs(dlgW-(disL+cW)),disB=Math.abs(dlgH-(disT+cH)),slide="";if(disL<=disT){if(disL<=disR){if(disL<=disB){slide="left";}else{slide="bottom";}}else{if(disR<=disB){slide="right";}else{slide="bottom";}}}else{if(disT<=disR){if(disT<=disB){slide="top";}else{slide="bottom";}}else{if(disR<=disB){slide="right";}else{slide="bottom";}}}$f.hide(bq.Form,bq.Control);}}}}}}}}dhnd=null;bf=null;},Set:function(de,vwName,trans,blMatch,blAdd){'use strict';vwName=vwName.toLowerCase();var x=0,dI,aM,delm=($nim.cK.ideVer=='v5.0')?"|":",",au=$nim.instN(de,''),dlgSize=$f.getsize(de),transCnt=0,cc=$nim.am(au);function inView(af){var crds=$f.getcoords(de,af);crds.right=(crds.left+crds.width);crds.bottom=(crds.top+crds.height);if(((crds.left>0&&crds.left<dlgSize.width)||(crds.right>0&&crds.right<dlgSize.width))&&((crds.top>0&&crds.top<dlgSize.height)||(crds.bottom>0&&crds.bottom<dlgSize.height))){return true;}return false;};function aZ(){dlgSize=$f.getsize(de);for(var x=0;x<bZ.length;x++){dI=bZ[x].split(delm);aM=dI[0].split('=');if(aM[1]!='form'){if(!inView(aM[0])){$f.hide(de,aM[0]);}}}};if(blMatch){for(x=$nim.Agent.keystates.length-1;x>=0;x--){if($nim.C.View._exists(de,$nim.Agent.keystates[x]+vwName)){vwName=$nim.Agent.keystates[x]+vwName;break;}}}if(cc){if(!blAdd){$f.alter.view.hide(de,trans);}var bZ=App.Dialog[de].Views[vwName];if(bZ){for(x=0;x<bZ.length;x++){dI=bZ[x].split(delm);aM=dI[0].split('=');if(aM[1]=='form'){$f.size(de,'',dA(dI[3]),dA(dI[4]));if(dA(dI[6])){$f.enable(de);}else{$f.disable(de);}if(dA(dI[7])){$f.show(de);}else{$f.hide(de);}if(!$nim.undef(dI[8])){$f.setstyle(de,'',"background-color",dI[8]);}}}if(!blAdd){$f.alter.view.hide(de,trans);}transCnt=bZ.length-1;for(x=0;x<bZ.length;x++){dI=bZ[x].split(delm);aM=dI[0].split('=');if(aM[1]!='form'){if(trans){$f[$nim.mv](de,aM[0],dA(dI[1]),dA(dI[2]),dA(dI[3]),dA(dI[4]),0.30,function(anim){if(anim.pos==100){transCnt--;if(transCnt<1)aZ();}});}else{if(aM[1]=='tab'){$f.resize(de,aM[0],dA(dI[3]),dA(dI[4]));}else{$f.size(de,aM[0],dA(dI[3]),dA(dI[4]));}$f.move(de,aM[0],dA(dI[1]),dA(dI[2]));}$f.setprop(de,aM[0],'dock',dI[5]);if(dA(dI[6])){$f.setprop(de,aM[0],"disabled",'false');}else{$f.setprop(de,aM[0],"disabled",'true');}if(dA(dI[7])){$f.show(de,aM[0]);}else{$f.hide(de,aM[0]);}if(aM.length>8){if(!$nim.undef(dI[8])){$f.setstyle(de,aM[0],"background-color",dI[8]);}if(!$nim.undef(dI[9])){$f.setstyle(de,aM[0],"color",dI[9]);}$f.setstyle(de,aM[0],"font",dI[13]+" "+dI[12]+" "+dI[11]+" "+dI[10]+" ");}}}if(!trans)aZ();}if(App&&App.Dialog&&App.Dialog[de]){$nim.G.TriggerDlgEvent(au,'ViewChange',{dialog:de,view:vwName});$f.updatecoords(de);}}}},Menu:{_tmr:0,_list:[],bo:null,openmenu:[],_ok2Clip:function(dlg){if($f.getprop(dlg,'','clipmenu')=='false'){var enab,openmenu=$nim.Menu.openmenu,cc=$f.ifind($f.getinstname(dlg,'body'));enab=(openmenu.length===0)?true:false;if(cc){if(enab){$f.setstyle(dlg,'body','overflow','hidden');$f.popstyles(cc,'overflow');}else{$f.pushstyles(cc,'overflow');$f.setstyle(dlg,'','overflow','visible');}}}},_configure:function(actnAry,hkeyAry){var actions=actnAry||[];var hkeys=hkeyAry||[];var self=$nim.C.Menu,openmenu=self.openmenu;setTimeout(function(){if(hkeys&&hkeys.forEach){hkeys.forEach(function(hkey){$nim.G.attachHotkey(hkey.item.id,hkey.key);});}if(actions&&actions.forEach){actions.forEach(function(aM){var cc,aj,dlg,af;dlg=aM.item.Form;af=aM.item.Control+((aM.item.Component)?('.'+aM.item.Component):'');switch(aM.action){case 'disable':$f.disable(dlg,af);break;case 'settings':$f.setprop(aM.item.Form,aM.item.Control,'settings',aM.value);break;case 'autohide':cc=$f.cc(aM.item.Form,aM.item.Control+'.div');aj=$f.cc(aM.item.Form,'body');if(aj){aj.menuhide=true;}if(cc){if(!cc.onmouseleave){cc.onmouseleave=function(e){if(openmenu.length>0)return;var yPos=e.target.offsetTop;if(yPos> -(defaults.menus.menu_height+2)){var aM=e.target.id.resolveName(),cc=$f.cc(aM.Form,aM.Control+'.div');cc.style['overflow']='hidden';self._tmr=setTimeout(function(){$f[$nim.mv](aM.Form,aM.Control,0.1,defaults.dialog.title_height+2,-1,5,0.35);},1600);}};}if(!cc.onmouseenter){cc.onmouseenter=function(e){var aM=e.target.id.resolveName(),pos=$f.getpos(aM.Form,aM.Control),cc=$f.cc(aM.Form,aM.Control+'.div');cc.style['overflow']='visible';if(self._tmr){clearTimeout(self._tmr);self._tmr=0;}if(pos){$f[$nim.mv](aM.Form,aM.Control,0.1,defaults.dialog.title_height+2,-1,(defaults.menus.menu_height+14),0.35);}};}$f[$nim.mv](aM.item.Form,aM.item.Control,0.1,defaults.dialog.title_height+2,-1,5,0.35);}break;default:break;}});}},1000);},AddItem:function(dlg,af,parms){var mClass,instForm=$nim.instN(dlg,''),bC=$nim.bName(dlg,af);var parent=$nim.G.V(bC),hstyle,dm={},O=document,li,cc,relem,mnuid=bC+'-'+parms.menu.id;if(parent&&parms.menu){if(parms.menu.caption=='-'){mClass='sub-hdivider';parms.menu.caption="&nbsp;&nbsp;";}else{mClass='sub-item';}parent.style['min-width']=(defaults.menus.menu_width||190)+'px';parms.menu.data=parms.menu.data||parms.menu.id;parms.menu.style=parms.menu.style||'';parms.menu.settings=parms.menu.settings||'000';hstyle='border-radius:11px;opacity:1;font-family:#subitem.font#;font-size:#subitem.fontsize#;';if(hstyle.indexOf('#subitem.backcolor#')> -1){dm["#subitem.backcolor#"]=$nim.cn.menus.subitem_backcolor;}if(hstyle.indexOf('#subitem.forecolor#')> -1){dm["#subitem.forecolor#"]=$nim.cn.menus.subitem_forecolor;}if(hstyle.indexOf('#subitem.font#')> -1){dm["#subitem.font#"]=$nim.cn.menus.subitem_fontfamily;}if(hstyle.indexOf('#subitem.fontsize#')> -1){dm["#subitem.fontsize#"]=$nim.cn.menus.subitem_fontsize;}hstyle=$nim.aX(dm,null,hstyle);li=$nim.G.vDOM("li");li.attrib('type','menu');li.attrib('id',mnuid);li.attrib('class',mClass);if(typeof(parms.menu.data)=='object'){li.attrib('data',JSON.stringify(parms.menu.data));}else{li.attrib('data',parms.menu.data);}li.attrib('settings',parms.menu.settings);li.attrib('depth',parms.menu.depth);li.attrib('style',hstyle+parms.menu.style);if(parms.menu.remove){li.innerHTML='<a id="'+mnuid+'.remove" title="Remove." class="item_close" style="float:right;">'+'<span style="position:relative;pointer-events:none;">&nbsp;&nbsp;</span></a>'+parms.menu.caption;}else{li.innerHTML=(parms.menu.settings.split('')[0]==1)?'<input id="'+mnuid+'.check" ctype="checkbox" type="checkbox" style="float:right;margin-right:-9px;cursor:pointer;display:table-cell;vertical-align:middle;">':'';li.innerHTML+=parms.menu.caption;}cc=li.create();if(cc){cc.style['min-width']=(defaults.menus.menu_width||190)+'px';parent.appendChild(cc);}if(parms.menu.click){cc.onclick=parms.menu.click;}if(parms.menu.mouseover){cc.onmouseover=parms.menu.mouseover;}if(parms.menu.mouseout){cc.onmouseout=parms.menu.mouseout;}if(parms.menu.remove){relem=O.getElementById(mnuid+'.remove');if(relem){relem.onclick=parms.menu.remove;if(typeof(parms.menu.data)=='object'){relem.setAttribute('data',JSON.stringify(parms.menu.data));}else{relem.setAttribute('data',parms.menu.data);}}}if(parms.menu.settings.split('')[1]==1){$f.disable(dlg,mnuid.resolveName('control'));}if(parms.menu.settings.split('')[2]==1){cc.style['background-color']='rgba(250,250,70, 0.60)';}}else{mnuid=null;}return mnuid;},RemoveItem:function(mnuid){$nim.ax.removeElementById(mnuid);},Hide:function(dlg,af){var cc=$nim.G.V($f.getinstname(dlg,af));var divelem=$nim.G.V($f.getinstname(dlg,af+".div"));if(cc){$nim.G.setDisplay(cc,'none',false);$nim.G.setDisplay(cc.parentNode,'none',false);if(divelem&&['menu','submenu'].indexOf(cc.getAttribute('type'))> -1){$nim.aO.Hide(dlg,af+'.div');}}},Unload:function(dlg,af){var x,cc,mnuid,F=$nim.Menu._list.length-1;for(x=F;x>=0;x--){mnuid=$nim.Menu._list[x];cc=$nim.G.V(mnuid);if(cc){if(cc.getAttribute('type')=='menu'&&cc.getAttribute('menu')==af){cc=null;$nim.ax.removeElementById(mnuid);$nim.Menu._list.splice(x,1);}}}},UnloadAll:function(){var x,cc,mnuid,F=$nim.Menu._list.length-1;for(x=F;x>=0;x--){mnuid=$nim.Menu._list[x];cc=$nim.G.V(mnuid);if(cc){cc=null;$nim.ax.removeElementById(mnuid);$nim.Menu._list.splice(x,1);}}},Show:function(dlg,af,pos,closePrev){var divelem,rec,adjpos,bo=$nim.Menu.bo,openmenu=$nim.Menu.openmenu;if(closePrev&&bo){$nim.G.setDisplay(bo,'none',false);$nim.G.setDisplay(bo.parentNode,'none',false);}if(pos){bo=$nim.G.V($f.getinstname(dlg,af));divelem=$nim.G.V($f.getinstname(dlg,af+".div"));if(bo){bo.dialog=dlg;$nim.G.setDisplay(bo,'block',false);bo.style['min-width']=(defaults.menus.menu_width||150)+'px';bo.style.width='auto';$nim.G.setDisplay(bo.parentNode,'block',false);bo.parentNode.style.left=(pos.left+2)+"px";bo.parentNode.style.top=(pos.top-defaults.menus.menu_height-1)+"px";adjpos=$nim.G.resolveView(bo,dA(bo.parentNode.style.left),dA(bo.parentNode.style.top));bo.parentNode.style.left=adjpos.left+'px';bo.parentNode.style.top=adjpos.top+'px';if(divelem&&['menu','submenu'].indexOf(bo.getAttribute('type'))> -1){$nim.aO.Show(divelem.id.resolveName('form'),divelem.id.resolveName('control')+'.div');}}}if(openmenu.indexOf(bo)== -1){openmenu.push(bo);}$nim.Menu.bo=bo;if(bo){$nim.Menu._ok2Clip(bo.dialog);}},Open:function(dlg,af,closePrev){'use strict';var divelem,src=event?event.target.id?event.target.id:event.target.parentNode.id:null;var bo=$nim.Menu.bo,openmenu=$nim.Menu.openmenu,adjpos,l=0,t=0,w,h,cls;if(closePrev){$nim.Menu.CloseAll(bo);}bo=$nim.G.V(src);if(bo&&closePrev===false){$nim.Menu.CloseAfter(bo.parentNode);}if(bo){cls=bo.className;l=(cls=='sub-item')?(bo.offsetLeft-15):bo.offsetLeft;t=(cls=='sub-item')?bo.offsetTop:0;w=bo.offsetWidth;h=bo.offsetHeight;if(bo.type=='submenu'){var submenu=bo.parentNode.parentNode;if(submenu){l+=submenu.offsetLeft;t+=submenu.offsetTop;if(submenu.children[0])t-=submenu.children[0].scrollTop;}}else{t+=cumenu.parentNode.offsetTop+4;}}bo=$nim.G.V($f.getinstname(dlg,af));divelem=$nim.G.V($f.getinstname(dlg,af+".div"));if(bo){bo.dialog=dlg;$nim.G.setDisplay(bo,'block',false);bo.style['min-width']=(defaults.menus.menu_width||150)+'px';bo.style.width='auto';$nim.G.setDisplay(bo.parentNode,'inline',false);switch(cls){case "item":bo.parentNode.style.left=(l)+"px";bo.parentNode.style.top=(t+h-2)+"px";break;case "sub-item":bo.parentNode.style.left=(l+w)+"px";bo.parentNode.style.top=(t-2)+"px";break;default:break;}adjpos=$nim.G.resolveView(bo,dA(bo.parentNode.style.left),dA(bo.parentNode.style.top));bo.parentNode.style.left=adjpos.left+'px';bo.parentNode.style.top=adjpos.top+'px';if(divelem&&af.indexOf('-')== -1){divelem.style.display='none';}if(divelem&&['menu','submenu'].indexOf(bo.getAttribute('type'))> -1){$nim.aO.Show(divelem.id.resolveName('form'),divelem.id.resolveName('control')+'.div');}}if(openmenu.indexOf(bo)== -1){openmenu.push(bo);}$nim.Menu.bo=bo;if(bo){$nim.Menu._ok2Clip(bo.dialog);}submenu=null;if(event&&event.stopPropagation)event.stopPropagation();},CloseAfter:function(cc){var x,xCnt= -1,blClose,bo=$nim.Menu.bo,openmenu=$nim.Menu.openmenu;for(x=0;x<openmenu.length;x++){if(blClose){$nim.G.setDisplay(openmenu[x],'none',false);$nim.G.setDisplay(openmenu[x].parentNode,'none',false);}if(cc==openmenu[x]){xCnt=x+1;blClose=true;}}if(xCnt> -1){openmenu.length=xCnt;}if(bo){$nim.Menu._ok2Clip(bo.dialog);}},CloseAll:function(){var x,bo=$nim.Menu.bo,openmenu=$nim.Menu.openmenu;if(bo){$nim.G.setDisplay(bo,'none',false);$nim.G.setDisplay(bo.parentNode,'none',false);}for(x=0;x<openmenu.length;x++){if(openmenu[x]){$nim.G.setDisplay(openmenu[x],'none',false);$nim.G.setDisplay(openmenu[x].parentNode,'none',false);}}openmenu.length=0;if(bo){$nim.Menu._ok2Clip(bo.dialog);}}},StatusBar:{_update:function(dlg,cfg){var bE,style;var div=$f.cc(dlg,'statusbar');var body=$f.cc(dlg,'body');var width,bevel={'0':'none','1':'dotted','2':'dashed','3':'solid','4':'double','5':'groove','6':'ridge','7':'inset','8':'outset'};if(body&&div){$nim.df(div.id,'lock-pos',"!!!!");$nim.df(div.id,'lock-size',"!!!!");div.setAttribute('class',"sbar-div");div.style['font-family']=cfg.font;div.style['height']=cfg.height;div.style['z-index']=195;for(style in cfg.styles.bar){div.style[style]=cfg.styles.bar[style];}for(bE in cfg.props.bar){div.setAttribute(bE,cfg.props.bar[bE]);}var cap,last=0,i=0;for(i=0;i<cfg.count;i++){cap=$f.cc(dlg,'statusbar.'+cfg.items[i].split('|')[0]);if(cap){width=cfg.items[i].split('|')[1].trim();cap.setAttribute('class',"sbar-itm sdk-itm");cap.style['font-family']=cfg.font;cap.style['font-size']='12px';cap.style['left']=last+'%';cap.style['width']='calc('+width+' - 14px)';last+=Number(width.left(width.length-1));cap.style['border-style']=bevel[cfg.items[i].split('|')[3].trim()];for(style in cfg.styles.caption){cap.style[style]=cfg.styles.caption[style];}for(bE in cfg.props.caption){cap.setAttribute(bE,cfg.props.caption[bE]);}cap.innerHTML=cfg.items[i].split('|')[2];}}}body=null;div=null;cap=null;},Show:function(dlg,cfg){var cc=$f.cc(dlg,'statusbar');var body=$f.cc(dlg,'body');if(body&& !cc){var div=document.createElement('div');div.id=$nim.bName(dlg,'statusbar');body.appendChild(div);cfg.height=cfg.height||'24px';for(var i=0;i<cfg.count;i++){var cap=document.createElement('div');cap.id=$nim.bName(dlg,'statusbar.'+cfg.items[i].split('|')[0]);div.appendChild(cap);}$nim.StatusBar._update(dlg,cfg);}},Unload:function(dlg){var div=$f.cc(dlg,'statusbar');if(div){$nim.ax.removeElementById(div.id);}div=null;}},ToolBar:{_update:function(dlg,cfg){var div=$f.cc(dlg,'toolbar');var body=$f.cc(dlg,'body');var toppad,baseid,iconid,html;if(body&&div){$nim.df(div.id,'lock-pos',"!!!!");$nim.df(div.id,'lock-size',"!!!!");div.setAttribute('class',"toolbar-"+cfg.type+" "+cfg.style);div.setAttribute('form',dlg);toppad=(body.menu&& !body.menuhide)?(defaults.menus.menu_height+3): !body.menu?8:defaults.menus.menu_height*0.7;div.style['padding-top']=toppad+'px';div.style['min-height']='82px';div.style["background-color"]=cfg.backcolor||'#FFF';if(cfg.zindex)div.style['z-index']=cfg.zindex;baseid=$nim.aX('.toolbar','',div.id);for(var i=0;i<cfg.count;i++){iconid=cfg.items[i].split('|')[0];var cap=$f.cc(dlg,'toolbar-'+iconid);if(cap){if(cfg.items[i].split('|')[1].substr(1,1)=='0')cap.style['display']='none';if(cfg.items[i].split('|')[1].substr(0,1)=='0'){cap.setAttribute('disabled','true');cap.style['opacity']='.45';}cap.setAttribute('class',"icon sdk-itm");cap.setAttribute('form',dlg);if(cfg.bradius)cap.style['border-radius']=cfg.bradius;if(cfg.bwidth)cap.style['border-width']=cfg.bwidth;cap.style['background-color']=cfg.items[i].split('|')[4]||'transparent';html=$nim.HTML["tbar-icon"];if(cfg.items[i].split('|')[2]=='-'){cap.style['max-width']='2px';cap.style['min-height']='70px';cap.style['background-color']='rgba(20,20,20,.25)';}else{if(cfg.items[i].split('|')[1].substr(2,1)=='1'){if($heap[App.instanceOf]&&$heap[App.instanceOf][dlg]&&$heap[App.instanceOf][dlg].Menu){cap.setAttribute('onclick',"$heap."+App.instanceOf+"."+dlg+".Menu('"+iconid+"')");}}html=$nim.aX("<icon.img>",cfg.items[i].split('|')[3],html);}}html=$nim.aX({"#icon#":iconid,"#color#":cfg.color||'#000',"<dlg.form>":dlg,"<icon.img>":"","<caption>":cfg.items[i].split('|')[2],"#element.name#":baseid},null,html);cap.innerHTML=html;}}body=null;div=null;cap=null;},Show:function(dlg,cfg){var cc=$f.cc(dlg,'toolbar');var body=$f.cc(dlg,'body');if(body&& !cc){var div=document.createElement('div');div.id=$nim.bName(dlg,'toolbar');body.appendChild(div);for(var i=0;i<cfg.count;i++){var cap=document.createElement('div'),iconid=cfg.items[i].split('|')[0];cap.id=$nim.bName(dlg,'toolbar-'+iconid);div.appendChild(cap);}$nim.ToolBar._update(dlg,cfg);}},Unload:function(dlg){var div=$f.cc(dlg,'toolbar');if(div){$nim.ax.removeElementById(div.id);}div=null;}},Tooltip:{init:function(dlg){var body,cc=$f.cc(dlg,'tooltip');var aI,inst=$f.buildname(dlg);if(!cc){body=$f.cc(dlg,'body');if(body){aI=document.createElement('div');aI.id=inst+'.tooltip';$nim.df(aI.id,'lock-pos','!!!!');$nim.df(aI.id,'lock-size','!!!!');aI.setAttribute('class','tooltip fadeout');aI.innerHTML='<span id="'+inst+'.tooltip.caption" class="tooltiptext-bottomarrow tiphide"></span>';body.appendChild(aI);aI.style['z-index']=$nim.ab.MOVE2DRAG;}}},setpos:function(cc,side){var tip,id=cc?cc.id:null,dlg=id?id.resolveName('form'):'',af=id?id.resolveName('control'):'',coords=$f.getcoords(dlg,af);if(cc){tip=$f.cc(dlg,'tooltip');if(tip){tip.style.border='none';tip.style.left=coords.left+'px';tip.style.top=coords.top+'px';tip.style.width=coords.width+'px';tip.style.height=coords.height+'px';}}},closestside:function(cx,cy,coords){var w=coords.width||DESKTOP.width,h=coords.height||DESKTOP.height;var dmap={};dmap[cx]='leftarrow';dmap[cy]='toparrow';dmap[(w-cx)]='rightarrow';dmap[(h-cy)]='bottomarrow';var dmin=Math.min(cx,cy,(w-cx),(h-cy));return dmap[dmin]||'bottomarrow';},attach:function(dlg,af){var cc=$f.cc(dlg,af);if(cc){cc.addEventListener('mouseleave',function(e){$nim.by.tipMouseLeave(e);});cc.addEventListener('mouseenter',function(e){$nim.by.tipMouseEnter(e);});}}},ad:{MinimizeAll:function(){var dlgname,x,F;var curApp=App;F=ad.length;for(x=0;x<F;x++){if((ad[x].target==FORMS.Target)&&(ad[x].Vars.running===true)){App=ad[x];$k.instance.setapp(App);for(dlgname in App.Dialog){$f.min(dlgname);}}}App=curApp;curApp=null;dlgname=null;},CloseAll:function(){var dlgname,x,F;var curApp=App;F=ad.length-1;for(x=F;x>=0;x--){if((ad[x].target==FORMS.Target)&&(ad[x].Vars.running===true)){App=ad[x];$k.instance.setapp(App);App.End();}}App=curApp;curApp=null;dlgname=null;},RestoreAll:function(){var dlgname,x,F;var curApp=App;F=ad.length;for(x=0;x<F;x++){if((ad[x].target==FORMS.Target)&&(ad[x].Vars.running===true)){App=ad[x];$k.instance.setapp(App);for(dlgname in App.Dialog){$f.restore(dlgname);}}}App=curApp;curApp=null;dlgname=null;}}});$nim.ax=cU({buildKey:function(){var states=[];$nim.Agent.keystates=[];$nim.Agent.key='';$nim.Agent.defaultkey='';$nim.ax.orientation();if($nim.Agent.isMobile){states=[{check:'usingIPad',key:'ios.'},{check:'usingAndroid',key:'droid.'},{check:'usingWinPhone',key:'win.'},{check:'orient',key:$nim.Agent.orient+'.'}];$nim.Agent.defaultkey='mobile.';}else{states=[{check:'usingIE',key:'ie.'},{check:'usingFF',key:'ff.'},{check:'usingO',key:'o.'},{check:'usingS',key:'saf.'},{check:'orient',key:$nim.Agent.orient+'.'}];$nim.Agent.defaultkey='desktop.';}if($nim.Agent.keystates.indexOf($nim.Agent.defaultkey)== -1){$nim.Agent.keystates.push($nim.Agent.defaultkey);}states.forEach(function(aM){$nim.Agent.key+=($nim.Agent[aM.check])?aM.key:'';if($nim.Agent.key&&$nim.Agent.keystates.indexOf($nim.Agent.key)== -1){$nim.Agent.keystates.push($nim.Agent.defaultkey+$nim.Agent.key);$nim.Agent.keystates.push($nim.Agent.key);}});},mobileVersion:function(){var ua,uv;var re,rv= -1;if($nim.undef($nim.Agent.usingEdge)){$nim.Agent.usingEdge=false;}if($nim.undef($nim.Agent.usingIE)){$nim.Agent.usingIE=false;}if($nim.undef($nim.Agent.usingFF)){$nim.Agent.usingFF=false;}if($nim.undef($nim.Agent.usingO)){$nim.Agent.usingO=false;}if($nim.undef($nim.Agent.usingS)){$nim.Agent.usingS=false;}if($nim.undef($nim.Agent.isMobile)){$nim.Agent.isMobile=false;}ua=navigator.userAgent;uv=navigator.vendor;$nim.Agent.usingEdge=(ua.indexOf('Edge')> -1);$nim.Agent.usingFF=(ua.indexOf('Firefox')> -1);$nim.Agent.usingO=(ua.indexOf('Opera')> -1);$nim.Agent.usingS=(uv.indexOf('Apple')> -1&&ua.indexOf('Safari')> -1);$nim.Agent.usingIPad=(ua.indexOf('iPad')> -1)||(ua.indexOf('iPhone')> -1);$nim.Agent.usingAndroid=(ua.indexOf("Android")> -1);$nim.Agent.isMobile=(ua.indexOf('Mobile')> -1)||$nim.Agent.usingIPad;$nim.Agent.cssPrefix='-webkit-';if($nim.Agent.usingFF){$nim.Agent.cssPrefix='-moz-';}if(navigator.appName=='Microsoft Internet Explorer'){re=new RegExp("MSIE ([0-9]{1,}[\.0-9]{0,})");if(re.exec(ua)!==null)rv=parseFloat(RegExp.$1);}else if(navigator.appName=='Netscape'){re=new RegExp("Trident/.*rv:([0-9]{1,}[\.0-9]{0,})");if(re.exec(ua)!==null)rv=parseFloat(RegExp.$1);}if(rv> -1){$nim.Agent.usingIE=true;$nim.Agent.cssPrefix='-ms-';$nim.Agent.version=rv;}$nim.ax.buildKey();},orientation:function(){if(DESKTOP.width>DESKTOP.height){$nim.Agent.orient='landscape';}else{$nim.Agent.orient='portrait';}DESKTOP.gridWidth=DESKTOP.width;DESKTOP.gridHeight=DESKTOP.height;DESKTOP.columnHeight=Math.floor(DESKTOP.height*0.96);DESKTOP.columnWidth=Math.floor(500*0.96);DESKTOP.Spacing=10;DESKTOP.gridWidth=DESKTOP.width*0.90;DESKTOP.cols=Math.floor(DESKTOP.gridWidth/DESKTOP.columnWidth);if(DESKTOP.width<1920){DESKTOP.columnWidth=Math.floor(450*0.96);DESKTOP.gridWidth=DESKTOP.width*0.92;DESKTOP.cols=Math.floor(DESKTOP.gridWidth/DESKTOP.columnWidth);}if(DESKTOP.width<1024){DESKTOP.columnWidth=Math.floor(360*0.96);DESKTOP.gridWidth=DESKTOP.width*0.94;DESKTOP.cols=Math.floor(DESKTOP.gridWidth/DESKTOP.columnWidth);}if(DESKTOP.width<360){DESKTOP.columnWidth=Math.floor(360*0.96);DESKTOP.gridWidth=DESKTOP.width*0.96;DESKTOP.cols=Math.floor(DESKTOP.gridWidth/DESKTOP.columnWidth);DESKTOP.Spacing=0;}if(DESKTOP.cols<1){DESKTOP.cols=1;}DESKTOP.columnWStep=DESKTOP.columnWidth;DESKTOP.columnWidth=DESKTOP.columnWidth-DESKTOP.Spacing;DESKTOP.columnHStep=DESKTOP.columnWidth*(DESKTOP.width/DESKTOP.height);DESKTOP.columnHeight=DESKTOP.columnHeight-DESKTOP.Spacing;},triggerEvent:function(aJ,e){var cc=$nim.G.V(aJ);if(cc){if(window.CustomEvent){cc.dispatchEvent(new CustomEvent(e));}else if(document.createEvent){var ev=document.createEvent('HTMLEvents');ev.initEvent(e,true,false);cc.dispatchEvent(ev);}else{cc.fireEvent(e);}}},createFrag:function(html){var frag=document.createDocumentFragment(),temp=document.createElement('div');temp.innerHTML=html;while(temp.firstChild){frag.appendChild(temp.firstChild);}return frag;},insertBefore:function(html,aJ){var newelem,cc=$nim.G.V(aJ);if((cc)&&(html)){newelem=$nim.ax.createFrag(html);cc.parentNode.appendChild(newelem);cc.parentNode.insertBefore(newelem,cc);}},insertAfter:function(html,aJ){var newelem,cc=$nim.G.V(aJ);if((cc)&&(html)){newelem=$nim.ax.createFrag(html);cc.parentNode.appendChild(newelem);if(cc.nextSibling){cc.parentNode.insertBefore(newelem,cc.nextSibling);}}},bG:function(id,ctype,blStop,pevent){var J=$nim.G.V(id);var bq=id.resolveName(),tab_hgt=$nim.cn.dialog.tab_height;function setState(e){var form;if(e.target.getAttribute("form")!==null&&KERNEL.lastId!==null&&KERNEL.curTarget){form=KERNEL.curTarget.getAttribute("form");if(form){if($nim.G.cu(KERNEL.curTarget,$nim._d)&& !$nim.G.cu(KERNEL.curTarget,$nim._s)){if($f.getprop(form,'','ignorezorder')=='false'){$f.setstyle(form,'','z-index',$nim.ab.MOVE2MID);}}}}$nim.SetId(id);if($nim.bi){KERNEL.focus=id.resolveName('app');}form=e.target.getAttribute("form");if(form){if($nim.G.cu(e.target,$nim._d)&& !$nim.G.cu(e.target,$nim._s)){if($f.getprop(form,'','ignorezorder')=='false'){$f.zorder(form,1);}}}KERNEL.curTarget=e.target;KERNEL.curId=e.target.id;if(!KERNEL.sdkMode){if(!$nim.undef(e.target.blStop)){if(e.target.blStop!==false){if(e&&e.stopPropagation)e.stopPropagation();}}else{if(e&&e.stopPropagation)e.stopPropagation();}}};if(J){if(!$nim.undef($nim.HTML[ctype])){KERNEL.memused=KERNEL.memused+$nim.HTML[ctype].length;}J["ctype"]=ctype;J.blStop=true;if(!$nim.undef(blStop)){J.blStop=blStop;}if((bq.Form)&&(bq.Control)){J.setAttribute("parent",id.split('.')[0]);}if(bq.Form){J.setAttribute("form",bq.Form);}if($nim.dE(J.id,"rtimer")===null){$nim.df(J.id,"rtimer","0");}if($nim.dE(J.id,"stimer")===null){$nim.df(J.id,"stimer","0");}if($nim.dE(J.id,"ftimer")===null){$nim.df(J.id,"ftimer","0");}J.setAttribute("curinst",KERNEL.curAppIndex.toString());J.setAttribute("appid",KERNEL.curAppId.toString());switch(ctype){case "dialog.skin":case "dialog.plain":case "dialog.surface":$nim.df(J.id,"bindid","");if(USER._libs['tooltip.web'])$nim.Tooltip.init(bq.Form);break;case "menu":$nim.df(J.id+".div",{'lock-pos':'!!!!','lock-width':'!!!!','dock':'----'});break;case "submenu":$nim.df(J.id,'dock',"FFFF");break;case "control":$nim.df(J.id,'dock',"----");break;case "tab":J.cposition="top-left";break;case "icon":if(pevent=='auto')$nim.df(J.id,'prv-display',J.style['display']||'inline-block');break;case "panel":case "panellist":case "panel-list":$nim.df(J.id,{"lock-width":"!!!!","bindid":""});break;default:$nim.df(J.id,"bindid","");break;}J.style['box-sizing']='border-box';if(pevent)J.style['pointer-events']=pevent;if(id.substr(id.length-4)!=$nim.aY+'div'){if(J.addEventListener){if($nim.Agent.isMobile){J.addEventListener('touchstart',setState,false);J.addEventListener('touchend',setState,false);J.addEventListener('touchmove',setState,false);}else{J.addEventListener('mousedown',setState,false);}}else if(J.attachEvent){if($nim.Agent.isMobile){J.attachEvent('touchstart',setState);J.attachEvent('touchend',setState);J.attachEvent('touchmove',setState);}else{J.attachEvent('onmousedown',setState);}}}$nim.G.lockFlags(J);}J=null;},bK:function(id){var J=$nim.G.V(id);if(J){if(dA($nim.dE(J.id,"stimer"))>0){$nim.aK.remove(dA($nim.dE(J.id,'stimer')));$nim.df(J.id,"stimer","0");}if(dA($nim.dE(J.id,"rtimer"))>0){window.clearInterval(dA($nim.dE(J.id,'rtimer')));$nim.df(J.id,"rtimer","0");}if(!$nim.undef(J["ctype"])){if(!$nim.undef($nim.HTML[J["ctype"]])){if(KERNEL.memused>$nim.HTML[J["ctype"]].length){KERNEL.memused=KERNEL.memused-$nim.HTML[J["ctype"]].length;}else{KERNEL.memused=0;}}delete J["ctype"];}['index','ctype','blStop','cC','aG','dragenabled','originalLeft','originalTop','originalWidth','originalHeight','originalOpacity','width','height','initPositionX','initPositionY'].forEach(function(i){delete J[i];});['L','T','W','H'].forEach(function(i){delete J['lock'+i];});if($nim._.drag.ap){if(J.id==$nim._.drag.ap.id){$nim._.drag.ap=null;}}if($nim._.drag.cI){if(J.id==$nim._.drag.cI.id){$nim._.drag.cI=null;}}if($nim._.drag.bL){if(J.id==$nim._.drag.bL.id){$nim._.drag.bL=null;}}if($nim._.drag.ao){if(J.id==$nim._.drag.ao.id){$nim._.drag.ao=null;}}J.onmousedown=null;}},getWindowDimensions:function(){if(!$nim._.core.winDimensions)$nim._.core.winDimensions=$nim.ax.findWindowDimensions();return $nim._.core.winDimensions;},findWindowDimensions:function(){var x,y,O=document;if(self&&self.innerHeight){x=self.innerWidth;y=self.innerHeight;}else if(O.body){x=O.body.offsetWidth;y=O.body.offsetHeight;}O=null;return{"width":x,"height":y};},findDocumentDimensions:function(){var x,y,O=document;var test1=O.body.scrollHeight;var test2=O.body.offsetHeight;if(test1>test2){x=O.body.scrollWidth;y=O.body.scrollHeight;}else{x=O.body.offsetWidth;y=O.body.offsetHeight;}O=null;return{"width":x,"height":y};},getCenteredTopLeft:function(objpos){var width=objpos.width,height=objpos.height,dim=$nim.ax.getWindowDimensions(),hScroll=0,vScroll=0,hPos=Math.round(hScroll+((dim.width-width)/2)),vPos=Math.round(vScroll+((dim.height-height)/2)),left=(hPos<0)?0:hPos,top=(vPos<0)?0:vPos;return{"top":top,"left":left};},removeElementById:function(aJ){var d=$nim.G.V(aJ);$nim.G.DropId(aJ);if(d){var p=d.parentNode?d.parentNode:d.parentElement;p.removeChild(d);}d=null;},findElementsByClass:function(matchClass,elems){var i,clsName='',ret=[];if($nim.undef(elems)){elems=document.getElementsByTagName('*');}if(elems){for(i=0;i<elems.length;i++){clsName=elems[i].getAttribute('class');if(clsName){if((' '+clsName+' ').indexOf(' '+matchClass+' ')> -1){ret.push(elems[i]);}}}}return ret;},onresize:function(e){if($nim.tmrResize)clearTimeout($nim.tmrResize);$nim.tmrResize=setTimeout(function(){$nim.G.triggerAppResize();},80);},onorientationchange:function(e){if($nim.tmrResize)clearTimeout($nim.tmrResize);$nim.tmrResize=setTimeout(function(){switch(window.orientation){case-90:case 90:$nim.Agent.orient='landscape';break;default:$nim.Agent.orient='portrait';break;}$nim.ax.buildKey();$nim.G.triggerAppResize();$nim.ax.mobileVersion();},150);}});$nim.G.initElem=$nim.ax.bG;$nim.ab=cU({MOVE2ZERO:0,MOVE2BOTTOM:100,MOVE2BACK:200,MOVE2MID:300,MOVE2TOP:400,MOVE2DRAG:500,MOVE2TOPMOST:600,POPUP:999999,adjustLayout:function(e,cc,ncoords){'use strict';var O=document;var ag,pxAdj,pyAdj;var xAdj,yAdj,skip,cdock;var dh,adj,cD,zones=[];if(cc){var x=0,attr='',ename='',ocoords=$nim.dE(cc.id,"origSize"),edock=cc.dock,negAdj=$nim.dE(cc.id,"negAdj"),posAdj=$nim.dE(cc.id,"posAdj");if(!KERNEL.isSizing()){cD=cc.getAttribute("parent");ag=O.getElementById(cD);pxAdj=($nim.G.dk(ag)-dA($nim.dE(ag.id,'curW')));pyAdj=($nim.G.dC(ag)-dA($nim.dE(ag.id,'curH')));if(!negAdj|| !posAdj){return;}if(ncoords!==null){var tmpxAdj=(dA(ncoords.split(",")[0])-dA(ocoords.split(",")[0])),tmpyAdj=(dA(ncoords.split(",")[1])-dA(ocoords.split(",")[1]));}if(tmpxAdj<0||tmpyAdj<0||ncoords===null){adj=negAdj.split(";");for(x=0;x<adj.length;x++){xAdj=Math.abs(tmpxAdj);yAdj=Math.abs(tmpyAdj);attr=adj[x].split(':')[0];ename=adj[x].split(':')[1];dh=O.getElementById(cD+'.'+ename+'.div')||O.getElementById(cD+'.'+ename+'.body')||O.getElementById(cD+'.'+ename);if(dh){cdock=dh.dock;if(ncoords!==null){switch(attr){case '+left':$nim.G.cS(dh,($nim.G.cX(dh)+xAdj)+'px');break;case '+width':skip=false;if(pxAdj&&edock.substring(3,4)=='T'&&cdock.substring(3,4)=='T'){$nim.G.cT(dh,($nim.G.dk(dh)-pxAdj));skip=true;}if(!skip){$nim.G.cT(dh,($nim.G.dk(dh)+xAdj));}break;case '+top':$nim.G.cN(dh,($nim.G.cF(dh)+yAdj)+'px');break;case '+height':skip=false;if(pyAdj&&edock.substring(1,2)=='T'&&cdock.substring(1,2)=='T'){$nim.G.cz(dh,($nim.G.dC(dh)-pyAdj));skip=true;}if(!skip){$nim.G.cz(dh,($nim.G.dC(dh)+yAdj));}break;case '-left':$nim.G.cS(dh,($nim.G.cX(dh)-xAdj)+'px');break;case '-width':skip=false;if(pxAdj&&edock.substring(3,4)=='T'&&cdock.substring(3,4)=='T'){$nim.G.cT(dh,($nim.G.dk(dh)-pxAdj));skip=true;}if(!skip){$nim.G.cT(dh,($nim.G.dk(dh)-xAdj));}break;case '-top':$nim.G.cN(dh,($nim.G.cF(dh)-yAdj)+'px');break;case '-height':skip=false;if(pyAdj&&edock.substring(1,2)=='T'&&cdock.substring(1,2)=='T'){$nim.G.cz(dh,($nim.G.dC(dh)-pyAdj));skip=true;}if(!skip){$nim.G.cz(dh,($nim.G.dC(dh)-yAdj));}break;default:break;}if(zones.indexOf(dh.id)== -1){zones.push(dh.id);}}}}}else{if(tmpxAdj>0||tmpyAdj>0||ncoords===null){adj=posAdj.split(";");for(x=0;x<adj.length;x++){xAdj=Math.abs(tmpxAdj);yAdj=Math.abs(tmpyAdj);attr=adj[x].split(':')[0];ename=adj[x].split(':')[1];dh=O.getElementById(cD+'.'+ename+'.div')||O.getElementById(cD+'.'+ename+'.body')||O.getElementById(cD+'.'+ename);if(dh){cdock=dh.dock;if(ncoords!==null){switch(attr){case '+left':$nim.G.cS(dh,($nim.G.cX(dh)+xAdj)+'px');break;case '+width':skip=false;if(pxAdj&&edock.substring(3,4)=='T'&&cdock.substring(3,4)=='T'){$nim.G.cT(dh,($nim.G.dk(dh)-pxAdj));skip=true;}if(!skip){$nim.G.cT(dh,($nim.G.dk(dh)+xAdj));}break;case '+top':$nim.G.cN(dh,($nim.G.cF(dh)+yAdj)+'px');break;case '+height':skip=false;if(pyAdj&&edock.substring(1,2)=='T'&&cdock.substring(1,2)=='T'){$nim.G.cz(dh,($nim.G.dC(dh)-pyAdj));skip=true;}if(!skip){$nim.G.cz(dh,($nim.G.dC(dh)+yAdj));}break;case '-left':$nim.G.cS(dh,($nim.G.cX(dh)-xAdj)+'px');break;case '-width':skip=false;if(pxAdj&&edock.substring(3,4)=='T'&&cdock.substring(3,4)=='T'){$nim.G.cT(dh,($nim.G.dk(dh)-pxAdj));skip=true;}if(!skip){$nim.G.cT(dh,($nim.G.dk(dh)-xAdj));}break;case '-top':$nim.G.cN(dh,($nim.G.cF(dh)-yAdj)+'px');break;case '-height':skip=false;if(pyAdj&&edock.substring(1,2)=='T'&&cdock.substring(1,2)=='T'){$nim.G.cz(dh,($nim.G.dC(dh)-pyAdj));skip=true;}if(!skip){$nim.G.cz(dh,($nim.G.dC(dh)-yAdj));}break;default:break;}if(zones.indexOf(dh.id)== -1){zones.push(dh.id);}}}}}}}for(x=0;x<zones.length;x++){dh=O.getElementById(zones[x]);if($nim.dE(dh.id,'ctype')!='layout'){$nim.ab.resizeChildren(e,dh,false,true);$nim.ab.setOrigCoords(e,dh);}else{$nim.df(dh.id,"origSize",$nim.G.getElemCoords(dh));}}$nim.df(cc.id,"origSize",$nim.G.getElemCoords(cc));}},setOrigCoords:function(e,cc,osize,blLayout,blRes,blSize){var ctl,w,h,val,st,pfx,rsize,dock=true,ctlNme;var blElem=(!$nim.undef(cc.getAttribute));blLayout=blLayout?blLayout:false;osize=osize?osize:null;if(cc){st=cc.id?$nim.dE(cc.id,'state'):'';if(!osize&&blElem){osize= !osize?$nim.G.getElemCoords(cc):osize;rsize=$nim.G.getElemCoords(cc);}else{rsize=osize;}if(!$nim.dE(cc.id,"initSize"))$nim.df(cc.id,"initSize",osize);if(blElem){if($nim.dE(cc.id,'state')=='min'){return;}if(blLayout){if($nim.dE(cc.id,'ctype')=='layout'){$nim.ab.adjustLayout(e,cc,$nim.G.getElemCoords(cc));if((osize&&dock)||(osize&& !$nim.dE(cc.id,"origSize"))){cc.attrib?cc.attrib("origSize",osize):$nim.df(cc.id,"origSize",osize);}if(rsize){cc.attrib?cc.attrib("prvSize",rsize):$nim.df(cc.id,'prvSize',rsize);}}}dock=(cc.dock=='!!!!')?false:true;w=$nim.G.dk(cc)||0;cc.attrib?cc.attrib("actw",w):$nim.df(cc.id,"actw",w);h=$nim.G.dC(cc)||0;cc.attrib?cc.attrib("acth",h):$nim.df(cc.id,"acth",h);if($nim.dE(cc.id,'ctype')!='layout'){if((osize&&dock)||(osize&& !$nim.dE(cc.id,"origSize"))){cc.attrib?cc.attrib("origSize",osize):$nim.df(cc.id,"origSize",osize);}if(rsize){cc.attrib?cc.attrib("prvSize",rsize):$nim.df(cc.id,'prvSize',rsize);}}}else{if((osize&&dock)||(osize&& !$nim.dE(cc.id,"origSize"))){cc.attrib?cc.attrib("origSize",osize):$nim.df(cc.id,"origSize",osize);}cc.attrib?cc.attrib("prvSize",rsize):$nim.df(cc.id,'prvSize',rsize);}if(rsize&&dock){if(blRes&&['min','max'].indexOf(st)== -1){pfx=(st.indexOf('dock')> -1)?'dock':(st!='full')?'restore':st;cc.attrib?cc.attrib(pfx+"Size",rsize):$nim.df(cc.id,pfx+"Size",rsize);cc.originalLeft=Number(rsize.split(',')[0]);cc.originalTop=Number(rsize.split(',')[1]);cc.originalWidth=Number(rsize.split(',')[2]);cc.originalHeight=Number(rsize.split(',')[3]);}w=(isNaN(rsize.split(',')[2]))?0:Number(rsize.split(',')[2]);h=(isNaN(rsize.split(',')[3]))?0:Number(rsize.split(',')[3]);if(cc.attrib){cc.attrib($nim._keys(17),w);cc.attrib($nim._keys(18),h);}else if(blSize){$nim.df(cc.id,$nim._keys(17),w);$nim.df(cc.id,$nim._keys(18),h);}}if(blElem){if(!$nim.undef(cc.id)){if(cc.id.indexOf($nim.aY+'div')> -1){ctlNme=cc.id;ctlNme=$nim.aX($nim.aY+"div",'',ctlNme);ctl=$nim.G.V(ctlNme);if(ctl&&$nim.dE(cc.id,'ctype')!='layout'){$nim.ab.setOrigCoords(e,ctl,osize,false,false,blSize);}}}}}ctl=null;cc=null;},makeDragable:function(cC,bw,enble){var initPosition;var uGlb=$nim.cK.DlgStyles;if($nim.G.cu(cC,$nim._d)&& !$nim.G.isWidget(cC)){initPosition=$nim.ab.findPos(cC);if(bw&&cC){$nim.df(bw.id,'dragable',$nim.dE(cC.id,'dragable'));}}else{initPosition={x:$nim.G.cX(cC),y:$nim.G.cF(cC)};}initPosition.x=initPosition.x||dA(cC.style['left']);initPosition.y=initPosition.y||dA(cC.style['top']);if(enble&&bw){bw.cC=cC;bw.onmousedown=$nim.ab.onMouseDown;if(bw.style['cursor']===''){bw.style['cursor']="move";}}else{bw.style['cursor']="auto";}cC.dragDualHnd=(cC!=bw);cC.dragenabled=enble;cC.initPositionX=initPosition.x;cC.initPositionY=initPosition.y;cC.style['position']=$nim._keys(24);$nim.G.cS(cC,initPosition.x+"px");$nim.G.cN(cC,initPosition.y+"px");cC.originalLeft=$nim.G.cX(cC);cC.originalTop=$nim.G.cF(cC);cC.originalWidth=$nim.G.dk(cC);cC.originalHeight=$nim.G.dC(cC);cC.width=$nim.G.dk(cC);cC.height=$nim.G.dC(cC);cC.originalOpacity=cC.style['opacity'];var style=dA($nim.dE(cC.id,"dlg_style"));if(enble&& !(style&uGlb.dragable)){$nim.df(cC.id,"dlg_style",style|uGlb.dragable);}},makeSizeable:function(aG,bw){var initPosition;var uGlb=$nim.cK.DlgStyles;if($nim.G.cu(aG,$nim._d)){initPosition=$nim.ab.findPos(aG);}else{initPosition={x:aG.offsetLeft,y:aG.offsetTop};}aG.sizeDualHnd=(aG!=bw);initPosition.x=initPosition.x||dA(aG.style['left']);initPosition.y=initPosition.y||dA(aG.style['top']);if(aG.style['position']==$nim._keys(24)){$nim.G.cS(aG,initPosition.x+"px");$nim.G.cN(aG,initPosition.y+"px");}aG.initPositionX=initPosition.x;aG.initPositionY=initPosition.y;aG.width=$nim.G.dk(aG);aG.height=$nim.G.dC(aG);aG.originalOpacity=aG.style['opacity'];aG.originalLeft=$nim.G.cX(aG);aG.originalTop=$nim.G.cF(aG);aG.originalWidth=$nim.G.dk(aG);aG.originalHeight=$nim.G.dC(aG);var style=dA($nim.dE(aG.id,"dlg_style"));if(!(style&uGlb.sizable)){$nim.df(aG.id,"dlg_style",style|uGlb.sizable);}if(bw){if(bw.getAttribute('index')){aG.index=bw.getAttribute('index');}bw.aG=aG;bw.onmousedown=$nim.ab.onMouseDown;if(bw.style['cursor']===''){bw.style['cursor']="move";}}},onMouseDown:function(e,recurse){e=$nim.ab.fixEvent(e);var J=$nim.ab.findTarget(e);var dlg,audio,dp,hnd=null,search;var litem,O=document;$nim.Mouse.mousedown=true;search=$nim._keys(20);while((J&& !J.dragDualHnd)&&J.id.substring(0,search.length)!=$nim._keys(20)){if(!hnd&&J.cC){hnd=J;}J=J.parentNode?J.parentNode:J.parentElement;if(J.nodeName=='HTML')break;}J=(hnd)?hnd.cC:null;if(J){litem=$nim._.drag.ap;if(litem&&litem.id){if(!$nim.undef(litem["ctype"])){if(litem.id!=hnd.cC.id&&litem.id.resolveName('app')!==''){$nim.G.resetZIndex(litem,$nim.ab.MOVE2MID);}}}if(hnd&& !$nim.undef(hnd.cC)&&$nim.dE(hnd.cC.id,'dragable')!='false'){dp=hnd.cC;$nim.Mouse.eventMsg={message:'onmousedown',id:dp.id};dp.originalLeft=$nim.G.cX(dp);dp.originalTop=$nim.G.cF(dp);if($nim.dE(dp.id,'ctype')=='layout'){dlg=dp.id.resolveName('form');if(App&&App.Dialog&&App.Dialog[dlg]){$f.events(dlg,'AdjustLayout')(1,dp.id.resolveName());}}if(!$nim.undef(dp["ctype"])){if($nim.G.cu(dp,$nim._d)&& !$nim.G.cu(dp,$nim._s)){var cls=dp.getAttribute("class");if(cls!==null){cls=$nim.aX({"shadow-drop":"","shadow":""},null,cls);dp.setAttribute("class",cls+" shadow");}}}O.onmouseup=$nim.ab.onMouseUp;O.onmousemove=$nim.ab.onMouseMove;$nim._.drag.bL=dp;$nim._.drag.isDragging=true;$nim._.drag.mouseXinit=e.pageX;$nim._.drag.mouseYinit=e.pageY;$nim._.drag.dragid=dp.id;if($nim.cn.sounds.pickup_dialog!==''){audio=new Audio($nim.cn.sounds.pickup_dialog);audio.play();}if(!recurse&&(dp.id!=e.target.id)&&dp.onmousedown){dp.onmousedown(e,true);}if(($nim.bi!==null)&&(!$nim.undef($nim.bi))){if($nim.isfnc($nim.bi["DragStart"])){$nim.bi.DragStart(dp.id);}}}}hnd=null;J=$nim.ab.findTarget(e);search=$nim._keys(20);while((J&& !J.sizeDualHnd)&&J.id.substring(0,search.length)!=$nim._keys(20)){if(!hnd&&J.aG){hnd=J;}J=J.parentNode?J.parentNode:J.parentElement;if(J.nodeName=='HTML')break;}J=(hnd)?hnd.aG:null;if(J){litem=$nim._.drag.cI;if(litem&&litem.id){if(!$nim.undef(litem["ctype"])){if($nim.G.cu(litem,$nim._d)){$nim.G.resetZIndex(litem,$nim.ab.MOVE2MID);}}}if(hnd&& !$nim.undef(hnd.aG)){dp=hnd.aG;dp.originalLeft=$nim.G.cX(dp);dp.originalTop=$nim.G.cF(dp);$nim._.drag.reSizeItems.length=0;O.onmouseup=$nim.ab.onMouseUp;O.onmousemove=$nim.ab.onMouseMove;$nim._.drag.ao=dp;$nim._.drag.isSizing=true;$nim._.drag.sizeid=dp.id;if($nim._.drag.isDragging){$nim._.drag.bL=null;$nim._.drag.isDragging=false;$nim._.drag.dragid=null;}$nim._.drag.mouseXinit=e.pageX;$nim._.drag.mouseYinit=e.pageY;$nim.G.triggerDlgResize('Resize',$nim._.drag.sizeid,null,1,null,null);}}if($nim.isfnc(O.notifymousedown)){$nim.Key.detectKeys(e);O.notifymousedown(e);}O=null;return false;},onMouseMove:function(e){var dp,delay;var O=document,dlg,pad=$nim.cn.dialog.dlg_border;if(!$nim.Mouse.mousedown)return;e=$nim.ab.fixEvent(e);if($nim._.drag.isDragging){dp=$nim._.drag.bL;if(dp&&dp.id){if(dp.id&&dp.id.resolveName('app')!==''){$nim.G.resetZIndex(dp,$nim.ab.MOVE2DRAG);}if(KERNEL.sdkMode&&sdkMgr){$nim.ab.repositionItem(e,dp);if($nim.isfnc(O.notifymousemove)){$nim.Key.detectKeys(e);O.notifymousemove(e);}}else{$nim.ab.repositionItem(e,dp);}if($nim.cn.dialog.docking){if($nim.Mouse.x<pad){$f.dockleft(dp.id,'');$nim.ab.onMouseUp(e);}if($nim.Mouse.y<pad){$f.docktop(dp.id,'');$nim.ab.onMouseUp(e);}if($nim.Mouse.x>(DESKTOP.width-pad)){$f.dockright(dp.id,'');$nim.ab.onMouseUp(e);}if($nim.Mouse.y>(DESKTOP.height-pad)){$f.dockbottom(dp.id,'');$nim.ab.onMouseUp(e);}}$nim.ab.updateChildren(e,dp,false,false,false);}}if($nim._.drag.isSizing){dp=$nim._.drag.ao;if(dp&&dp.id){if($nim.G.cu(dp,$nim._d)){$nim.G.resetZIndex(dp,$nim.ab.MOVE2DRAG);}$nim.ab.resizeItem(e,dp);if($nim._tmr)clearTimeout($nim._tmr);delay=dp;$nim._tmr=setTimeout(function(){$nim._tmr=0;$nim.ab.resizeChildren(e,delay,false);$nim.G.triggerDlgResize('Resize',$nim._.drag.sizeid,null,null,null,null,null);$nim.ab.updateChildren(e,delay,false,false,false);delay=null;},20);}}O=null;return false;},onMouseUp:function(e){var audio,dlg,curitem,litem,dp,cls,blLayout=false,resSize=false,O=document;curitem=$nim._.drag.bL;$nim.Mouse.mousedown=false;if(curitem!==null&& !$nim.undef(curitem)){$nim.Mouse.dragdone=true;if($nim._.drag.dragid)$nim.SetId($nim._.drag.dragid);dp=curitem;if(!$nim.undef(dp["ctype"])){if($nim.G.cu(dp,$nim._d)&& !$nim.G.cu(dp,$nim._s)){$nim.G.resetZIndex(dp,$nim.ab.MOVE2TOP);cls=dp.getAttribute("class");cls=$nim.aX({"shadow-drop":"","shadow":""},null,cls);dp.setAttribute("class",cls+" shadow-drop");if($nim.cn.sounds.putdown_dialog!==''){audio=new Audio($nim.cn.sounds.putdown_dialog);audio.play();}}}if($nim.dE(dp.id,'ctype')=='layout'){dlg=dp.id.resolveName('form');blLayout=true;$nim.ab.setOrigCoords(e,dp,null,blLayout,true);if(App&&App.Dialog&&App.Dialog[dlg]){$f.events(dlg,'AdjustLayout')(2,dp.id.resolveName());}}if($nim.G.cu(dp,$nim._d)){$nim.df(dp.id,'state','restore');$nim.df(dp.id,'dockSize','');$nim.ab.setOrigCoords(e,dp,null,blLayout,true);}litem=$nim._.drag.ap;if(litem&&litem.id){if((litem.id!=dp.id)&&(!$nim.undef(litem["ctype"]))){if($nim.G.cu(litem,$nim._d)){if(litem.id.resolveName('app')!==''){$nim.G.resetZIndex(litem,$nim.ab.MOVE2MID);}}}}if(dp.onmouseup){dp.onmouseup(e);}$nim._.drag.ap=dp;$nim._.drag.lastdragged_id=dp.id;if(($nim.bi!==null)&&(!$nim.undef($nim.bi))){if($nim.isfnc($nim.bi["Drag"])){$nim.bi.Drag(dp.id);}}}$nim._.drag.bL=null;$nim._.drag.isDragging=false;$nim._.drag.dragid=null;curitem=$nim._.drag.ao;if(curitem!==null&& !$nim.undef(curitem)){$nim.Mouse.dragdone=true;if($nim._.drag.sizeid)$nim.SetId($nim._.drag.sizeid);dp=curitem;if($nim._tmr){clearTimeout($nim._tmr);$nim._tmr=0;$nim.ab.resizeChildren(e,dp,false);$nim.G.triggerDlgResize('Resize',$nim._.drag.sizeid,null,null,null,null,null);$nim.ab.updateChildren(e,dp,false,false,false);}if(!$nim.undef(dp["ctype"])){if($nim.G.cu(dp,$nim._d)){$nim.G.resetZIndex(dp,$nim.ab.MOVE2TOP);}}if(!$nim.G.isWidget(dp)){$nim.ab.resizeChildren(e,dp,false);if($nim.G.cu(dp,$nim._d)){$nim.ab.updateChildren(e,dp,true,true,false);}$nim.ab.setOrigCoords(e,dp,null,false,false,true);}litem=$nim._.drag.cI;if(litem&&litem.id){if((litem.id!=dp.id)&&(!$nim.undef(litem["ctype"]))){$nim.G.resetZIndex(litem,$nim.ab.MOVE2MID);}}$nim._.drag.cI=dp;$nim._.drag.lastsized_id=dp.id;if(dp.dragenabled===true){resSize=true;}if(($nim.bi!==null)&&(!$nim.undef($nim.bi))){if($nim.bi.Resize){$nim.bi.Resize(dp.id.resolveName('form'));}}if(!$nim.G.isWidget(dp)){$nim.ab.updateChildren(e,dp,true,true,true);$nim.ab.setOrigCoords(e,dp,null,true,true,true);$nim.df(dp.id,'state','restore');$nim.df(dp.id,'dockSize','');}$nim.G.triggerDlgResize('Resize',$nim._.drag.sizeid,null,null,null,null,null);}$nim._.drag.ao=null;$nim._.drag.isSizing=false;$nim._.drag.sizeid=null;$nim._.drag.mouseXinit=null;$nim._.drag.mouseYinit=null;O.onmousemove=null;O.onmouseup=null;if($nim.isfnc(O.notifymouseup)){$nim.Key.detectKeys(e);O.notifymouseup(e);}O=null;return false;},fixEvent:function(e){var ret=(!e)?window.event:e;if($nim.Agent.usingIE){$nim.Mouse.x=e.offsetX;$nim.Mouse.y=e.offsetY;}else{$nim.Mouse.x=e.layerX;$nim.Mouse.y=e.layerY;}return ret;},findPos:function(bq){var curleft=0;var curtop=0;if(bq.offsetParent){curleft=bq.offsetLeft;curtop=bq.offsetTop;if(DESKTOP.visibleDesktop==DESKTOP.currentDesktop){while(bq==bq.offsetParent){curleft+=bq.offsetLeft;curtop+=bq.offsetTop;}}}return{"x":curleft,"y":curtop};},findTarget:function(e){var J;if(e.target){J=e.target;}else if(e.srcElement){J=e.srcElement;}if(J.nodeType==3){J=J.parentNode;}return J;},repositionItem:function(e,dp){var uGlb=$nim.cK.DlgStyles;var eventx=e.pageX,eventy=e.pageY,dlgStyle,abrtMoveX=false,abrtMoveY=false,csize,size;if(dp.dragenabled){var bq=dp.id.resolveName(),osize={width:$nim.G.dk(dp),height:$nim.G.dC(dp)};if(!bq.Form){size=$f.getsize(dp.id,'');}else{size=$f.getsize(dp.id.resolveName('forminst'),'body');}size.width=dp.parentElement.offsetWidth||size.width;size.height=dp.parentElement.offsetHeight||size.height;var O=$nim.ax.getWindowDimensions(),newleft=dp.originalLeft+eventx-($nim._.drag.mouseXinit||eventx),pctleft=Number((newleft/size.width*100).toFixed(2)),newtop=dp.originalTop+eventy-($nim._.drag.mouseYinit||eventy),pcttop=Number((newtop/size.height*100).toFixed(2)),newright=newleft+osize.width,pctright=Number((newright/size.width*100).toFixed(2)),newbottom=newtop+osize.height,pctbottom=Number((newbottom/size.height*100).toFixed(2)),pctlval=Number((newleft/(size.width-osize.width)*100).toFixed(2)),pcttval=Number((newtop/(size.height-osize.height)*100).toFixed(2));var xDragRnge=$nim.dE(dp.id,"xdragrange");if(xDragRnge){if(dA(xDragRnge)> -1){if((parseFloat(xDragRnge.split(";")[0])>pctleft)||(parseFloat(xDragRnge.split(";")[1])<pctright)){abrtMoveX=true;}}}var yDragRnge=$nim.dE(dp.id,"ydragrange");if(yDragRnge){if(dA(yDragRnge)> -1){if((parseFloat(yDragRnge.split(";")[0])>pcttop)||(parseFloat(yDragRnge.split(";")[1])<pctbottom)){abrtMoveY=true;}}}if(DESKTOP.fluidDesktop===false){dlgStyle=dA($nim.dE(dp.id,"dlg_style"));if((newleft>2)&&(newright<(O.width-$nim.cn.dialog.min_padright))){if(dlgStyle&uGlb.dragablex){if(!abrtMoveX&& !isNaN(newleft))$nim.G.cS(dp,newleft+"px");}}if((newtop>2)&&(newbottom<(O.height-$nim.cn.dialog.min_padbottom))){if(dlgStyle&uGlb.dragabley){if(!abrtMoveY&& !isNaN(newtop))$nim.G.cN(dp,newtop+"px");}}}else{dlgStyle=dA($nim.dE(dp.id,"dlg_style"));if(dlgStyle&uGlb.dragablex){if(!abrtMoveX&& !isNaN(newleft))$nim.G.cS(dp,newleft+"px");}if(dlgStyle&uGlb.dragabley){if(!abrtMoveY&& !isNaN(newtop))$nim.G.cN(dp,newtop+"px");}}if(!abrtMoveX)$nim.df(dp.id,"xdrag%",(pctlval).toFixed(2));if(!abrtMoveY)$nim.df(dp.id,"ydrag%",(pcttval).toFixed(2));}O=null;},showChildren:function(e,dp){var i,F,child;if(!$nim.undef(dp["ctype"])){if($nim.G.cu(dp,$nim._d)){var st=$nim.dE(dp.id,'state'),szable=$nim.dE(dp.id,'sizeable');var aj=$nim.G.V(dp.id+$nim.aY+'body');if(!aj){aj=$nim.G.V(dp.id);}var dw=$nim.G.V(dp.id+$nim.aY+'page.back');var bf=$nim.G.V(dp.id+$nim.aY+"resize");if(aj){if(szable=='true'&&st=='restore'){if(bf&&bf.getAttribute('display')!='inline'){bf.style['display']='inline';}bf.style['visibility']='visible';}if($nim.file[globals.cgiVer].stable){if([''].indexOf(aj.style['display'])== -1){$nim.G.setDisplay(aj,aj.getAttribute('prv-display')||'block',false);}if(!$nim.Agent.usingFF&& !$nim.Agent.usingIE){if(dw){if($nim.dE(dp.id,'facing')=='face'){$nim.G.setDisplay(dw,'none',false);$nim.G.setVisibility(dw,'hidden',false);}else{$nim.G.setDisplay(dw,dw.getAttribute('prv-display')||'block',false);$nim.G.setVisibility(dw,'visible',false);}}}}}$nim.G.viewState(dp.id,true,true);}}aj=null;dw=null;bf=null;},updateChildren:function(e,dp,blZones,blSize,blRes){var x,child,blLayout,frm=dp.id.resolveName('instform');if($nim.dE(dp.id,'stateTo')=='min'){return;}if(blZones&&$nim._.drag.zones.length>0){blLayout=true;for(x=0;x<$nim._.drag.zones.length;x++){if($nim._.drag.zones[x].indexOf(frm)> -1){child=$nim.G.V($nim._.drag.zones[x]);if(child){$nim.ab.setOrigCoords(e,child,null,blLayout,blRes,blSize);}}}}$nim._.drag.zones.length=0;if(blSize){for(x=0;x<$nim._.drag.reSizeItems.length;x++){if($nim._.drag.reSizeItems[x].indexOf(frm)> -1){child=$nim.G.V($nim._.drag.reSizeItems[x]);if(child){$nim.ab.setOrigCoords(e,child,null,false,blRes,blSize);}}}$nim._.drag.reSizeItems.length=0;}},hideChildren:function(e,dp,blForce){var i,F,child;if(!$nim.undef(dp["ctype"])){if($nim.G.cu(dp,$nim._d)){$nim.G.viewState(dp.id);var aj=$nim.G.V(dp.id+$nim.aY+'body');if(!aj){aj=$nim.G.V(dp.id);}var dw=$nim.G.V(dp.id+$nim.aY+'page.back');var bf=$nim.G.V(dp.id+$nim.aY+"resize");if(aj){if(bf){bf.style['display']='none';}if($nim.cn.dialog.hideChildrenWhenSliding||blForce){if(App&&$nim.themes[App.theme]=="v3.2"){$nim.G.setDisplay(aj,'none',false);}if(!$nim.Agent.usingFF&& !$nim.Agent.usingIE){if(dw){if(App&&$nim.themes[App.theme]=="v3.2"){$nim.G.setDisplay(dw,'none',false);}}}}}}}aj=null;dw=null;bf=null;},resizeElem:function(dkeys,dp,child,recurse,blLayout){var bB,bp,ak,aQ,aw,da,curW,curH,av,bg,bu,bn,ay,chldiv,ctype,cdim;if(dkeys){var aj=$nim.G.V(dp.id+$nim.aY+'body');if(!aj){aj=$nim.G.V(dp.id);}if(recurse===true){var cD=aj.getAttribute('parent');var cc=$nim.G.V(cD);if(cc){bu=dA($nim.dE(cc.id,'curW'))*0.9998;bn=dA($nim.dE(cc.id,'curH'))*0.9998;av=$nim.G.dk(cc)*0.9998;bg=$nim.G.dC(cc)*0.9998;}}else{bu=dA($nim.dE(dp.id,'curW'))*0.9998;bn=dA($nim.dE(dp.id,'curH'))*0.9998;av=$nim.G.dk(dp)*0.9998;bg=$nim.G.dC(dp)*0.9998;}ctype=child["ctype"];cdim=$nim.dE(child.id,"origSize").split(",");bB=dA(cdim[0]);bp=dA(cdim[1]);ak=dA(cdim[2]);aQ=dA(cdim[3]);if(dkeys=='RRRR'){aw=bB*av/bu;da=bp*bg/bn;curW=(bB+ak)*(av/bu)-aw;curH=(bp+aQ)*(bg/bn)-da;}else{aw=$nim.G.cX(child);da=$nim.G.cF(child);curW=$nim.G.dk(child);curH=$nim.G.dC(child);if(dkeys.substring(0,2)=='TT'){aQ=aQ+(bg-bn);curH=aQ;}if(dkeys.substring(0,2)=='FT'){bp=bp+(bg-bn);da=bp;}if(dkeys.substring(2,4)=='TT'){ak=ak+(av-bu);curW=ak;}if(dkeys.substring(2,4)=='FT'){bB=bB+(av-bu);aw=bB;}}$nim.G.cS(child,Math.round(aw)+"px");$nim.G.cN(child,Math.round(da)+"px");$nim.G.cT(child,Math.round(curW));$nim.G.cz(child,Math.round(curH));if((ctype=='video')||(ctype=='embed')||(ctype=='iframe')){ay=child.id;ay=$nim.aX($nim.aY+"div",'',ay);chldiv=$nim.G.V(ay);if(chldiv){chldiv.setAttribute('width',Math.round(curW).toString());chldiv.setAttribute('height',Math.round(curH).toString());}}if(ctype.indexOf('label')!= -1){var lchild=child.children[0];if($nim.dE(lchild.id,"scaletype")=='true'){$nim.ab.resizeFont(lchild);}}aj=null;chldiv=null;}},flipFormProps:function(orientation,item,fsize,unit){var size,flip,coords,aD,itemW;try{if(!$nim.G.isMenu(item)&&item.id.resolveName('isValid')){if(unit=='px'){coords=$nim.dE(item.id,"origSize");flip=$nim.dE(item.id,'flip');itemW=$nim.G.dk(item);if(flip){$nim.df(item.id,'dock',flip.split(',')[1]);item.style['position']=flip.split(',')[2];item.style['display']=flip.split(',')[3];item.style['vertical-align']=flip.split(',')[4];$nim.G.cS(item,coords.split(',')[0]+'px',true);$nim.G.cN(item,coords.split(',')[1]+'px',true);$nim.G.cT(item,coords.split(',')[2],true);$nim.G.cz(item,coords.split(',')[3],true);size=$f.getsize(item.id.resolveName('form'));$nim.ab.pixelChildren(item,size,false);}}else{aD=item.dock;$nim.df(item.id,'flip',orientation+','+item.dock+','+item.style['position']+','+item.style['display']+','+item.style['vertical-align']);size=$f.getsize(item.id.resolveName('form'));$nim.ab.percentChildren(item,size,false);if(aD!='FFFF'&&aD!='----'){$nim.df(item.id,'dock','!!!!');}item.style['position']="relative";item.style['display']=(orientation=='vertical')?"block":"inline-block";item.style['vertical-align']="top";if(orientation=='vertical'){$nim.G.cT(item,'99.555%',true);}else{$nim.G.cT(item,(100*size.width/fsize.width).toFixed(2)+"%",true);}}$nim.G.lockFlags(item);}}catch(err){console.log(err);}},flipChildProps:function(recurse,child,size,unit){var aD,coords,csize,flip;try{if(!$nim.G.isMenu(child)&&child.id.resolveName('isValid')){if(unit=='px'){coords=$nim.dE(child.id,'origSize');flip=$nim.dE(child.id,'flip');if(flip){if(!recurse&&child.childNodes.length>0){csize={width:$nim.G.dk(child),height:$nim.G.dC(child)};$nim.ab.pixelChildren(child,csize,true);}$nim.G.cS(child,coords.split(',')[0]+'px',true);$nim.G.cN(child,coords.split(',')[1]+'px',true);$nim.G.cT(child,coords.split(',')[2],true);$nim.G.cz(child,coords.split(',')[3],true);$nim.df(child.id,'dock',flip.split(',')[0]);child.style['display']=flip.split(',')[1];child.style['position']=flip.split(',')[2];child.style['vertical-align']=flip.split(',')[3];}}else{if(child.dock){aD=child.dock;$nim.df(child.id,'flip',aD+','+child.style['display']+','+child.style['position']+','+child.style['vertical-align']);csize={width:$nim.G.dk(child),height:$nim.G.dC(child)};if(!recurse&&child.childNodes.length>0){$nim.ab.percentChildren(child,csize,true);}csize.top=$nim.G.cF(child);csize.left=$nim.G.cX(child);$nim.G.cS(child,(100*csize.left/size.width).toFixed(2)+"%",true);$nim.G.cN(child,(100*csize.top/size.height).toFixed(2)+"%",true);switch(aD.substring(0,2)){case 'RR':case 'TT':$nim.G.cz(child,(100*csize.height/size.height).toFixed(2)+"%",true);break;case 'FT':$nim.G.setB(child,(100*(size.height-(csize.top+csize.height))/size.height).toFixed(2)+"%",true);break;default:break;}switch(aD.substring(2,4)){case 'RR':case 'TT':$nim.G.cT(child,(100*csize.width/size.width).toFixed(2)+"%",true);break;case 'FT':$nim.G.setR(child,(100*(size.width-(csize.left+csize.width))/size.width).toFixed(2)+"%",true);break;default:break;}if(aD!='FFFF'&&aD!='----'){$nim.df(child.id,'dock','!!!!');}child.style['position']='absolute';}}$nim.G.lockFlags(child);}}catch(err){console.log(err);}},pixelChildren:function(dp,size,recurse){var child,cD,i,x,F,ctype=null,tmp,aj,panes=[];try{cD=$nim.G.V(dp.id+$nim.aY+'body');if(cD===null){cD=$nim.G.V(dp.id);}panes.push(cD);tmp=$nim.G.V(dp.id+$nim.aY+'page.back');panes.push(tmp);for(x=0;x<panes.length;x++){aj=panes[x]||null;if(!$nim.undef(dp["ctype"])){if(aj){if(aj.childNodes.length>0){F=aj.childNodes.length;for(i=0;i<F;i++){child=aj.childNodes[i];if(child.getAttribute&& !$nim.undef(child)){if(!$nim.undef(child.id)){ctype=child["ctype"];if(!$nim.undef(child.attributes)){if(child.dock&&child.dock=='!!!!'){$nim.ab.flipChildProps(recurse,child,size,'px');}}}}}}}}}}catch(err){console.log(err);}},percentChildren:function(dp,size,recurse){var child,cD,i,x,F,ctype=null,tmp,aj,panes=[];try{cD=$nim.G.V(dp.id+$nim.aY+'body');if(cD===null){cD=$nim.G.V(dp.id);}panes.push(cD);tmp=$nim.G.V(dp.id+$nim.aY+'page.back');panes.push(tmp);for(x=0;x<panes.length;x++){aj=panes[x]||null;if(!$nim.undef(dp["ctype"])){if(aj){if(aj.childNodes.length>0){F=aj.childNodes.length;for(i=0;i<F;i++){child=aj.childNodes[i];if(child.getAttribute&& !$nim.undef(child)){if(!$nim.undef(child.id)){ctype=child["ctype"];if(!$nim.undef(child.attributes)){if(child.dock&&child.dock!='!!!!'){$nim.ab.flipChildProps(recurse,child,size,'%');}}}}}}}}}}catch(err){console.log(err);}},resizeChildren:function(e,dp,recurse,blLayout){'use strict';if($nim.undef(blLayout)){blLayout=false;}if($nim.dE(dp.id,'stateTo')=='min'){return;}var child,cD,p=0,bq,chkDock=null,i,x,F,dkeys=null,aCtype=null,cResize,ctype=null,ai,tmp,aj,bP,bdyNme,ay,divtype,clpNme,tabNme,panes=[];try{dkeys=dp.dock;cD=$nim.G.V(dp.id+$nim.aY+'body');if(cD===null){cD=$nim.G.V(dp.id);}panes.push(cD);tmp=$nim.G.V(dp.id+$nim.aY+'page.back');panes.push(tmp);for(x=0;x<panes.length;x++){aj=panes[x]||null;if(!$nim.undef(dp["ctype"])){if(aj){if(aj.childNodes.length>0){for(i=0,F=aj.childNodes.length;i<F;i++){child=aj.childNodes[i];bq=child.id.resolveName();if(child.getAttribute&& !$nim.undef(child)){dkeys=child.dock;if(!$nim.undef(child.id)){ctype=child["ctype"];aCtype=$nim.dE(child.id,'ctype');cResize=$nim.G.isCustom(bq.Form,bq.Control)||(['true','w','h','height','width'].indexOf($nim.dE(child.id,'autosize'))> -1);if(!cResize&& !$nim.undef(child.attributes)){chkDock=$nim.G.isInGroup('dockGroup',dkeys);if(chkDock!=dkeys){$nim.ab.resizeElem(dkeys,dp,child,recurse,blLayout);if(aCtype=='layout'){if($nim._.drag.zones.indexOf(child.id)== -1){$nim._.drag.zones.push(child.id);}}else{if($nim._.drag.reSizeItems.indexOf(child.id)== -1){$nim._.drag.reSizeItems.push(child.id);}}}}}if(!cResize&&recurse===false){if($nim.G.isInGroup('dockGroup',dkeys)!=dkeys){ctype=child["ctype"];switch(ctype){case "tab":tabNme=$nim.aX($nim.aY+"div",$nim.aY+"container",child.id);bP=$nim.G.V(tabNme);if(bP){$nim.G.cz(bP,dA(child.style['height']));$nim.G.cT(bP,dA(child.style['width']));}clpNme=$nim.aX($nim.aY+"div",$nim.aY+"pages",child.id);bP=$nim.G.V(clpNme);if(bP){$nim.G.cz(bP,$nim.cn.dialog.tab_height);clpNme=$nim.aX($nim.aY+"div",$nim.aY+"clip",child.id);bP=$nim.G.V(clpNme);if(bP){$nim.G.cz(bP,$nim.cn.dialog.tab_height);}var bq=child.id.resolveName(),cpos=child.cposition;$f.tab.position(bq.Form,bq.Control,cpos);bq=null;cpos=null;}ai=$nim.dE(child.id,'pages');for(p=1;p<=ai;p++){bdyNme=$nim.aX($nim.aY+"div",$nim.aY+"page"+p+$nim.aY+'body',child.id);bP=$nim.G.V(bdyNme);if(bP){$nim.ab.resizeChildren(e,bP,true);$nim.G.cz(bP,'99.5%');}}break;case "div":bP=$nim.G.V(child.id);divtype=$nim.dE(child.id,'ctype');if(bP){if(divtype=='div'){$nim.ab.resizeChildren(e,bP,true,false);}}break;case "panellist":case "panel-list":ai=$nim.dE(child.id,'pages');for(p=1;p<=ai;p++){ay=$nim.aX($nim.aY+"div",$nim.aY+p+$nim.aY+'body',child.id);bP=$nim.G.V(ay);if(bP){$nim.ab.resizeChildren(e,bP,true);}}break;case "panel":ay=$nim.aX($nim.aY+"div",$nim.aY+'body',child.id);bP=$nim.G.V(ay);if(bP){$nim.ab.resizeChildren(e,bP,true);}break;default:if(!cResize&&$nim.dE(child.id,"widget")=="true"){ay=child.id+$nim.aY+'body';bP=$nim.G.V(ay);if(bP){$nim.G.cT(bP,$nim.G.dk(child));$nim.G.cz(bP,$nim.G.dC(child));$nim.ab.resizeChildren(e,bP,true,false);}}break;}}}}}}}}}panes.length=0;aj=null;}catch(err){console.log(err);}},resizeFont:function(J){var cap=$nim.G.V(J.id+$nim.aY+"caption");var cr=$nim.G.V(J.id+$nim.aY+"div");if(J){if($nim.dE(J.id,'scaletype')=='true'){if(J["ctype"].indexOf('label')!= -1){if(cap&&cap!==''){var cpl=dA($nim.dE(J.id,'scale-cpl')),elW=$nim.G.dk(cr),width=elW>$nim.cn.scaletype.maxWidth?$nim.cn.scaletype.maxWidth:elW<$nim.cn.scaletype.minWidth?$nim.cn.scaletype.minWidth:elW,fontBase=width/cpl,fontSize=fontBase>$nim.cn.scaletype.maxFont?$nim.cn.scaletype.maxFont:fontBase<$nim.cn.scaletype.minFont?$nim.cn.scaletype.minFont:fontBase;J.style['font-size']=fontSize+'px';}}}}},resizeItem:function(e,dp){var newwidth,newheight,wadj=0,hadj=0,uDlg=$nim.cn.dialog,uGlb=$nim.cK.DlgStyles,scrnPos=$f.getscreenpos(dp.id.resolveName('instform'),dp.id.resolveName('control')),eventx=e.pageX,eventy=e.pageY;if(!$nim.undef(dp["ctype"])&&scrnPos){if($nim.G.cu(dp,$nim._d)){var isSurf=true;var bf=$nim.G.V(dp.index+$nim.aY+"resize"),reszeH=uDlg.resize_height,reszeW=uDlg.resize_width,dhnd=$nim.G.V(dp.index+$nim.aY+'hnd'),pad=uDlg.dlg_border,title_hgt=uDlg.title_height,aj=$nim.G.V(dp.index+$nim.aY+'body'),dw=$nim.G.V(dp.index+$nim.aY+'page.back'),dfoot=$nim.G.V(dp.index+$nim.aY+'footer');var percwidth,style=dA($nim.dE(dp.id,'dlg_style'));if((App&&$nim.themes[App.theme]=='v3.2')&&($nim.G.cu(dp,$nim._d)&& !$nim.G.cu(dp,$nim._p))){newwidth=$nim.G.minMaxW(dp,(eventx-scrnPos.left)+(reszeH/2-pad));newheight=$nim.G.minMaxH(dp,(eventy-scrnPos.top)+(reszeH/2-pad));if(aj)isSurf=(aj["ctype"].indexOf("surface")> -1);if((newwidth>uDlg.dlg_minwidth)&&(newheight>title_hgt)){percwidth=isSurf?100:100*(newwidth-(2*pad))/newwidth;if(style&uGlb.sizablex){$nim.G.cT(dp,newwidth);if(aj){$nim.G.cT(aj,percwidth.toFixed(6)+"%");}if(dw){$nim.G.cT(dw,percwidth.toFixed(6)+"%");}if(dhnd){$nim.G.cT(dhnd,newwidth);}if(bf){$nim.G.cS(bf,((newwidth-reszeW)+(isSurf?(2*pad):1))+"px");}}if(style&uGlb.sizabley){$nim.G.cz(dp,newheight);if((style&uGlb.caption)==uGlb.caption){if(aj){$nim.G.cz(aj,newheight-(title_hgt+pad*2)-2);}if(dw){$nim.G.cz(dw,newheight-(pad*2)-2);}newheight=$nim.G.minMaxH(dp,(newheight+pad))-6;}else{newheight=isSurf?(newheight+pad):(newheight-(pad*3));if(aj){$nim.G.cz(aj,newheight);}if(dw){$nim.G.cz(dw,newheight);}newheight=newheight+(isSurf?(2*pad):(2*pad));newheight=$nim.G.minMaxH(dp,newheight);}if(bf){$nim.G.cN(bf,((newheight-reszeH)+(isSurf? -1:5))+"px");}}}}else{newwidth=$nim.G.minMaxW(dp,((eventx+6)-scrnPos.left));newheight=$nim.G.minMaxH(dp,((eventy+10)-scrnPos.top));wadj=5;hadj=uDlg.title_height+1;if((newwidth>uDlg.dlg_minwidth)&&(newheight>uDlg.dlg_minheight)){if(style&uGlb.sizablex){$nim.G.cT(dp,newwidth);if(aj){$nim.G.cT(aj,"100%");}if(dhnd){$nim.G.cT(dhnd,newwidth);}if(bf){$nim.G.cS(bf,(newwidth-reszeW+5)+"px");}}if(style&uGlb.sizabley){$nim.G.cz(dp,newheight);if((style&uGlb.caption)==uGlb.caption){if(aj){$nim.G.cz(aj,newheight-hadj);}}else{if(aj){$nim.G.cz(aj,newheight);}}if(bf){$nim.G.cN(bf,(newheight-reszeH+6)+"px");}}}}}}aj=null;dw=null;bf=null;dfoot=null;}});$nim.aq=cU({Find:function(id){var bS;var x,F=ad.length;for(x=0;x<F;x++){if(ad[x].App.id==id){bS=x;}}return bS;},sFind:function(id,inst){var bS;var x,F=ad.length||0;for(x=0;x<F;x++){if((ad[x].App.id==id)&&(ad[x].instId==inst)){bS=x;}}return bS;},bF:function(bS){if($nim._._$.length===0){CGI.cA(function(kdata){kdata=$nim.aX("\r","",kdata);$nim._._$=kdata.split("|");});return $nim._._$[bS]||'';}else{return $nim._._$[bS];}},keyLoad:function(id,filetype,blStart){var O=document;var cc=$nim.G.V(id);if(cc===null){CGI.Get($nim.home_server+'cgi/'+$nim.file[globals.cgiVer].menu+'?cmd='+id+'&uid='+$nim.security.login+'&eml='+$nim.security.email,false,function(){var bD;if(filetype=="js"){bD=O.createElement("script");$nim.G.setAttrs(bD,{"language":"JavaScript","type":"text/javascript"});bD.text=CGI.data.responseText;}else if(filetype=="css"){bD=O.createElement("link");$nim.G.setAttrs(bD,{"rel":"stylesheet","type":"text/css"});bD.text=CGI.data.responseText;}bD.setAttribute("id",id);O.getElementsByTagName('head')[0].appendChild(bD);cc=null;O=null;});}},syncLoad:function(id,filename,filetype,callbk){var O=document;var head=O.getElementsByTagName("head")[0];var bD;if((O.URL.indexOf('file:///')> -1)||($nim.Agent.usingIE)){filename=$nim.aX(".gz.js",".js",filename);}if($nim.G.V(id)===null){if(filetype=="js"){bD=O.createElement("script");$nim.G.setAttrs(bD,{"id":id,"language":"JavaScript","type":"text/javascript"});bD.async=false;KERNEL.curName=id;bD.onload=function(){bD.onload=null;if($nim.isfnc(callbk)){callbk();}};bD.setAttribute("src",filename);}else if(filetype=="css"){bD=O.createElement("link");$nim.G.setAttrs(bD,{"id":id,"rel":"stylesheet","type":"text/css"});bD.onload=function(){bD.onload=null;if($nim.isfnc(callbk)){callbk();}};bD.setAttribute("href",filename);}if(!$nim.undef(bD)){head.appendChild(bD);}}else{KERNEL.curName=id;}O=null;},Load:function(id,filename,filetype,blStart,callbk){var O=document;var head=O.getElementsByTagName("head")[0];var x,F,apCnt,bD;if((O.URL.indexOf('file:///')> -1)||($nim.Agent.usingIE)){filename=$nim.aX(".gz.js",".js",filename);}if($nim.G.V(id)===null){if(filetype=="js"){bD=O.createElement("script");if($nim.cK.glb_startjs!==''){$nim.G.setAttrs(bD,{"language":"JavaScript","type":"text/javascript"});}KERNEL.curName=id;apCnt=KERNEL.appid;bD.onload=function(){bD.setAttribute("id",id);if(apCnt<KERNEL.appid){bD.onload=null;var appid=$nim.aq.Find(KERNEL.appid);if(id!='desktop'){$nim.AppHooks.Load(appid+1);if(blStart){$nim.AppHooks.Start(appid+1,true);}}else{if($nim.cn.preload.disabledesktop==false){KERNEL.EnableDesktop();}else{KERNEL.DisableDesktop();}}if($nim.isfnc(callbk)){callbk();}}else{if(id.indexOf('elements')== -1){bD.onload=null;head.removeChild(bD);}}};bD.setAttribute("src",filename);}else if(filetype=="css"){bD=O.createElement("link");$nim.G.setAttrs(bD,{"id":id,"rel":"stylesheet","type":"text/css","href":filename});}if(!$nim.undef(bD)){head.appendChild(bD);}}else{KERNEL.curName=id;F=ad.length;for(x=0;x<F;x++){if(ad[x].App.name==id){App=ad[x];if(App.App&&App.App.multiple){var ok=App.New();if(ok){App=ad[ad.length-1];}}if(App.InstName)$k.instance.setapp(App);$nim.bi=App;if(App.App.isLoaded&&App.Dialog&&App.Dialog[App.App.startfrm]&&App.Dialog[App.App.startfrm].isActivated){$nim.SetId(App.InstName);$f.restore(App.App.startfrm);$f.show(App.App.startfrm);}else{$nim.bi.Load();$nim.bi.Start(null,true);}if($nim.undef($nim.bi.target)){$nim.bi.target=FORMS.Target;}if($nim.isfnc(callbk)){callbk();}break;}}return $nim.bi.instId;}O=null;return null;},Remove:function(id){var cc=$nim.G.V(id);if(cc){var ftype=cc.getAttribute("type");if((ftype=='text/css')||(ftype=='text/javascript')){$nim.ax.removeElementById(id);}}cc=null;}});$nim.by=cU({ignore:function(e){if(e&&e.preventDefault)e.preventDefault();if(e&&e.stopPropagation)e.stopPropagation();},noEvent:function(e,aM){(e&&e.stopPropagation)?e.stopPropagation():null;},defaultEvent:function(e,aM){console.warn("NIMJS:Default Event Triggered: "+JSON.stringify(aM));(e&&e.stopPropagation)?e.stopPropagation():null;},defaultClick:function(e){if(!e.button&& !$nim.Key.Ctrl){console.warn("NIMJS:You clicked :"+e.target.id);}e.stopPropagation();},tipMouseLeave:function(e){var au=KERNEL.Events.initialize(e);var cap,overid,cls,tip,tipMsg,celem,id=(e&&e.target)?e.target.id:null,dlg=id?id.resolveName('form'):'',af=id?id.resolveName('control'):'',inst=$f.buildname(dlg);overid=dlg+'-tooltip';celem=$f.af(dlg,af);if(celem){tip=document.getElementById(inst+'.tooltip');if(tip&&tip.overid==overid){tip.overid='';cap=document.getElementById(inst+'.tooltip.caption');cls=cap.getAttribute('class');cls=$nim.aX('fadein','fadeout',cls);cap.setAttribute('class',cls);setTimeout(function(){if(tip&& !tip.overid){tip.setAttribute('class','tiphide');}},1000);e.stopPropagation();}}},tipMouseEnter:function(e){var coords,au=KERNEL.Events.initialize(e);var cap,tip,tipMsg,celem,cc,id=(e&&e.target)?e.target.id:null,side,dlg=id?id.resolveName('form'):'',af=id?id.resolveName('control'):'',inst=$f.buildname(dlg);celem=$f.af(dlg,af);cc=celem.parentNode;if(cc){tipMsg=celem.getAttribute('tooltip');if(tipMsg){celem.setAttribute('title','');cc.setAttribute('title','');coords=$f.getcoords(dlg,'body');side=$nim.Tooltip.closestside(cc.offsetLeft+cc.offsetWidth/2,cc.offsetTop+cc.offsetHeight/2,coords);cc.id.indexOf('.div')> -1?$nim.Tooltip.setpos(cc,side):$nim.Tooltip.setpos(celem,side);tip=document.getElementById(inst+'.tooltip');if(tip&& !tip.overid){cap=document.getElementById(inst+'.tooltip.caption');if(cap){cap.setAttribute('class','text-type fadein tooltiptext-'+side);cap.innerHTML=tipMsg;}tip.overid=dlg+'-tooltip';tip.setAttribute('class','tooltip');}}}},defaultAllowDrop:function(e){if(e&&e.preventDefault)e.preventDefault();if(e&&e.stopPropagation)e.stopPropagation();},defaultDrag:function(e){if(e["dataTransfer"]){e["dataTransfer"].setData("Text",e.target.id);}if(e&&e.stopPropagation)e.stopPropagation();},defaultDrop:function(e){var data;if(e["dataTransfer"]){data=e["dataTransfer"].getData("Text");}e.target.appendChild($nim.G.V(data));if(e&&e.stopPropagation)e.stopPropagation();if(e&&e.preventDefault)e.preventDefault();},defaultTick:function(e){var cc=e?e.target:null;var aM,ctype,type={option:'tick',checkbox:'check'};if(cc){aM=cc.id.resolveName();ctype=cc.getAttribute('type')||cc.ctype;if(type[ctype]&&aM.Component!=type[ctype]){$f.cc(aM.InstForm,aM.Control+'.'+type[ctype]).click();e.stopPropagation();}}},tabClicked:function(e){var i,tab=e.target.id.split($nim.aY),cc=$nim.G.V(e.target.id),hgt=$nim.cn.dialog.tab_height,au=tab[0]+$nim.aY+tab[1],pages=dA($nim.dE(cc.id,'pages')),index=dA(cc.getAttribute('index')),tabelem,bP,ag;if(!e.button&& !$nim.Key.Ctrl){for(i=1;i<=pages;i++){bP=$nim.G.V(au+$nim.aY+'page'+i+'.div');ag=$nim.G.V(au+$nim.aY+'page'+i+$nim.aY+'body');if(bP){bP.style.height=(hgt-7)+'px';bP.className=bP.className.replace('nim-active','');}if(ag){ag.className=ag.className.replace('nim-active','');}}tabelem=$nim.G.V(au);$nim.df(tabelem.id,'page',index);bP=$nim.G.V(au+$nim.aY+'page'+index+'.div');ag=$nim.G.V(au+$nim.aY+'page'+index+$nim.aY+'body');if(bP){bP.style.height=hgt+'px';bP.className=bP.className.trim()+' nim-active';}if(ag){ag.className=ag.className.trim()+' nim-active';}for(i=1;i<=pages;i++){$nim.G.copyBackColor(au+$nim.aY+'panes',au+$nim.aY+'page'+i+'.div',false);}if(tabelem&&tabelem.ontabchange){tabelem.ontabchange(e);e.preventDefault();}}if(e&&e.stopPropagation)e.stopPropagation();cc=null;bP=null;ag=null;return false;},tabScrolled:function(e){var bq=e.target.id.resolveName(),cY=bq.Form,af=bq.Control,dir=bq.Component,tabPos=$f.getpos(cY,af+$nim.aY+"tabs"),tabSize=$f.getsize(cY,af+$nim.aY+"tabs");switch(dir){case "left":if(tabPos.left> -(tabSize.width*0.7)){tabPos.left=tabPos.left-15;$f.move(cY,af+$nim.aY+"tabs",tabPos.left,tabPos.top);}else{$nim.Mouse.mousedown=false;}break;case "right":if(tabPos.left<0){tabPos.left=tabPos.left+15;$f.move(cY,af+$nim.aY+"tabs",tabPos.left,tabPos.top);}else{$nim.Mouse.mousedown=false;}break;default:break;}if(e&&e.stopPropagation)e.stopPropagation();},listClick:function(e){var bq=e.target.id.resolveName();var au=$nim.instN(bq.Form,bq.Control);var cc=$nim.G.V(au+$nim.bJ+"items");var ctype;if(cc&&(!e.button&& !$nim.Key.Ctrl)){ctype=cc.getAttribute('type')||cc.ctype;switch(ctype){case 'image':break;case 'check':break;case 'edit':break;default:break;}}if(e&&e.stopPropagation)e.stopPropagation();},Make:function(cY,af,ctype,fld,l,t,w,h){'use strict';var x,F;var click,bh,ac;ac=l.toFixed(2)+','+t.toFixed(2)+','+w.toFixed(2)+','+h.toFixed(2);click="";if($nim._._$.length>0){click='';}if(fld!==null){if(!$nim.undef(fld.height)){h=0;F=fld.height.length;for(x=0;x<F;x++){h=h+fld.height[x];}}}bh={parent:$nim.bName(cY,''),name:af,type:ctype,field:fld,"class":'nim_'+ctype,style:{font:'inherit',left:'0px',top:'0px',height:'100%',width:'100%'},events:{onclick:click},parms:{form:cY,origSize:ac}};switch(ctype){case "menu":case "submenu":bh.style['position']='absolute';break;case "image":case "imagex":case "picclip":bh.style['position']='absolute';bh.style['overflow']='hidden';break;case "button":case "imgbutton":bh.style['position']='initial';bh.style['overflow']='hidden';break;case "imgbuttonx":bh.style['position']='initial';bh.style['overflow']='visible';break;case "progress":bh.parms['value']='0';bh.parms['max']='100';break;case "panellist":case "panel-list":case "panel":bh.style['position']='absolute';break;case "datatables":bh.style['padding']='4px';bh.style['overflow']='auto';bh.style['border']='0px solid #333';break;case "treeview":if(!$nim.isobj(fld)){bh.field={rowheight:16,listsize:5,list:[],image:[],value:[]};}break;case "imglist":case "checklist":case "editlist":if(!$nim.isobj(fld)){bh.field={rowheight:24,listsize:5,list:[],image:[],value:[]};}break;case "label":case "label-left":case "checkbox":case "checkbox-left":case "option":case "option-left":case "optiongrp":case "optiongrp-left":bh.style['display']='table';bh.style['vertical-align']='middle';bh.style['text-align']='left';break;case "textbox":case "textbox-left":bh.style['text-align']='left';bh.style['position']='relative';bh.style['display']='table';break;case "label-center":bh.style['display']='table';bh.style['text-align']='center';bh.style['position']='relative';break;case "textbox-center":bh.style['text-align']='center';bh.style['position']='relative';break;case "label-right":case "checkbox-right":case "option-right":case "optiongrp-right":bh.style['display']='table';bh.style['vertical-align']='middle';bh.style['text-align']='right';break;case "textbox-right":bh.style['text-align']='right';bh.style['position']='relative';break;case "textarea":bh.style['display']='inline-block';bh.style['position']='relative';break;default:bh.style['display']='inline-block';bh.style['position']='absolute';break;}$nim.FontType(ctype,bh);return $nim.Elements.make(bh);},AttachEvents:function(cY,af,ctype,fld,l,t,w,h){'use strict';var x,F;var cc,aU;switch(ctype){case "imglist":case "checklist":cc=$nim.G.V(af);cc.onclick=function(e){if(e.target){var bq=e.target.id.resolveName();$nim.by.List.SelectIndex(bq.Form,bq.Control,bq.ItemName|| -1);}};break;case "editlist":cc=$nim.G.V(af);cc.onclick=function(e){if(e.target){var bq=e.target.id.resolveName();$nim.by.List.SelectIndex(bq.Form,bq.Control,bq.ItemName|| -1);}};cc.ondblclick=function(e){if(e.target){var bq=e.target.id.resolveName();var base=bq.Control+"."+bq.Component+"."+bq.ItemName;$nim.by.List.SelectIndex(bq.Form,bq.Control,bq.ItemName|| -1);if(ctype=="editlist"){var edit=$f.cc(bq.Form,base+".edit");var label=$f.cc(bq.Form,base+".caption");if(edit&&label){label.style['display']='none';edit.style['display']='inline';edit.value=label.innerText;edit.focus();edit.onblur=function(e){if(e.target){var bq=e.target.id.resolveName();var base=bq.Control+"."+bq.Component+"."+bq.ItemName;$nim.by.List.SelectIndex(bq.Form,bq.Control,bq.ItemName|| -1);if(ctype=="editlist"){var edit=$f.cc(bq.Form,base+".edit");var label=$f.cc(bq.Form,base+".caption");if(edit&&label){edit.onblur=null;edit.style['display']='none';$nim.G.i18n(label,'innerText',edit.value);label.style['display']='inline';}}}};edit.onkeydown=function(e){var key=e.keyCode||e.which;if(key==13){this.onblur(e);}};}}}};break;case "treeview":cc=$nim.G.V(af);cc.onclick=function(e){if(e.target){var bq=e.target.id.resolveName();$nim.by.List.SelectIndex(bq.Form,bq.Control,bq.ItemName|| -1);var base=bq.Control+"."+bq.Component+"."+bq.ItemName;var cc=$f.cc(bq.Form,base);var gelem=$f.cc(bq.Form,base+".group");if(cc&&gelem){if($nim.dE(cc.id,"state")=="show"){gelem.style['display']="none";$nim.df(cc.id,"state","hide");$f["class"].swap(bq.Form,base+".image","folder_open","folder_close");}else{gelem.style['display']="block";$nim.df(cc.id,"state","show");$f["class"].swap(bq.Form,base+".image","folder_close","folder_open");}}}};break;case "panellist":case "panel-list":F=fld.titles.length||0;for(x=0;x<F;x++){$nim.ax.bG(af+$nim.aY+x+$nim.aY+'body',"panel-list");cc=$nim.G.V(af+$nim.aY+x+$nim.aY+'button');cc.onclick=function(e){var J=e.currentTarget.id,base=J.split($nim.aY+'button'),cc=$nim.G.V(J);var dlg=J.resolveName('forminst'),af=J.resolveName('ctrlinst');if($f.getprop(dlg,af,'toggle')=='close'){$f.setprop(dlg,af,'toggle','open');$nim.G.V(J).src='media/icons/panel_close.gif';aU=$nim.G.V(base[0]+$nim.aY+'body');l=aU.offsetLeft;t=aU.offsetTop;h=aU.offsetHeight;$f[$nim.mv](dlg,J.resolveName('compinst')+$nim.aY+'body',l,t,-1,1,0.20);}else{$f.setprop(dlg,af,'toggle','close');$nim.G.V(J).src='media/icons/panel_open.gif';aU=$nim.G.V(base[0]+$nim.aY+'body');l=aU.offsetLeft;t=aU.offsetTop;h=dA($f.getprop(dlg,af,'expand'));$f[$nim.mv](dlg,J.resolveName('compinst')+$nim.aY+'body',l,t,-1,h,0.20);}};}break;case "panel":$nim.ax.bG(af+$nim.aY+'body',"panel");cc=$nim.G.V(af+$nim.aY+'button');cc.onclick=function(e){var J=e.currentTarget.id,base=J.split($nim.aY+'button'),cc=$nim.G.V(J);var dlg=J.resolveName('forminst'),af=J.resolveName('ctrlinst');if($f.getprop(dlg,af,'toggle')=='close'){$f.setprop(dlg,af,'toggle','open');$nim.G.V(J).src='media/icons/panel_close.gif';aU=$nim.G.V(base[0]+$nim.aY+'body');if(cc){l=$nim.G.cX(aU);t=$nim.G.cF(aU);h=$nim.G.dC(aU);$f[$nim.mv](dlg,J.resolveName('control')+$nim.aY+'body',l,t,-1,1,0.20);}}else{$f.setprop(dlg,af,'toggle','close');$nim.G.V(J).src='media/icons/panel_open.gif';aU=$nim.G.V(base[0]+$nim.aY+'body');if(cc){l=$nim.G.cX(aU);t=$nim.G.cF(aU);h=dA($f.getprop(dlg,af,'expand'));$f[$nim.mv](dlg,J.resolveName('control')+$nim.aY+'body',l,t,-1,h,0.20);}}};break;default:break;}$nim.G.cursorEvent(cc,true);cc=null;aU=null;},AddWidget:function(cY,af,ctype,fld,l,t,w,h){var list=$nim.Load32.Clear();function complete(){$nim.SetId(cY);KERNEL.Instance.NewWidget(cY,cY.resolveName('form'),af,fld.module,fld.form,{target:cY,dock:'RRRR',left:l,top:t,width:w,height:h});$nim.SetId(cY);$f.events(cY.resolveName('form'),'Load')(cY,cY.resolveName());$nim.SetId(cY);return;};if($nim.Load32.onComplete){$nim.Load32.onComplete(list,complete);}else{$nim.Load32.Load_Complete=complete;}$nim.Load32.Add(fld.module,'js/'+fld.module+'.js','js');if($nim.Load32.list[list].length>0){$nim.Load32.ArrayLoad(list,0);return;}else{$nim.Load32.Load_Complete(list);}$nim.SetId(cY);return;},Add:function(cY,af,ctype,fld,l,t,w,h){'use strict';cY=cY.toLowerCase();af=af.toLowerCase();var x,dlg,cname,aM,bZ,cc,dest='',sysTypes;var aj,instForm,ctrl_html,ac,aI,ctrl_style;var dbdr;af+=(ctype=='zone')?'.body':'';if($nim.am(af)===null){if(cY.right(5)=='.back'){bZ=cY.split($nim.aY);dest=bZ[1]+$nim.aY+bZ[2];dlg=$nim.bName(bZ[0],dest);}else{dlg=cY;}aj=$nim.G.V(dlg);instForm=$nim.bName(dlg,dest);if(!aj){aj=$nim.G.V(instForm);}if(aj){if($nim.undef(aj.menu)){aj.menu=false;aj.menuhide=false;}if(['menu','submenu'].indexOf(ctype)> -1){cname=af.resolveName('control');if(!App.Menus)App.Menus=[];aM=App.Menus.filter(function(it){return it.id==cname;});if(aM&&aM.length==0){App.Menus.push({root:cname.split('-')[0],id:cname,type:ctype,data:fld});}}switch(ctype){case "submenu":w=defaults.menus.menu_width;break;case "menu":aj.menu=true;if(fld&&fld.forEach){fld.forEach(function(aM){if(aM.settings){if(aM.settings.split('')[2]==1){aj.menuhide=true;}}});}h=h+5;break;case "datatables":w=w-10;h=h-20;break;default:break;}aI=$nim.G.vDOM("div");aI.attrib("borderpad",'false');if(ctype!="menu"&&($nim.G.cu(aj,$nim._k))){if(aj.menu){if(!aj.menuhide){t=t+$nim.cn.menus.menu_height;}else{t=t+2;}}l=l+$nim.G.adjPad(aj,'actw',l);w=w+$nim.G.adjPad(aj,'actw',w);t=t+$nim.G.adjPad(aj,'acth',t);h=h+$nim.G.adjPad(aj,'acth',h);aI.attrib("borderpad",'true');}ctrl_html=$nim.by.Make(cY,af,ctype,fld,l,t,w,h);ac=l.toFixed(2)+','+t.toFixed(2)+','+w.toFixed(2)+','+h.toFixed(2);ctrl_style="box-sizing:border-box;opacity:1;height:"+h.toFixed(2)+"px;width:"+w.toFixed(2)+"px;top:"+t.toFixed(2)+"px;left:"+l.toFixed(2)+"px;";ctrl_style+=(['listbox','button'].indexOf(ctype)> -1)?"overflow:hidden;":"";$nim.G.setAttrs(aI,{parent:instForm,ctype:ctype,"prv-visibility":'visible',"prv-display":'',type:ctype.toLowerCase(),display:'inline-block',control:(ctype!="menu"),facing:'face',ftimer:'0',stimer:'0',rtimer:'0',lpx:l,tpx:t,wpx:w,hpx:h,actw:w,acth:h,curw:w,curh:h});switch(ctype){case "div":ctrl_style="background-color:transparent;position:absolute;overflow:hidden;"+ctrl_style;break;case "submenu":ctrl_style="display:none;z-index:9000;position:absolute;max-width:"+w+"px;"+ctrl_style;aI.attrib("display",'none');aI.attrib("type",'menu');aI.attrib("menu",af.resolveName('control'));aM=af+$nim.aY+'div';if($nim.Menu._list.indexOf(aM)== -1)$nim.Menu._list.push(aM);break;case "menu":dbdr=$nim.cn.dialog.dlg_border+1;ctrl_style="z-index:9000;position:fixed;box-shadow:rgba(0, 0, 0, 0.4) 0px 2px 5px 0px;"+"box-sizing:border-box;margin:0px "+dbdr+"px;opacity:1;overflow:hidden;border-radius:5px;"+"left:0.1px;top:"+defaults.dialog.title_height+"px;min-width:calc(100% - "+(dbdr*2)+"px);height:"+(defaults.menus.menu_height+14)+"px";aI.attrib("type",'menu');aI.attrib("menu",af.resolveName('control'));aM=af+$nim.aY+'div';if($nim.Menu._list.indexOf(aM)== -1)$nim.Menu._list.push(aM);break;case "listbox":ctrl_style+="text-align:left;display:inline;overflow:hidden;"+$nim._keys(23);break;case "tab":aI.attrib("pages",fld.titles.length);break;case "panel":ctrl_style="position:absolute;"+ctrl_style;break;case "panellist":case "panel-list":ctrl_style="position:absolute;"+ctrl_style;aI.attrib("count",fld.titles.length);break;case "option":case "option-left":case "option-right":ctrl_style+="vertical-align:middle;"+$nim._keys(23);break;case "optiongrp":case "optiongrp-left":case "optiongrp-right":aI.attrib("count",fld.caption.length);ctrl_style+="vertical-align:middle;"+$nim._keys(23);break;case "label":case "label-left":case "label-right":case "label-center":case "checkbox":case "checkbox-left":case "checkbox-right":ctrl_style+="vertical-align:middle;"+$nim._keys(23);break;default:ctrl_style+="text-align:left;"+$nim._keys(23);break;}aI.attrib("style",ctrl_style);if($nim.undef(aI.attributes['dock'])){aI.attrib('dock',"FFFF");}$nim.ab.setOrigCoords(null,aI,ac);if(['div','zone'].indexOf(ctype)> -1){aI.attrib("id",af);}else{aI.attrib("id",af+$nim.aY+'div');}if(aj){aI.attrib("widget",$nim.dE(aj.id,"widget")||false);}aI.innerHTML=ctrl_html;cc=aI.create();if(cc){aj.appendChild(cc);if(App){var form_name=cY.resolveName('form'),ctrl_name=af.resolveName('control');if(form_name&&App.Dialog[form_name]){if(!App.Dialog[form_name].Controls){App.Dialog[form_name].Controls=[];}if(ctrl_name){if(App.Dialog[form_name].Controls.indexOf(ctrl_name)== -1){App.Dialog[form_name].Controls.push(ctrl_name);}}}if(USER._libs['tooltip.web'])$nim.Tooltip.attach(form_name,ctrl_name);}$nim.ax.bG(af,ctype);sysTypes=[{af:'div',type:ctype,stop:null,pevent:'auto'},{af:'caption',type:ctype,stop:null,pevent:'none'},{af:'value',type:ctype,stop:null,pevent:'none'},{af:'items',type:ctype,stop:null,pevent:'inherit'},{af:'image',type:ctype,stop:null,pevent:'none'},{af:'edit',type:ctype,stop:null,pevent:'none'},{af:'url',type:ctype,stop:null,pevent:'inherit'},{af:'border',type:ctype,stop:null,pevent:'inherit'},{af:'button',type:ctype,stop:null,pevent:'inherit'},{af:'body',type:ctype,stop:null,pevent:'inherit'},{af:'range',type:ctype,stop:null,pevent:'inherit'},{af:'bar',type:ctype,stop:null,pevent:'inherit'}];for(x=0;x<sysTypes.length;x++){$nim.ax.bG(af+$nim.aY+sysTypes[x].af,sysTypes[x].type,sysTypes[x].stop,sysTypes[x].pevent);}$nim.by.AttachEvents(cY,af,ctype,fld,l,t,w,h);$nim.G.mergeObjects($nim._struct[aI.id],{type:ctype.toLowerCase(),control:(ctype!="menu").toString(),_init:fld,_coords:{left:l,top:t,width:w,height:h}});}}}aI=null;aj=null;},Unload:function(af){var J=$nim.G.V(af);if(J){$nim.ax.bK(af);$nim.ax.removeElementById(af);}J=null;},removeEvent:function(af,eventType,handler){var J=$nim.G.V(af);if(J){if(J.removeEventListener)J.removeEventListener(eventType,handler,false);else if(J.detachEvent)J.detachEvent('on'+eventType,handler);}else{$nim.G.ce($nim.by.removeEvent,arguments);}J=null;},addEvent:function(af,eventType,handler){var J=$nim.G.V(af);if(J){if(J.addEventListener){J.removeEventListener(eventType,handler,false);J.addEventListener(eventType,handler,false);}else if(J.attachEvent){J.detachEvent('on'+eventType,handler);J.attachEvent('on'+eventType,handler);}}else{$nim.G.ce($nim.by.addEvent,arguments);}J=null;},setEvent:function(af,e,func){var J=$nim.G.V(af),targCtrl=$nim.am(af+'.items')||$nim.am(af),cr=$nim.G.V(af+$nim.aY+'div');var store;if(J){var propObj=$nim._struct[J.id]||$nim._struct[J.id+'.div'];if(propObj){if(!propObj._events)propObj._events={};store={};store[e]=func;$nim.G.mergeObjects(propObj._events,store);}if(func&&typeof func=='function'){switch(e){case "onmousedown":if(targCtrl&&J["ctype"]=='treeview'){targCtrl[e]=$nim.G.WrapEvent(targCtrl,targCtrl[e],func,e);}else{J[e]=$nim.G.WrapEvent(J,J[e],func,e);}break;case "ondragstart":if(cr)cr[e]=$nim.G.WrapEvent(cr,cr[e],func,e);break;default:J[e]=$nim.G.WrapEvent(J,J[e],func,e);break;}}else{switch(e){case "onmousedown":if(targCtrl&&J["ctype"]=='treeview'){targCtrl[e]=null;}else{J[e]=null;}break;case "ondragstart":if(cr)cr[e]=null;break;default:J[e]=null;break;}}}else{$nim.G.ce($nim.by.setEvent,arguments);}$nim.G.cursorEvent(cr||J,func?true:false);J=null;cr=null;},df:function(af,bE,val){var x,fld,F,wform,bctrl,wctrl,etarg,J,parms,cr,targBody,targItms,capTarg,id,bq,blSize=false;function cB(af,bE,val){var bZ=[];var origprop=bE,store;var propObj=$nim._struct[J.id]||$nim._struct[J.id+'.div'];if(propObj&&af.indexOf('.div')== -1){if(!propObj._props)propObj._props={};store={};store[bE]=val;$nim.G.mergeObjects(propObj._props,store);}if(bE&&bE.indexOf('.')> -1){wform=af.resolveName('form')||af;wctrl="";bctrl=af.resolveName('control');var i,aM,bZ=bE.split(".")[0].split("-");for(i=0;i<bZ.length;i++){aM=bZ[i];wctrl+=(bctrl!=aM)?"."+aM:"";}wctrl=(!bctrl)?wctrl.substr(1):wctrl;$f.setprop(wform,bctrl+wctrl,bE.split('.')[1],val);}else{if(['scale-cpl','scaletype'].indexOf(bE)> -1)blSize=true;if(val&&val.split){parms=val.split(';');}if(!$nim._struct[id])$nim._struct[id]={};bE=bE.toLowerCase();switch(bE){case "range-width":if(parms){$nim.aO.WidthRange(af.resolveName('form'),af.resolveName('control'),parms[0],parms[1],parms[2]);}break;case "range-height":if(parms){$nim.aO.HeightRange(af.resolveName('form'),af.resolveName('control'),parms[0],parms[1],parms[2]);}break;case "set-list":if(parms){$nim.by.List.AddList(af.resolveName('form'),af.resolveName('control'),parms[0],parms[1]);}break;case "set-csv":break;case "hotkey":$nim.G.attachHotkey(af,val);break;case "rows":$nim.by.PicClip.Rows(af.resolveName('form'),af.resolveName('control'),val);break;case "cols":$nim.by.PicClip.Cols(af.resolveName('form'),af.resolveName('control'),val);break;case "graphiccell":$nim.by.PicClip.GraphicCell(af.resolveName('form'),af.resolveName('control'),val);break;case "datalist":if(val)$nim.Elements.attachList(af,val);break;case "bind":aM=J.id.split($nim.aY);$nim._struct[id][bE]=(val=='true')?'true':'false';if(val=='true')$nim._struct[id]["bindid"]=aM[1]||'';break;case "bindid":$nim._struct[id]["bind"]=(val)?"true":"false";$nim._struct[id][bE]=val||'';break;case "autosize":$nim._struct[id][bE]=($nim.G.cu(J,$nim._s))?val:'';break;case "tag":case "events":if($nim._struct[id][bE]!=val){$nim._struct[id][bE]=val;}break;case "xdragrange":case "ydragrange":case "xdrag%":case "ydrag%":val=val.toString();if($nim._struct[id][bE]!=val){$nim._struct[id][bE]=val||'';}break;case "dragable":val=val.toString();if($nim._struct[id][bE]!=val){$nim._struct[id][bE]=val||'';if(['false'].indexOf(val)== -1){bq=J.id.resolveName();bq.Control=(bq.Control=='body')?'':bq.Control;$f.makedragable(bq.Form,bq.Control,$nim.G.dragStyle(val));}}break;case "sizeable":val=val.toString();if($nim._struct[id][bE]!=val){$nim._struct[id][bE]=val||'';if(['false'].indexOf(val)== -1){bq=J.id.resolveName();$f.makesizeable(bq.Form,val);}}break;case "!dock":$nim._struct[id]['dock']=(!val&&isNaN(val))?'':val;$nim.G.lockFlags(J);break;case $nim.G.isInGroup('structGroup',bE):$nim._struct[id][bE]=(!val&&isNaN(val))?'':val;if(bE=='dock'||bE.indexOf('lock-')> -1)$nim.G.lockFlags(J);if(bE=='dock'){if($nim.G.cu(J,$nim._s)){if(['true','w','h','width','height'].indexOf($nim._struct[id]['autosize'])> -1){bZ=['position','left','top','width','height'];if(['w','width'].indexOf($nim._struct[id]['autosize'])> -1)bZ=['width'];if(['h','height'].indexOf($nim._struct[id]['autosize'])> -1)bZ=['height'];targBody=$nim.G.V(af+$nim.aY+'body');$nim._struct[id][bE]=val||'';bZ.forEach(function(aM){if(J)J.style[aM]='';if(targBody)targBody.style[aM]='';});}}}else{['pos','position','left','top','width','height'].forEach(function(aM){if(val&&bE=='lock-'+aM){if(cr){if(aM=='pos'){cr.style.left='';cr.style.top='';}else{cr.style[aM]='';}}}});if(KERNEL.sdkMode){$nim._struct[id][bE]=val||'';J.setAttribute(bE,val);}}break;case "checked":J.checked=val;J.setAttribute("checked",val);break;case "class":J.className=val;if(targItms){targItms.className=val;}break;case "value":J.value=val;J.setAttribute("value",val);break;case "page":case "pages":J.setAttribute(bE,val);if(cr){$nim.df(af+$nim.aY+"div",bE,val);}break;case "text":case "caption":if(!$nim.undef(J["ctype"])){if($nim.G.cu(J,$nim._d)&&($nim.G.V(af+$nim.aY+"dlgtitle"))){capTarg=$nim.G.V(af+$nim.aY+"dlgtitle");$nim.G.i18n(capTarg,'innerHTML',val);}else{if($nim.G.V(af+$nim.aY+"caption")){switch(J["ctype"]){case "datatables":break;default:capTarg=$nim.G.V(af+$nim.aY+"caption");$nim.G.i18n(capTarg,'innerHTML',val);break;}}else{switch(J["ctype"]){case "label":$nim.G.i18n(J,'innerHTML',val);break;case "textbox":case "textarea":$nim.G.i18n(J,'value',val);break;case "iframe":case "imagex":case "panel-list":case "panel":case "datatables":case "tab":break;default:if(J.children.length===0){$nim.G.i18n(J,'innerHTML',val);}else{if(J.innerHTML.indexOf('parent')== -1){$nim.G.i18n(J,'innerHTML',val);}}break;}}}}else{if(J.className.indexOf('sdk-itm')> -1||J["ctype"]=="info"){$nim.G.i18n(J,'innerHTML',val);}}break;case "visible":J.setAttribute(bE,val);if(val&& !KERNEL.sdkMode){val=(val===true||val=='true');if(val){$f.show(af.resolveName('form'),af.resolveName('control'));}else{$f.hide(af.resolveName('form'),af.resolveName('control'));}}break;case "enabled":val=(val===true||val=='true');if(val){J.removeAttribute("disabled");if(cr){cr.removeAttribute("disabled");cr.style['opacity']=cr.getAttribute("opacity")||'1';}}else{J.setAttribute("disabled",val);if(cr){cr.setAttribute("opacity",cr.style['opacity']||1);cr.setAttribute("disabled",val);cr.style['opacity']='.5';}}$nim.G.cursorEnabled(cr,J,val);break;case "no-events":val=(val===true||val=='true');if(val){J.setAttribute("no-events",val);if(!KERNEL.sdkMode){J.style['pointer-events']='none';if(cr)cr.style['pointer-events']='none';}}else{J.removeAttribute("no-events");if(!KERNEL.sdkMode){J.style['pointer-events']='';if(cr)cr.style['pointer-events']='';}}break;case "disabled":val=(val===true||val=='true');if(val){J.setAttribute(bE,val);if(cr){cr.setAttribute("opacity",cr.style['opacity']||1);cr.setAttribute(bE,val);cr.style['opacity']='.5';}}else{J.removeAttribute(bE);if(cr){cr.removeAttribute(bE);cr.style['opacity']=cr.getAttribute("opacity")||'1';}}$nim.G.cursorEnabled(cr,J,!val);break;case "title":(USER._libs['tooltip.web'])?J.setAttribute('tooltip',val):J.setAttribute(bE,val);break;default:J.setAttribute(bE,val);switch(bE){case 'toggleonflip':if($nim.G.cu(J,$nim._d)&& !$nim.G.cu(J,$nim._s)){bq=J.id.resolveName();if(val=='true'){if($nim.dE(J.id,'facing')=="face"){$f.hide(bq.Form,'page.back');$f.show(bq.Form,'body');}else{$f.show(bq.Form,'page.back');$f.hide(bq.Form,'body');}}else if(val=='false'){$f.show(bq.Form,'page.back');}}break;case "onclick":case "ondblclick":if(val){if(val.indexOf('(event)')>0){$nim.C.afterEvent(J,bE);}if((bE=='onclick')||(bE=='ondblclick')){$nim.G.cursorEvent(cr||J,true);}}break;default:break;}break;}}};val=(typeof(val)=='string')?KERNEL.cleanText(val):val;J=$nim.G.V(af);cr=$nim.G.V(af+$nim.aY+'div');targItms=$nim.G.V(af+$nim.aY+'items');if(J){id=cr?cr.id:J.id;switch($nim.G.type(bE)){case 'array':F=bE.length;for(x=0;x<F;x++){cB(af,bE[x].name,bE[x].value||'');}break;case 'object':for(fld in bE){cB(af,fld,bE[fld]);}break;default:cB(af,bE,val);break;}if(blSize)$nim.ab.resizeFont(J);}else{$nim.G.ce($nim.df,arguments);}etarg=null;J=null;cr=null;capTarg=null;targItms=null;},dE:function(af,bE){var ret='',id,J=$nim.G.V(af),cr=$nim.G.V(af+$nim.aY+'div');if(J){if(bE.indexOf(',')> -1){ret={};bE.split(',').forEach(function(aM){ret[aM]=$nim.by.dE(af,aM);});return ret;}if(bE.indexOf('.')> -1){cr=null;J=$nim.G.V(af+$nim.aY+bE.split('.')[0]);if(!J)return '';bE=bE.split('.')[1];}id=cr?cr.id:J.id;bE=bE.toLowerCase();switch(bE){case "visible":ret=$f.isvisible(id.resolveName('form'),id.resolveName('control')).toString();break;case "enabled":ret=$f.isenabled(id.resolveName('form'),id.resolveName('control')).toString();break;case "class":if(!$nim.undef(J.className)){ret=J.className;}else{ret='';}break;case "checked":if(!$nim.undef(J.checked)){ret=J.checked;}else{ret='';}break;case "value":if(!$nim.undef(J.value)){ret=J.value;}else{ret='';}break;case "text":case "caption":ret=J["innerHTML"];break;case $nim.G.isInGroup('structGroup',bE):if(!$nim._struct[id])$nim._struct[id]={};ret=$nim._struct[id][bE];break;default:if(typeof(J.attributes[bE])!=$nim._keys(4)){ret=J.attributes[bE].value;}else if(typeof(J[bE])!=$nim._keys(4)){ret=J[bE];}else{ret=(['disabled'].indexOf(bE)> -1)?'false':'';}break;}}else{ret=$nim.G.ce($nim.dE,arguments)||"";}J=null;return(!ret&&$nim.undef(ret))?'':ret;},cQ:function(af,bE,val){var nullProp,wform,bctrl,wctrl,etarg,x,F,fld,itemDiv,J=$nim.G.V(af),cr=$nim.G.V(af+'.div'),blSize=false,force=false,stylePush,cStyle,divOnly=$nim["const"].styles.divOnly;function cB(af,bE,val){var func,blForce,bRad,ctype;var origprop=bE,store,styleObj;var propObj=$nim._struct[J.id]||$nim._struct[J.id+'.div'];if(propObj&&af.indexOf('.div')== -1){if(!propObj._styles)propObj._styles={};store={};store[bE]=val;$nim.G.mergeObjects(propObj._styles,store);}wctrl='';force=false;val=['nil','null','-','--'].indexOf(val)> -1?'':val;if(bE==$nim.G.isInGroup('colorGroup',bE)){val=$nim.G.lookupColor(val);}if(bE&&bE.indexOf('.')> -1){wform=af.resolveName('form')||af;wctrl="";bctrl=af.resolveName('control');var i,aM,bZ=bE.split(".")[0].split("-");for(i=0;i<bZ.length;i++){aM=bZ[i];wctrl+=(bctrl!=aM)?"."+aM:"";}wctrl=(!bctrl)?wctrl.substr(1):wctrl;if(!$nim.G.cu(J,$nim._s)&&wctrl=='page.back'){$nim.G.setElemStyle('back.',wform,bE.split('.')[1],val);return;}if(!$nim.G.cu(J,$nim._s)&&wctrl=='start'){$nim.G.setElemStyle('start.',wform,bE.split('.')[1],val);return;}bE=bE.split('.')[1];if(wctrl!='.div'||bE!='display'){$f.setstyle(wform,bctrl+wctrl,bE,val);return;}}if(bE.toLowerCase()=='pointer-events'){if(J.getAttribute("no-events")=='true')return;}if(['height','width'].indexOf(bE)> -1)blSize=true;if(['max-height','max-width','min-height','min-width','height','width'].indexOf(bE)> -1&&stylePush&&cr){$nim.G.applyStyle(cr,bE,val);}else{if(wctrl!='.div'&&divOnly.indexOf(bE)== -1){$nim.G.applyStyle(J,bE,val);}}switch(bE.toLowerCase()){case $nim.G.isInGroup('positionGroup',bE):force=(bE.left(1)=='!');bE=force?bE.substr(1):bE;if(typeof val=='string'&&val.indexOf('calc')> -1){if(stylePush&&cr){$nim.df(cr.id,'lock-'+bE,'!!!!');cr.style[bE]=val;$nim.G.lockFlags(cr);}else{$nim.df(J.id,'lock-'+bE,'!!!!');J.style[bE]=val;$nim.G.lockFlags(J);}return;}if($nim["G"]){func=(bE=='left')?'cS':(bE=='top')?'cN':null;}else{func=(bE=='left')?'setL':(bE=='top')?'setT':null;}if(func&& !(J.lockL||J.lockT)){if(stylePush&&cr){if(val){$nim.G[func](cr,val,force);}else{cr.style[bE]=val;}}else{if(val){$nim.G[func](J,val,force);}else{J.style[bE]=val;}}}else{if(stylePush&&cr){cr.style[bE]=val;}else{J.style[bE]=val;}}break;case $nim.G.isInGroup('altPositionGroup',bE):nullProp=(bE=='right')?'left':(bE=='bottom')?'top':null;if(stylePush&&cr){cr.style[bE]=val;if(nullProp){cr.style[nullProp]='';}}else{J.style[bE]=val;if(nullProp){J.style[nullProp]='';}}if(typeof val=='string'&&val.indexOf('calc')> -1){if(cr){$nim.df(cr.id,'lock-'+nullProp,'!!!!');$nim.G.lockFlags(cr);}else{$nim.df(J.id,'lock-'+nullProp,'!!!!');$nim.G.lockFlags(J);}return;}break;case $nim.G.isInGroup('sizeGroup',bE):force=(bE.left(1)=='!');bE=force?bE.substr(1):bE;if(typeof val=='string'&&val.indexOf('calc')> -1){if(cr){$nim.df(cr.id,'lock-'+bE,'!!!!');cr.style[bE]=val;$nim.G.lockFlags(cr);}else{$nim.df(J.id,'lock-'+bE,'!!!!');J.style[bE]=val;$nim.G.lockFlags(J);}return;}if($nim["G"]){func=(bE=='width')?'cT':'cz';}else{func=(bE=='width')?'setW':'setH';}if(stylePush&&cr){if(val){$nim.G[func](cr,val,force);}else{cr.style[bE]=val;}}else{if(val){$nim.G[func](J,val,force);}else{J.style[bE]=val;}}break;case $nim.G.isInGroup('overflowGroup',bE):ctype=J.getAttribute('type')||J.ctype;if(stylePush&&cr){if(['textarea'].indexOf(ctype)> -1){cr.style[bE]='';J.style[bE]=val;}else{cr.style[bE]=val;J.style[bE]='';}}if(bE.indexOf('overflow')> -1){$nim.G.setElemStyle('start.',af,bE,val);}break;case $nim.G.isInGroup('showGroup',bE):if(['hidden','none'].indexOf(val)== -1){if(!J.getAttribute('prv-'+bE)||J.style[bE]&&val!=J.style[bE]){J.setAttribute('prv-'+bE,val);if(stylePush&&cr){cr.setAttribute('prv-'+bE,val);}}}if(bE!='display'){if(stylePush&&cr){cr.style[bE]=val;}if(wctrl!='.div')J.style[bE]=val;}else{if(stylePush&&cr){if(['table','table-cell'].indexOf(val.toLowerCase())== -1)cr.style[bE]=val;}if(wctrl!='.div')J.style[bE]=val;}break;case $nim.G.isInGroup('paddingGroup',bE):J.style[bE]=val;break;case $nim.G.isInGroup('marginGroup',bE):J.style[bE]=val;break;case $nim.G.isInGroup('vendorGroup',bE):if($nim.Agent.cssPrefix){J.style[$nim.Agent.cssPrefix+bE]=val;}J.style[bE]=val;break;case $nim.G.isInGroup('borderGroup',bE):itemDiv=$nim.G.V(af+'.items');bRad=['border-radius'].indexOf(bE)> -1;ctype=J.getAttribute('type')||J.ctype;if(['combobox','list','listbox'].indexOf(ctype)> -1){if(cr){cr.style[bE]=val||$nim["const"].styles.nil[bE]||'';}if(itemDiv&&bRad){itemDiv.style[bE]=val||$nim["const"].styles.nil[bE]||'';}J.style[bE]=(!cr||bRad)?val:$nim["const"].styles.nil[bE]||'none';}else if(['button','imgbutton','imgbuttonx'].indexOf(ctype)> -1){if(cr){cr.style[bE]=val||$nim["const"].styles.nil[bE]||'';}J.style[bE]=(!cr||bRad)?val:$nim["const"].styles.nil[bE]||'none';}else if(['textbox','textarea','password'].indexOf(ctype)> -1){if(cr){cr.style[bE]=val||$nim["const"].styles.nil[bE]||'';}J.style[bE]=(!cr||bRad)?val:$nim["const"].styles.nil[bE]||'';}else{if(stylePush&&cr){cr.style[bE]=val||$nim["const"].styles.nil[bE]||'';J.style[bE]=(!cr||bRad)?val:$nim["const"].styles.nil[bE]||'none';}else{if(cr){cr.style[bE]=val||$nim["const"].styles.nil[bE]||'';}J.style[bE]=val;}}break;case 'opacity':if($nim.Agent.usingFF){val=(0.98*val).toString();}if(stylePush&&cr){itemDiv=$nim.G.V(af+'.items');if(itemDiv){itemDiv.style[bE]=val;cr.style[bE]='';J.style[bE]='';}else{$nim.cQ(af+stylePush,bE,val);J.style[bE]='';}}else{J.style[bE]=val;}break;case $nim.G.isInGroup('rangeGroup',bE):if(stylePush&&cr){cr.style[bE]=val;}else{J.style[bE]=val;}break;case 'text-align':case 'vertical-align':if(stylePush&&cr){J.style[bE]=val;$nim.cQ(af+stylePush,bE,val);}else{J.style[bE]=val;}break;case 'font-family':if(val.indexOf('Verdana')== -1){val+=',Verdana';}if(stylePush&&cr){$nim.cQ(af+stylePush,bE,val);}else{J.style[bE]=val;}break;case 'pointer-events':if(stylePush&&cr){$nim.cQ(af+stylePush,bE,val);}else{J.style[bE]=val;}break;default:if(stylePush&&cr){$nim.cQ(af+stylePush,bE,val);if(bE.indexOf('background')> -1){itemDiv=$nim.G.V(af+'.items');if(itemDiv){itemDiv.style[bE]=val;cr.style[bE]='transparent';J.style[bE]='transparent';}else{if(bE.indexOf('color')> -1){J.style[bE]='';}}}if(bE.indexOf('color')> -1){J.style[bE]=val;}}else{J.style[bE]=val;}break;}};stylePush=$nim.G.cu(J,$nim._d)?'':'.div';val=(typeof(val)=='string')?KERNEL.cleanText(val):val;if(J){switch($nim.G.type(bE)){case 'array':F=bE.length;for(x=0;x<F;x++){cB(af,bE[x].name,bE[x].value||'');}break;case 'object':for(fld in bE){cB(af,fld,bE[fld]);}break;default:cB(af,bE,val);break;}if(blSize)$nim.ab.resizeFont(J);}else{$nim.G.ce($nim.cQ,arguments);}etarg=null;J=null;cr=null;},dj:function(af,bE){var J=$nim.G.V(af),ok2Read=false,ret='',styleObj;var cr=$nim.G.V(af+'.div');if(af.indexOf('.div')== -1){if(bE.indexOf(',')> -1){ret={};bE.split(',').forEach(function(aM){ret[aM]=$nim.by.dj(af,aM);});return ret;}if(bE.indexOf('.')> -1){cr=null;J=$nim.G.V(af+$nim.aY+bE.split('.')[0]);if(!J)return '';bE=bE.split('.')[1];}switch(bE){case $nim.G.isInGroup('borderGroup',bE):if(cr){ret=cr.style[bE];}else{if(J){ret=J.style[bE];}}break;case $nim.G.isInGroup('positionGroup',bE):if(cr){ret=cr.style[bE];}else{if(J){ret=J.style[bE];}}break;default:if(bE.indexOf('border')> -1){ok2Read=true;}if(bE.indexOf('background')> -1){ok2Read=true;}if(bE.indexOf('color')> -1){ok2Read=true;}if(bE.indexOf('max-')> -1||bE.indexOf('min-')> -1){ok2Read=true;}if(ok2Read){if(cr){ret=cr.style[bE];}else{if(J){ret=J.style[bE];}}}else{if(J){ret=J.style[bE];}}break;}}else{if(J){styleObj=J.attributes[$nim._keys(7)];ret=KERNEL.fetchStyle(styleObj?styleObj.value:"",bE);}else{ret=$nim.G.ce($nim.dj,arguments)||"";}}J=null;return ret;},config:function(af,props){props=props||[];var x,F=props.length;for(x=0;x<F;x++){if(props[x].f)$nim['set'+props[x].f](af,props[x].n,props[x].v||'');}},PushTarget:function(de,K,bq){$f.children(de,K,'digest',bq);return true;},PullTarget:function(de,K){return $f.children(de,K,'consume');},ConsumeTargets:function(de,K,blStruct){return $f.children(de,K,blStruct?'struct[]':'consume[]',null,true);},DigestTargets:function(clone_dlg,clone_ctrl,new_ctrl,target,data,clear){var id,aM,ct=[];var cc,bP,titm;new_ctrl=new_ctrl.toLowerCase();target=target.toLowerCase();cc=$f.cc(clone_dlg,clone_ctrl);bP=$f.cc(target);if(cc&&bP){titm=bP.id.resolveName();if(clear)$f.children(titm.Form,titm.Control,'clear');target=target||de;for(var x=0;x<data.length;x++){id=$f.clone(clone_dlg,data[x]._ctrl||clone_ctrl,new_ctrl,target);aM=id.resolveName();$f.children(aM.Form,aM.Control,'digest',data[x]);ct.push({id,Form:aM.Form,Control:aM.Control,_dataIndex:x,_data:data[x]});}}return ct;},Clone:function(de,K,new_ctrl,target,blSkipChldrn,blSkipEvents){var inst,attr,divAttr,coords,bq,basename,basetarget;var newinst,blDiv=false;var cc,newelem;new_ctrl=new_ctrl.toLowerCase();target=target.toLowerCase()||de;basetarget=target.resolveName('form')||target;cc=$f.cc(de,K);newelem=$f.cc(basetarget,new_ctrl);if(cc&& !newelem){inst=$f.buildname(de,K);divAttr=$nim._struct[inst+'.div'];attr=$nim._struct[inst]||divAttr;blDiv=divAttr?true:false;if(attr){coords=attr._coords;bq=inst.resolveName();$f.add(target,new_ctrl,attr.type,attr._init,coords.left,coords.top,coords.width,coords.height);newinst=$f.buildname(basetarget,new_ctrl);newinst+=blDiv?'.div':'';$nim._struct[newinst]=JSON.parse(JSON.stringify(attr));if(attr._props)$f.setprop(basetarget,new_ctrl,attr._props);if(attr._styles)$f.setstyle(basetarget,new_ctrl,attr._styles);if(!blSkipEvents&&attr._events){for(var G in attr._events){$f.setevent(basetarget,new_ctrl,G,attr._events[G]);}}!$f.isvisible(de,K)?$f.hide(basetarget,new_ctrl):null;}}if(!blSkipChldrn)$nim.G.cloneChildren(de,K,$f.buildname(target.resolveName('form'),new_ctrl),new_ctrl,blSkipEvents);return newinst;},Next:function(de,K,target,blSkipChldrn,blSkipEvents){target=target.toLowerCase();var inst,attr,coords,bq,basename,basetarget;var newinst,blDiv=false,nxt,found;var cc=$f.cc(de,K);target=target.toLowerCase()||de;if(cc){inst=$f.buildname(de,K);attr=$nim._struct[inst]||$nim._struct[inst+'.div'];blDiv=$nim._struct[inst+'.div']?true:false;if(attr){coords=$f.getcoords(de,K);bq=inst.resolveName();if(bq.ControlIndex> -1){basename=bq.BaseControl.toLowerCase();basetarget=target.resolveName('form')||target;nxt=0;found= !$f.isloaded(basetarget,basename+'('+nxt+')');;while(!found){nxt++;found= !$f.isloaded(basetarget,basename+'('+nxt+')');}basename+='('+nxt+')';$f.add(target,basename,attr.type,attr._init,coords.left,coords.top,coords.width,coords.height);newinst=$f.buildname(basetarget,basename);newinst+=blDiv?'.div':'';$nim._struct[newinst]=JSON.parse(JSON.stringify(attr));if(attr._props)$f.setprop(basetarget,basename,attr._props);if(attr._styles)$f.setstyle(basetarget,basename,attr._styles);if(!blSkipEvents&&attr._events){for(var G in attr._events){$f.setevent(basetarget,basename,G,attr._events[G]);}}$f.isvisible(de,K)?$f.show(basetarget,basename):$f.hide(basetarget,basename);}}}if(!blSkipChldrn)$nim.G.cloneChildren(de,K,$f.buildname(target.resolveName('form'),basename),basename,blSkipEvents);return basename;},dH:function(de,K){var cc=$f.cc(de,K),ret=null;if(cc){ret={left:$nim.G.cX(cc),top:$nim.G.cF(cc)};ret.left=(ret.left=='0px')?cc.offsetLeft:ret.left;ret.top=(ret.top=='0px')?cc.offsetTop:ret.top;}else{ret=$nim.G.ce($nim.by.dH,arguments);}return ret;},cL:function(de,K,lW,tH){var pW=$nim.pW,pH=$nim.pH,J='',cc=$f.cc(de,K);if(lW&&lW.left){lW=lW.left;tH=lW.top;}if(cc){J=(K)?$nim.instN(de):cc.getAttribute('parent');var l=pW(J,lW),t=pH(J,tH);if((isNaN(l)===false)&&(l!==null)){$nim.G.cS(cc,l+"px");}if((isNaN(t)===false)&&(t!==null)){$nim.G.cN(cc,t+"px");}if(K){$nim.ab.setOrigCoords(null,cc,null,true);}}else{$nim.G.ce($nim.by.cL,arguments);}},Left:function(de,K,L){var pW=$nim.pW,pH=$nim.pH,J='',cc=$f.cc(de,K);if(cc){if(L)$nim.by.cL(de,K,L,$nim.G.cF(cc));else return cc.offsetLeft||$nim.G.cX(cc);}},Top:function(de,K,T){var pW=$nim.pW,pH=$nim.pH,J='',cc=$f.cc(de,K);if(cc){if(T)$nim.by.cL(de,K,$nim.G.cX(cc),T);else return cc.offsetTop||$nim.G.cF(cc);}},Caption:function(de,K,txt){K=K||"";var ret,prvTxt,au=$nim.instN(de,K),cc=$nim.am(au),notxt=$nim.undef(txt);cc=notxt?($nim.G.V(au+$nim.bJ+'caption')||cc):cc;if(cc){au=cc.id;prvTxt=$nim.dE(au,'caption');ret= !notxt?$nim.df(au,'caption',txt):$nim.dE(au,'caption');if(txt&&txt!=prvTxt){if(App&&App.Dialog&&App.Dialog[de]){$nim.G.TriggerDlgEvent(au,au.resolveName('basectrl').toLowerCase()+'_OnChange',null);}}return ret;}else{return $nim.G.ce($nim.by.Caption,arguments);}},Text:function(de,K,txt){var au=$nim.instN(de,K),ctype,cc=$nim.am(au),notxt=$nim.undef(txt);if(cc){ctype=cc["ctype"]?cc["ctype"].toLowerCase():'';if(['combobox','listbox'].indexOf(ctype)> -1){return!notxt?$nim.by.List.SelectCaption(de,K,txt):$nim.by.List.SelectedCaption(de,K)||'';}else{return!notxt?((!K)?$f.settitle(de,txt):$f.setcaption(de,K,txt)):((!K)?$f.gettitle(de,txt):$f.getcaption(de,K,txt));}}else{return $nim.G.ce($nim.by.Text,arguments);}return null;},Checked:function(de,K,txt){var ret,au=$nim.instN(de,K),ctype,tmr,e,cc=$nim.am(au),notxt=$nim.undef(txt);if(cc){ctype=cc["ctype"]?cc["ctype"].toLowerCase():'';if(['combobox','listbox'].indexOf(ctype)> -1){ret=(!notxt)?$nim.by.List.SelectValue(de,K,txt):$nim.by.List.SelectedItem(de,K);}else{if(cc["ctype"]&&cc["ctype"].indexOf('checkbox')> -1){ret=(!notxt)?$nim.df(au+".check",'checked',txt):$nim.dE(au+".check",'checked');}else if(cc["ctype"]&&cc["ctype"].indexOf('option')> -1){ret=(!notxt)?$nim.df(au+".tick",'checked',txt):$nim.dE(au+".tick",'checked');}else{ret=(!notxt)?$nim.df(au,'checked',txt):$nim.dE(au,'checked');}}if(!notxt&&cc.onchange){e=$nim.G.buildEvent('system',cc);cc.onchange(e,txt);e.target=null;}}else{return $nim.G.ce($nim.by.Checked,arguments);}cc=null;return ret;},Value:function(de,K,txt){var ret,au=$nim.instN(de,K),prev,ctype,e,cc=$nim.am(au),notxt=$nim.undef(txt);function cB(put){var lval;if(['combobox','listbox'].indexOf(ctype)> -1){lval=(put)?$nim.by.List.SelectValue(de,K,txt):$nim.by.List.SelectedItem(de,K);}else{if(cc&&cc["ctype"].indexOf('checkbox')> -1){lval=(put)?$nim.df(au+".check",'checked',txt):$nim.dE(au+".check",'checked');}else if(cc&&cc["ctype"].indexOf('option')> -1){lval=(put)?$nim.df(au+".tick",'checked',txt):$nim.dE(au+".tick",'checked');}else{lval=(put)?$nim.df(au,'value',txt):$nim.dE(au,'value');}}return lval;};if(cc){ctype=cc["ctype"]?cc["ctype"].toLowerCase():'';prev=cB(false);ret=cB(!notxt);if(!notxt&&cc.onchange&&txt!=prev){e=$nim.G.buildEvent('system',cc);cc.onchange(e,txt);e.target=null;}}else{return $nim.G.ce($nim.by.Value,arguments);}cc=null;return ret;},Enable:function(de,K){var div,r=$nim.resolve(de,K||'disabled');if(!K){if(r.div){r.div.removeAttribute("disabled");$nim.by.Unload(r.inst);$nim.G.setElemStyle('start.',r.dlg,'transform','translateZ(1px)');}}else{if(r.cc){r.cc.removeAttribute("disabled");if(r.div){r.div.removeAttribute("disabled");r.div.style['opacity']='1';}else{r.cc.style['opacity']='1';}$nim.by.Unload(r.inst+".disabled");}else{$nim.G.ce($nim.by.Enable,arguments);}}$nim.G.cursorEnabled(r.div,r.cc,true);},Disable:function(de,K,blContent){de=de||"";K=K||"";var w,h,adj=0,title_hgt=blContent?($nim.cn.dialog.title_height+$nim.cn.dialog.dlg_border):0;var cc,div,au;if(!K){cc=$f.cc(de,'');if(cc){cc.setAttribute('disabled','true');w=$nim.G.dk(cc);h=$nim.G.dC(cc);if($f.isloaded(de,'disabled')){$f.setpos(de,'disabled',0,title_hgt);}else{$f.add(de,'disabled','div','',0,title_hgt,w,h-title_hgt);}$f.setprop(de,'disabled',{disabled:false,form:de,dock:'TTTT'},'');$f.setstyle(de,'disabled',{"opacity":"1","z-index":$nim.ab.MOVE2TOP+1,"background-color":"rgba(0,0,0,0.25)","border-radius":'inherit',width:'calc(100% + 4px)',height:'calc(100% - '+title_hgt+'px)',},'');$nim.G.setElemStyle('start.',de,'transform','');}}else{au=$nim.instN(de,K);cc=$nim.G.V(au);div=$nim.G.V(au+'.div');if(cc){if(['div','zone'].indexOf(cc.ctype)> -1){$nim.by.Clone(de,K,K+'.disabled',$f.instname(de,K),true);$f.setstyle(de,K+'.disabled',{"opacity":"1","border-radius":'inherit',"position":"absolute","left":"-2px","top":"-2px","width":"calc(100% + 4px)","height":"calc(100% + 4px)","margin":"0px","padding":"0px","background-color":"rgba(0,0,0,0.25)","z-index":999});}else{if(div){div.setAttribute("disabled","true");if(div.style['opacity']=='1')div.style['opacity']='.35';}else{if(cc.style['opacity']=='1')cc.style['opacity']='.5';}}cc.setAttribute("disabled","true");}else{$nim.G.ce($nim.by.Disable,arguments);}}$nim.G.cursorEnabled(div,cc,false);},DisableContent:function(de,K){$nim.by.Disable(de,K,true);},fadeOut:function(de,K,speed,G){var cc=$f.cc(de,K);function cB(){$k.instance.save();if(cc.style.opacity>0){cc.style.opacity=(Number(cc.style.opacity)-0.1).toFixed(2);setTimeout(cB,speed);}else{cc.style.opacity=0;$nim.df(cc.id,'ftimer','0');if(G){G(cc.id);}}$k.instance.restore();};if(cc){cc.style.opacity=1;$nim.df(cc.id,'ftimer','1');cB();}},fadeIn:function(de,K,speed,G){var cc=$f.cc(de,K);function cB(){$k.instance.save();if(cc.style.opacity<1){cc.style.opacity=(Number(cc.style.opacity)+0.1).toFixed(2);setTimeout(cB,speed);}else{cc.style.opacity=1;$nim.df(cc.id,'ftimer','0');if(G){G(cc.id);}}$k.instance.restore();};if(cc){cc.style.opacity=0;$nim.df(cc.id,'ftimer','1');cB();}},GetScreenPos:function(de,K,blCoord){var pos,cDisp,uGlb=$nim.cK.DlgStyles,uDef=$nim.cn.dialog,cc=$f.cc(de,K),af=$f.af(de,K),body=$f.cc(de,'body');var size={width:body.width,height:uDef.title_height},disp=(af)?(['absolute','custom'].indexOf(af.getAttribute('displaymode'))> -1):false,cD=(cc)?cc.getAttribute('parent'):null,ag=(cc)?(cc["ctype"]?cc:$nim.G.V(cD)):$nim.G.V(cD),title_hgt=(size)?(size.height?size.height:0):0,pad=(ag)?((title_hgt||ag["ctype"].split('.')[1]=='skin')?uDef.dlg_border:0):0;function addPos(eitem){var aM=eitem.id.resolveName(),nest=eitem.getAttribute('nested');if(aM&&aM.Form){pos=$f.getpos(aM.Form,aM.Control);if(pos){cLeft+=(eitem.offsetLeft!=0)?(nest=='true')?eitem.offsetLeft:(pos.left||eitem.offsetLeft):0;cTop+=(eitem.offsetTop!=0)?(nest=='true')?eitem.offsetTop:(pos.top||eitem.offsetTop):0;cLeft+=eitem.scrollLeft;cTop+=eitem.scrollTop;}}return(eitem.style.position=='fixed');};if(cc){pos=$f.getpos(de,K);var stop=false,blTitle,style,origId=cc.id,cLeft=cc.offsetLeft-1,cTop=cc.offsetTop-1;cDisp=(cc.style.position=='fixed');while(stop===false){if(cc&& !$nim.undef(cc["ctype"])){if(af&&af.getAttribute('child')=='true'){ag=cc.parentNode;cDisp=addPos(ag);if(ag.getAttribute('child')=='true'){ag=ag.parentNode;cDisp=addPos(ag);}af=null;}else{cD=cc.getAttribute('parent');ag=$nim.G.V(cD);}if(ag){cLeft-=ag.scrollLeft;cTop-=ag.scrollTop;}cD=$nim.aX($nim.bJ+'body','',cD);cc=$nim.G.V(cD);if(cc){$nim.SetId(cc.id);if(!cDisp&&$nim.G.cu(cc,$nim._d)){style=$nim.dE(cc.id,'dlg_style');blTitle=((style&uGlb.caption)==uGlb.caption);switch(cc["ctype"].split('.')[1]){case 'plain':cTop+=blTitle?title_hgt:1;break;case 'skin':if(cc.id.indexOf('page')== -1){cTop+=blTitle?(title_hgt+pad):1;cLeft+=pad;}else{cTop+=pad;cLeft+=pad;}break;default:break;}}addPos(cc);if(cc.className=='desktopbody'||cc.id.toLowerCase()=='nimble'||cc.id==='')stop=true;}else{stop=true;}}else{if(!cc){stop=true;}else{if(cc.className=='desktopbody'||cc.id.toLowerCase()=='nimble'||cc.id==='')stop=true;cc=cc.parentElement;}}}}else{return $nim.G.ce($nim.by.GetScreenPos,arguments);}$nim.SetId(origId);if(blCoord){var dSize=$f.getsize(de,K);return{left:cLeft,top:cTop,width:dSize.width,height:dSize.height};}else{return{left:cLeft,top:cTop};}},CalcCoordsRelative:function(de,K,coords){var ret=$nim.copy(coords);var rel=$nim.by.GetScreenPos(de,K,true);var relcrds=$f.getcoords(de,K,true);if(rel&&relcrds){ret.left=(coords.left-rel.left)+((['body',''].indexOf(K)> -1)?relcrds.left:0);ret.top=(coords.top-rel.top)+((['body',''].indexOf(K)> -1)?relcrds.top:0);}return ret;},Tab:{CreateTab:function(de,K,tabTitles,lW,tH,wW,hH){'use strict';K=K||"";var i,x,iname,bP,cc,aj;var ac,sysTypes,aI,ctrl_html,bh;var bC,instForm,ictrl,interval,ai;var pW=$nim.pW,pH=$nim.pH;var l=pW(de,lW),t=pH(de,tH),w=pW(de,wW),h=pH(de,hH);bC=$nim.bName(de,K);instForm=$nim.bName(de,'');ictrl=$nim.G.V(bC);ai=tabTitles.length;if(ictrl===null){ac=l.toFixed(2)+','+t.toFixed(2)+','+w.toFixed(2)+','+h.toFixed(2);bh={name:bC,type:'tab',titles:tabTitles,"class":'nim_tab',style:{display:'inline',position:'absolute',padding:'1px',height:h+'px',width:w+'px',left:l+'px',top:t+'px'},events:{},parms:{page:1,pages:ai,form:de,dock:'TTTT',origSize:ac}};$nim.FontType('tab',bh);ctrl_html=$nim.Elements.make(bh);aI=$nim.G.vDOM("div");aI.attrib($nim._keys(7),"display:inline;position:absolute;vertical-align:inherit;z-index:90;height:"+h+"px;width:"+w+"px;top:"+t+"px;left:"+l+"px;");if($nim.undef(aI.attributes['dock'])){aI.attrib('dock',"TTTT");}$nim.G.setAttrs(aI,{parent:instForm,id:bC+$nim.aY+'div',type:'tab',form:de,facing:'face',ftimer:'0',stimer:'0',rtimer:'0',lpx:l,tpx:t,wpx:w,hpx:h,page:1,pages:ai});$nim.ab.setOrigCoords(null,aI,ac);aI.innerHTML=ctrl_html;aj=$nim.G.V(instForm);if(aj){aI.attrib("widget",$nim.dE(aj.id,"widget")||false);}aj=$nim.G.V(instForm+$nim.aY+'body');if(aj){cc=aI.create();if(cc){aj.appendChild(cc);$nim.G.lockFlags(aj);}}$nim.ax.bG(bC,"tab");sysTypes=[{af:'div',type:'tab',stop:null,dock:'----'},{af:'pages',type:'control',stop:null,dock:'----'},{af:'panes',type:'tab',stop:null,dock:'----'},{af:'container',type:'tab',stop:null,dock:'----'},{af:'clip',type:'tab',stop:null,dock:'TTTT'},{af:'left',type:'control',stop:false,dock:'----'},{af:'right',type:'control',stop:false,dock:'----'}];for(x=0;x<sysTypes.length;x++){$nim.ax.bG(bC+$nim.aY+sysTypes[x].af,sysTypes[x].type,sysTypes[x].stop);aj=$nim.G.V(bC+$nim.aY+sysTypes[x].af);$nim.df(aj.id,"origSize",aj.offsetLeft+","+aj.offsetTop+","+aj.offsetWidth+","+aj.offsetHeight);$nim.df(aj.id,'dock',sysTypes[x].dock);if(sysTypes[x].af=='clip'){$nim.G.lockFlags(aj);}}iname=bC+$nim.aY+'left';$nim.G.copyBackColor(bC+$nim.aY+'panes',iname,true);$nim.G.V(iname).onmousedown=function(e){if(!interval){interval=setInterval(function(){$nim.by.tabScrolled(e);if($nim.Mouse.mousedown===false){clearInterval(interval);interval=null;}},50);}};iname=bC+$nim.aY+'right';$nim.G.copyBackColor(bC+$nim.aY+'panes',iname,true);$nim.G.V(iname).onmousedown=function(e){if(!interval){interval=setInterval(function(){$nim.by.tabScrolled(e);if($nim.Mouse.mousedown===false){clearInterval(interval);interval=null;}},50);}};for(i=1;i<=ai;i++){$nim.ax.bG(bC+$nim.aY+'page'+i,'control');$nim.ax.bG(bC+$nim.aY+'page'+i+$nim.aY+'caption','control');$nim.ax.bG(bC+$nim.aY+'page'+i+$nim.aY+'body','tab');iname=bC+$nim.aY+'page'+i;$nim.G.copyBackColor(bC+$nim.aY+'panes',iname,(i==1));$nim.G.V(iname).onmousedown=function(e){$nim.by.tabClicked(e);};$nim.G.V(iname+$nim.aY+'caption').onmousedown=function(e){$nim.by.tabClicked(e);};}$nim.G.mergeObjects($nim._struct[aI.id],{type:'tab',control:'true'});}ictrl=null;aI=null;aj=null;bP=null;},Position:function(de,K,posCode){'use strict';K=K||"";var i,ai=0,aV,tab,hgtAdj,version=$f.getprop(de,'body','version');var au=$nim.instN(de,K);var cc=$nim.G.V(au);if($nim.G.isCustom(de,K))return;if(cc){if(!$nim.undef(posCode)){cc.cposition=posCode;cc.parentNode.cposition=posCode;}ai=Number($f.tab.pages(de,K));aV=$f.getcoords(de,K);aV.height=$nim.cn.dialog.tab_height;tab=$f.getcoords(de,K);tab.height-=(!version)?22:0;hgtAdj=(!version)?aV.height:0;$f.origin(de,K,'50% 50% 0');$f.rotate(de,K,{x:0,y:0,z:0});$f.translate(de,K,{x:'0px',y:'0px',z:'0px'});$f.translate(de,K+$nim.aY+'container',{x:'0px',y:'0px',z:'0px'});$f.rotate(de,K+$nim.aY+'left',{x:0,y:0,z:0});$f.rotate(de,K+$nim.aY+'right',{x:0,y:0,z:0});$f.origin(de,K+$nim.aY+'pages','50% 50% 0');$f.rotate(de,K+$nim.aY+'pages',{x:0,y:0,z:0});$f.translate(de,K+$nim.aY+'pages',{x:'0px',y:'0px',z:'0px'});$f.origin(de,K+$nim.aY+'panes','50% 50% 0');$f.rotate(de,K+$nim.aY+'panes',{x:0,y:0,z:0});$f.translate(de,K+$nim.aY+'panes',{x:'0px',y:'0px',z:'0px'});$f.setpos(de,K+$nim.aY+'panes',0,aV.height-4);$f.size(de,K+$nim.aY+'panes',tab.width,tab.height+((!version)? -4: -(aV.height+2)));for(i=1;i<=ai;i++){$nim.G.copyBackColor(au+$nim.aY+'panes',au+$nim.aY+'page'+i,false);$f.origin(de,K+$nim.aY+'page'+i+$nim.aY+'caption','50% 50% 0');$f.rotate(de,K+$nim.aY+'page'+i+$nim.aY+'caption',{x:0,y:0,z:0});$f.translate(de,K+$nim.aY+'page'+i+$nim.aY+'caption',{x:'0px',y:'-50%',z:'0px'});$f.origin(de,K+$nim.aY+'page'+i+$nim.aY+'body','50% 50% 0');$f.rotate(de,K+$nim.aY+'page'+i+$nim.aY+'body',{x:0,y:0,z:0});$f.translate(de,K+$nim.aY+'page'+i+$nim.aY+'body',{x:'0px',y:'0px',z:'0px'});}$f.scale(de,K+$nim.aY+'pages',{x:1,y:1});$f.size(de,K+$nim.aY+'pages',tab.width,aV.height);$f.size(de,K+$nim.aY+'clip',tab.width,aV.height);$f.size(de,K+$nim.aY+'container',tab.width,tab.height);$f.setstyle(de,K+$nim.aY+'pages','z-index','6');switch(cc.cposition){case 'top-left':break;case 'top-right':$f.rotate(de,K,{x:0,y:0,z:0});$f.rotate(de,K+$nim.aY+'pages',{x:0,y:180,z:0});$f.scale(de,K+$nim.aY+'pages',{x:1,y:1});for(i=1;i<=ai;i++){$f.rotate(de,K+$nim.aY+'page'+i+$nim.aY+'caption',{x:0,y:180,z:0});$f.rotate(de,K+$nim.aY+'page'+i+$nim.aY+'body',{x:0,y:0,z:0});$f.setstyle(de,K+$nim.aY+'page'+i+$nim.aY+'caption','z-index',6);}$f.setstyle(de,K+$nim.aY+'pages','z-index',6);break;case 'bottom-left':$f.rotate(de,K,{x:0,y:0,z:180});$f.translate(de,K,{x:'0px',y:(aV.height-4)+'px',z:'0px'});$f.translate(de,K+$nim.aY+'pages',{x:'0px',y:'1px',z:'0px'});$f.rotate(de,K+$nim.aY+'pages',{x:0,y:180,z:0});$f.rotate(de,K+$nim.aY+'left',{x:180,y:0,z:0});$f.rotate(de,K+$nim.aY+'right',{x:180,y:0,z:0});$f.scale(de,K+$nim.aY+'pages',{x:1,y:1});for(i=1;i<=ai;i++){$f.translate(de,K+$nim.aY+'page'+i+$nim.aY+'caption',{x:'0px',y:'-50%',z:'0px'});$f.rotate(de,K+$nim.aY+'page'+i+$nim.aY+'caption',{x:180,y:0,z:0});$f.rotate(de,K+$nim.aY+'page'+i+$nim.aY+'body',{x:180,y:180,z:0});$f.setstyle(de,K+$nim.aY+'page'+i+$nim.aY+'caption','z-index',6);}$f.setstyle(de,K+$nim.aY+'pages','z-index',6);break;case 'bottom-right':$f.rotate(de,K,{x:0,y:0,z:180});$f.translate(de,K,{x:'0px',y:(aV.height-4)+'px',z:'0px'});$f.translate(de,K+$nim.aY+'pages',{x:'0px',y:'1px',z:'0px'});$f.rotate(de,K+$nim.aY+'pages',{x:0,y:0,z:0});$f.rotate(de,K+$nim.aY+'left',{x:180,y:0,z:0});$f.rotate(de,K+$nim.aY+'right',{x:180,y:0,z:0});$f.scale(de,K+$nim.aY+'pages',{x:1,y:1});for(i=1;i<=ai;i++){$f.rotate(de,K+$nim.aY+'page'+i+$nim.aY+'caption',{x:180,y:180,z:0});$f.rotate(de,K+$nim.aY+'page'+i+$nim.aY+'body',{x:180,y:180,z:0});$f.setstyle(de,K+$nim.aY+'page'+i+$nim.aY+'caption','z-index',6);}$f.setstyle(de,K+$nim.aY+'pages','z-index',6);break;case 'left-bottom':aV=$f.getcoords(de,K);aV.height=$nim.cn.dialog.tab_height;tab=$f.getcoords(de,K);tab.height-=hgtAdj;$f.translate(de,K+$nim.aY+'panes',{x:(aV.height/2)+'px',y:'0px',z:'0px'});$f.origin(de,K+$nim.aY+'pages',aV.height+'px '+aV.height+'px 0');$f.translate(de,K+$nim.aY+'pages',{x:'2px',y:(tab.height-(2*aV.height)+4)+'px',z:'0px'});$f.rotate(de,K+$nim.aY+'pages',{x:0,y:0,z: -90});$f.scale(de,K+$nim.aY+'pages',{x:0.9,y:1});$f.size(de,K+$nim.aY+'panes',tab.width-aV.height,tab.height+((!version)?(aV.height-4): -2));$f.setpos(de,K+$nim.aY+'panes',aV.height/2,0);$f.setstyle(de,K+$nim.aY+'pages','z-index',6);$f.size(de,K+$nim.aY+'pages',tab.height,aV.height);$f.size(de,K+$nim.aY+'clip',tab.height,aV.height);break;case 'left-top':aV=$f.getcoords(de,K);aV.height=$nim.cn.dialog.tab_height;tab=$f.getcoords(de,K);tab.height-=hgtAdj;$f.translate(de,K+$nim.aY+'panes',{x:(aV.height/2-2)+'px',y:'0px',z:'0px'});$f.scale(de,K+$nim.aY+'pages',{x:0.9,y:1});$f.origin(de,K+$nim.aY+'pages','0px 0px 0');$f.translate(de,K+$nim.aY+'pages',{x:'0px',y:'0px',z:'0px'});$f.rotate(de,K+$nim.aY+'pages',{x:180,y:0,z: -90});$f.size(de,K+$nim.aY+'panes',tab.width-aV.height,tab.height+((!version)?(aV.height-4): -2));$f.setpos(de,K+$nim.aY+'panes',aV.height/2,0);ai=$f.tab.pages(de,K);for(i=1;i<=ai;i++){$f.rotate(de,K+$nim.aY+'page'+i+$nim.aY+'caption',{x:0,y:180,z:0});$f.setstyle(de,K+$nim.aY+'page'+i+$nim.aY+'caption','z-index',6);}$f.setstyle(de,K+$nim.aY+'pages','z-index',6);$f.size(de,K+$nim.aY+'pages',tab.height,aV.height);$f.size(de,K+$nim.aY+'clip',tab.height,aV.height);break;case 'right-top':aV=$f.getcoords(de,K);aV.height=$nim.cn.dialog.tab_height;tab=$f.getcoords(de,K);tab.height-=hgtAdj;$f.rotate(de,K+$nim.aY+'left',{x:180,y:0,z:0});$f.rotate(de,K+$nim.aY+'right',{x:180,y:0,z:0});$f.scale(de,K+$nim.aY+'pages',{x:0.9,y:1});$f.origin(de,K+$nim.aY+'pages','0px '+aV.height+'px 0');$f.rotate(de,K+$nim.aY+'pages',{x:0,y:0,z:90});$f.size(de,K+$nim.aY+'panes',tab.width-aV.height,tab.height+((!version)?(aV.height-4): -2));$f.setpos(de,K+$nim.aY+'panes',0,0);ai=$f.tab.pages(de,K);for(i=1;i<=ai;i++){$f.setstyle(de,K+$nim.aY+'page'+i+$nim.aY+'caption','z-index',6);}tab=$f.getcoords(de,K+$nim.aY+'panes');$f.translate(de,K+$nim.aY+'pages',{x:(tab.width)+'px',y:(-aV.height+2)+'px',z:'0px'});$f.setstyle(de,K+$nim.aY+'pages','z-index',6);$f.size(de,K+$nim.aY+'pages',tab.height,aV.height);$f.size(de,K+$nim.aY+'clip',tab.height,aV.height);break;case 'right-bottom':aV=$f.getcoords(de,K);aV.height=$nim.cn.dialog.tab_height;tab=$f.getcoords(de,K);tab.height-=hgtAdj;$f.rotate(de,K+$nim.aY+'left',{x:180,y:0,z:0});$f.rotate(de,K+$nim.aY+'right',{x:180,y:0,z:0});$f.origin(de,K+$nim.aY+'pages',aV.height+'px '+aV.height+'px 0');$f.rotate(de,K+$nim.aY+'pages',{x:0,y:180,z: -90});$f.scale(de,K+$nim.aY+'pages',{x:0.9,y:1});$f.size(de,K+$nim.aY+'panes',tab.width-aV.height,tab.height+((!version)?(aV.height-4): -2));$f.setpos(de,K+$nim.aY+'panes',0,0);ai=$f.tab.pages(de,K);for(i=1;i<=ai;i++){$f.rotate(de,K+$nim.aY+'page'+i+$nim.aY+'caption',{x:0,y:180,z:0});$f.setstyle(de,K+$nim.aY+'page'+i+$nim.aY+'caption','z-index',6);}tab=$f.getcoords(de,K+$nim.aY+'panes');$f.translate(de,K+$nim.aY+'pages',{x:(tab.width-aV.height)+'px',y:(tab.height-(2*aV.height)+8)+'px',z:'0px'});$f.setstyle(de,K+$nim.aY+'pages','z-index',6);$f.size(de,K+$nim.aY+'pages',tab.height,aV.height);$f.size(de,K+$nim.aY+'clip',tab.height,aV.height);break;default:break;}}},Add:function(de,K,pgCaption){'use strict';var newInst,freeName,newPg= -1,tabNme=$nim.instN(de,K),mnuNme=$nim.instN(de,K,"items"),panesNme=$nim.instN(de,K,"panes"),pagesName=$nim.instN(de,K,"pages"),blankMenu=$nim.instN(de,K,"page#x#"+$nim.aY+'div'),blankPane=$nim.instN(de,K,"page#x#"+$nim.aY+'body'),ai,orient,tabElem=$nim.G.V(tabNme),tabCont=$nim.G.V(tabNme+$nim.aY+'container'),tabPages=$nim.G.V(pagesName);if(tabElem){orient=tabElem.cposition;ai=dA($nim.dE(tabElem.id,"pages"));$f.tab.position(de,K,'top-left');}function dc(elmName){var child;var i,menu=$nim.G.V(elmName),F=menu?menu.childNodes.length:0;if(menu.childNodes.length>0){for(i=0;i<F;i++){child=menu.childNodes[i];if(!$nim.undef(child.getAttribute)){if($nim.dE(child.id,"pages")!==null){$nim.df(child.id,"pages",ai);}if(child.childNodes.length>0){dc(child.id);}}}}};if(tabElem){newPg=1;freeName=$nim.instN(de,K,"page"+newPg);while($nim.G.V(freeName)){newPg++;freeName=$nim.instN(de,K,"page"+newPg);}var repl='"',srch='"!',elemMenu,bk;newInst=$nim.instN(de,K,"page"+newPg);elemMenu=$nim.G.V('!'+blankMenu);bk=elemMenu.outerHTML;var lastMenu=$nim.instN(de,K,"page"+ai);bk=$nim.aX(srch,repl,bk);bk=$nim.aX({'#x#':newPg,'#new.caption#':pgCaption,'#element.active#':'','display: none;':'','display:none;':''},null,bk);$nim.ax.insertAfter(bk,lastMenu+'.div');$nim.ax.bG(newInst,"tab");$nim.G.copyBackColor(panesNme,newInst,false);$nim.G.V(newInst).onmousedown=function(e){$nim.by.tabClicked(e);};newInst+=$nim.aY+'caption';$nim.G.V(newInst).onmousedown=function(e){$nim.by.tabClicked(e);};newInst=$nim.instN(de,K,"page"+newPg+$nim.aY+'body');var elemPane=$nim.G.V('!'+blankPane);if(elemPane){var bH=elemPane.outerHTML;var lastPane=$nim.instN(de,K,"page"+ai+$nim.aY+'body');bH=$nim.aX({srch:repl,'#x#':newPg,'#new.caption#':pgCaption,'#element.active#':'','display: none;':'','display:none;':''},null,bH);}$nim.ax.insertAfter(bH,lastPane);$nim.ax.bG(newInst,"tab");ai++;$nim.df(tabElem.id,"pages",ai);$nim.df(tabCont.id,"pages",ai);$nim.df(tabPages.id,"pages",ai);dc(mnuNme);dc(panesNme);$f.tab.position(de,K,orient);}return newPg;},Remove:function(de,K,index){'use strict';function dc(elmName){var i,child,menu=$nim.G.V(elmName),F=menu?menu.childNodes.length:0;if(F>0){for(i=0;i<F;i++){child=menu.childNodes[i];if(!$nim.undef(child.getAttribute)){if($nim.dE(child.id,"pages")!==null){$nim.df(child.id,"pages",ai);}if(child.childNodes.length>0){dc(child.id);}}}}};if(index>1){K=K||"";var au=$nim.instN(de,K,"page"+index+'.div'),cc=$nim.G.V(au);if(cc){cc.parentNode.removeChild(cc);}au=$nim.instN(de,K,"page"+index+$nim.aY+'body');cc=$nim.G.V(au);if(cc){cc.parentNode.removeChild(cc);}var tabNme=$nim.instN(de,K),tabElem=$nim.G.V(tabNme),ai=dA($nim.dE(tabElem.id,"pages"));ai=(ai>1)?(ai-1):1;var mnuNme=$nim.instN(de,K,"items"),panesNme=$nim.instN(de,K,"panes"),pagesName=$nim.instN(de,K,"panes"),tabCont=$nim.G.V(tabNme+$nim.aY+'container'),tabPages=$nim.G.V(pagesName);if(tabElem){$nim.df(tabElem.id,"pages",ai.toString());}if(tabCont){$nim.df(tabCont.id,"pages",ai.toString());}if(tabPages){$nim.df(tabPages.id,"pages",ai.toString());}dc(mnuNme);dc(panesNme);}}},List:{Get:function(name){name=name.toLowerCase();if(App&&App.Code.Lists&&App.Code.Lists[name]){return App.Code.Lists[name];}else return[];},item:function(de,K,index,bE){K=K||"";index=$nim.undef(index)? -1:index;bE=bE||"";var aM,dq=[],au=$nim.instN(de,K),cc=$nim.G.V(au+$nim.bJ+"items");if(cc){var ctype=cc.getAttribute('type')||cc.ctype;switch(ctype){case 'list':dq=cc.options||[];break;default:if(bE){cc=$nim.G.V(au+$nim.bJ+'item'+$nim.bJ+index+$nim.bJ+bE);return cc;}else{if(index.toString().indexOf('-')> -1){cc=$nim.G.V(au+$nim.bJ+'item'+$nim.bJ+index);return cc;}else{dq=cc.childNodes||[];}}break;}if(dq.length>0&&dq[index]){cc=dq[index];}}dq=null;return cc;},AddList:function(de,K,inList,bClear){K=K||"";var x,item,newId,au=$nim.bName(de,K),cc=$nim.G.V(au+$nim.bJ+"items"),html='',ctype,cR,ck;if(App&&App.Code.Lists&&App.Code.Lists[inList]){item=App.Code.Lists[inList];}else{if(Array.isArray(inList)){item=inList;}else{item=(inList.split(',').length>0)?inList.split(','):[inList];}}if(cc){ctype=cc.getAttribute('type')||cc.ctype;if(bClear){cc.innerHTML="";}if(item.length){for(x=0;x<item.length;x++){switch(ctype){case 'treeview':if(item[x].parent){newId=$f.list.addchild(item[x].form,item[x].control,item[x].parent.id,item[x]);}else{newId=$f.list.addchild(item[x].form,item[x].control,'',item[x]);}item[x].id=newId;break;case 'list':cR=0;ck=au+$nim.bJ+"item"+$nim.bJ+cR+$nim.bJ+'caption';while($nim.G.V(ck)){cR++;ck=au+$nim.bJ+"item"+$nim.bJ+cR+$nim.bJ+'caption';}$nim.G.addOption(null,cc,ck,cR,item[x].caption,item[x].value);break;default:if($nim.isobj(item[x])){if(!$nim.undef(item[x])){if(!$nim.G.DoesItemExist(ctype,cc,item[x].value)){cR=x;ck=au+$nim.bJ+"item"+$nim.bJ+cR+$nim.bJ+'caption';while($nim.G.V(ck)){cR++;ck=au+$nim.bJ+"item"+$nim.bJ+cR+$nim.bJ+'caption';}if(!item[x].image){item[x].image='media/img_missing.png';}html+=$nim.HTML[ctype+"-li"];}}}break;}html=$nim.aX({'#index#':x,'#item.value#':item[x].value,'#item.image#':item[x].image,'#item.list#':item[x].list||item[x].caption},null,html);}html=$nim.aX({'#element.name#':au,'#element.rowheight#':dA(cc.getAttribute('rowheight'))+'px'},null,html);if(html!==''){cc.innerHTML+=html;}}}},AddChild:function(de,K,pitem,item,value){pitem=pitem?pitem:null;if(pitem){K=K||"";var ret,au=$nim.instN(de,K),cc=$nim.G.V(au+$nim.bJ+"items"),html='',x,F,nodeKey,ctype,cR,ck;if(cc){ctype=cc.getAttribute('type')||cc.ctype;switch(ctype){case 'treeview':var ag=$nim.G.V(au+$nim.bJ+"item."+pitem);var gelem=$nim.G.V(au+$nim.bJ+"item."+pitem+".group");if(ag){$nim.df(ag.id,"state","");if(!gelem){var ielem=$nim.G.V(au+$nim.bJ+"item."+pitem+".folder");if(ielem){ielem.style['visibility']='visible';}$f["class"].swap(de,K+$nim.bJ+"item."+pitem+".image","folder_item","folder_close");html=$nim.HTML[ctype+"-group"];html=$nim.aX({'#index#':pitem,'#element.name#':au},null,html);ag.innerHTML+=html;gelem=$nim.G.V(au+$nim.bJ+"item."+pitem+".group");}html='';if($nim.isobj(item)){if(!$nim.undef(item.length)){F=item.length;for(x=0;x<F;x++){if(!$nim.G.DoesItemExist(ctype,cc,item[cR].value)&& !$nim.G.DoesItemExist(ctype,cc,value)){cR=0;nodeKey=pitem+"-"+cR;ck=au+$nim.bJ+"item"+$nim.bJ+nodeKey+$nim.bJ+'caption';while($nim.G.V(ck)){cR++;nodeKey=pitem+"-"+cR;ck=au+$nim.bJ+"item"+$nim.bJ+nodeKey+$nim.bJ+'caption';}html+=$nim.HTML[ctype+"-li"];html=$nim.aX({'#index#':nodeKey,'#item.value#':item[cR].value,'#item.image#':item[cR].image,'#item.list#':item[cR].list},null,html);}}}else{if(!$nim.G.DoesItemExist(ctype,cc,item.value)&& !$nim.G.DoesItemExist(ctype,cc,value)){cR=0;nodeKey=pitem+"-"+cR;ck=au+$nim.bJ+"item"+$nim.bJ+nodeKey+$nim.bJ+'caption';while($nim.G.V(ck)){cR++;nodeKey=pitem+"-"+cR;ck=au+$nim.bJ+"item"+$nim.bJ+nodeKey+$nim.bJ+'caption';}html=$nim.HTML[ctype+"-li"];html=$nim.aX({'#index#':nodeKey,'#item.value#':item.value,'#item.image#':item.image,'#item.list#':item.list},null,html);}}}html=$nim.aX({'<dlg.form>':de,'#element.name#':au,'#element.rowheight#':dA(cc.getAttribute('rowheight'))+'px'},null,html);gelem.innerHTML+=html;}break;default:break;}}ret=nodeKey;}else{ret=$nim.by.List.Add(de,K,item,value);}return ret;},Insert:function(de,K,index,item,value){K=K||"";var au=$nim.instN(de,K),before=$nim.by.List.item(de,K,index),cc=$nim.G.V(au+$nim.bJ+"items"),x,F,nodeKey,ctype,cR,ck;if(cc){ctype=cc.getAttribute('type')||cc.ctype;switch(ctype){case 'list':if($nim.isobj(item)){F=item.length;for(x=0;x<F;x++){if(!$nim.G.DoesItemExist(ctype,cc,item[x].value)){cR=0;nodeKey=cR.toString();ck=au+$nim.bJ+"item"+$nim.bJ+cR+$nim.bJ+'caption';while($nim.G.V(ck)){cR++;nodeKey=cR.toString();ck=au+$nim.bJ+"item"+$nim.bJ+cR+$nim.bJ+'caption';}$nim.G.addOption(before,cc,ck,cR,item[x].caption,item[x].value);cc.setAttribute("lastitem",ck);}}}else{if(!$nim.G.DoesItemExist(ctype,cc,value)){cR=0;nodeKey=cR.toString();ck=au+$nim.bJ+"item"+$nim.bJ+cR+$nim.bJ+'caption';while($nim.G.V(ck)){cR++;nodeKey=cR.toString();ck=au+$nim.bJ+"item"+$nim.bJ+cR+$nim.bJ+'caption';}$nim.G.addOption(before,cc,ck,cR,item,value);}}break;default:break;}}return nodeKey;},Add:function(de,K,item,value){K=K||"";var cap,au=$nim.instN(de,K),cc=$nim.G.V(au+$nim.bJ+"items"),html='',x,F,nodeKey,ctype,cR,ck;if(cc){ctype=cc.getAttribute('type')||cc.ctype;switch(ctype){case 'list':value=value?value:item.toLowerCase();if($nim.isobj(item)){for(x=0,F=item.length;x<F;x++){if(!$nim.G.DoesItemExist(ctype,cc,item[x].value)){cR=0;nodeKey=cR.toString();ck=au+$nim.bJ+"item"+$nim.bJ+cR+$nim.bJ+'caption';while($nim.G.V(ck)){cR++;nodeKey=cR.toString();ck=au+$nim.bJ+"item"+$nim.bJ+cR+$nim.bJ+'caption';}$nim.G.addOption(null,cc,ck,cR,item[x].caption,item[x].value);}}}else{if(!$nim.G.DoesItemExist(ctype,cc,value)){cR=0;nodeKey=cR.toString();ck=au+$nim.bJ+"item"+$nim.bJ+cR+$nim.bJ+'caption';while($nim.G.V(ck)){cR++;nodeKey=cR.toString();ck=au+$nim.bJ+"item"+$nim.bJ+cR+$nim.bJ+'caption';}$nim.G.addOption(null,cc,ck,cR,item,value);}}break;default:if($nim.isobj(item)){if(!$nim.undef(item.length)){for(x=0,F=item.length;x<F;x++){if(!$nim.G.DoesItemExist(ctype,cc,item[x].value)&& !$nim.G.DoesItemExist(ctype,cc,value)){cR=x;nodeKey=cR.toString();ck=au+$nim.bJ+"item"+$nim.bJ+cR+$nim.bJ+'caption';while($nim.G.V(ck)){cR++;nodeKey=cR.toString();ck=au+$nim.bJ+"item"+$nim.bJ+cR+$nim.bJ+'caption';}if(!item[x].image){item[x].image='media/img_missing.png';}html+=$nim.HTML[ctype+"-li"];html=$nim.aX({'#index#':cR,'#item.image#':item[cR].image},null,html);cap=item[cR].list||item[cR].caption;if(!$nim.undef(cap)){html=$nim.aX("#item.list#",cap,html);}if(!$nim.undef(item[cR].value)){html=$nim.aX("#item.value#",item[cR].value,html);}if(!$nim.undef(item[cR].checked)){item[cR].checked=item[cR].checked?'checked':'';html=$nim.aX("#item.checked#",item[cR].checked,html);}}}}else{if(!$nim.G.DoesItemExist(ctype,cc,item.value)&& !$nim.G.DoesItemExist(ctype,cc,value)){cR=0;nodeKey=cR.toString();ck=au+$nim.bJ+"item"+$nim.bJ+cR+$nim.bJ+'caption';while($nim.G.V(ck)){cR++;nodeKey=cR.toString();ck=au+$nim.bJ+"item"+$nim.bJ+cR+$nim.bJ+'caption';}if(!item.image){item.image='media/img_missing.png';}html=$nim.HTML[ctype+"-li"];html=$nim.aX({'#index#':cR,'#item.image#':item.image},null,html);cap=item.list||item.caption;if(!$nim.undef(cap)){html=$nim.aX("#item.list#",cap,html);}if(!$nim.undef(item.value)){html=$nim.aX("#item.value#",item.value,html);}if(!$nim.undef(item.checked)){item.checked=item.checked?'checked':'';html=$nim.aX("#item.checked#",item.checked,html);}}}}html=$nim.aX({'#element.name#':au,'#element.rowheight#':dA(cc.getAttribute('rowheight'))+'px'},null,html);cc.innerHTML+=html;cc.setAttribute("lastitem",ck);break;}}return nodeKey;},Remove:function(de,K,index){K=K||"";index=$nim.undef(index)? -1:index;var ctype,dq,au=$nim.instN(de,K),cc=$nim.G.V(au+$nim.bJ+"items");if(cc){ctype=cc.getAttribute('type')||cc.ctype;switch(ctype){case 'list':dq=cc.options||[];if(dq.length>0&&dq[index]){cc.remove(index);}break;default:dq=cc.childNodes||[];if(dq.length>0&&dq[index]){dq[index].remove();}break;}}dq=null;},RemoveSelected:function(de,K){K=K||"";var x,F,ctype,dq,au=$nim.instN(de,K),cc=$nim.G.V(au+$nim.bJ+"items");if(cc){ctype=cc.getAttribute('type')||cc.ctype;switch(ctype){case 'list':dq=cc.options||[];var olen=(dq.length-1);for(x=0,F=dq.length;x<F;x++){if(dq[olen-x].selected){cc.remove(olen-x);}}break;default:dq=cc.childNodes||[];for(x=0,F=dq.length;x<F;x++){if(dq[olen-x].getAttribute('selected')=='true'){dq[olen-x].remove();}}break;}}dq=null;},Clear:function(de,K){K=K||"";var au=$nim.instN(de,K),cc=$nim.G.V(au+$nim.bJ+"items");if(cc){cc.innerHTML="";cc.setAttribute("lastitem",'');}},ClearNode:function(de,K,pitem){pitem=pitem?pitem:null;if(pitem){K=K||"";var au=$nim.instN(de,K),html='',ctype;var ag=$nim.G.V(au+$nim.bJ+"item."+pitem);var gelem=$nim.G.V(au+$nim.bJ+"item."+pitem+".group");if(ag){$nim.df(ag.id,"state","");if(!gelem){var ielem=$nim.G.V(au+$nim.bJ+"item."+pitem+".folder");if(ielem){ielem.style['visibility']='visible';}$f["class"].swap(de,K+$nim.bJ+"item."+pitem+".image","folder_item","folder_close");html=$nim.HTML[ctype+"-group"];html=$nim.aX({'#index#':pitem,'#element.name#':au},null,html);ag.innerHTML+=html;}else{gelem.innerHTML='';}}}},ListIndex:function(de,K){K=K||"";var ctype,ret= -1,au=$nim.instN(de,K),cc=$nim.G.V(au+$nim.bJ+"items");if(cc){ctype=cc.getAttribute('type')||cc.ctype;switch(ctype){case 'list':ret=cc.options.selectedIndex;break;default:ret=cc.getAttribute('selectedIndex');break;}}return ret;},ListCount:function(de,K){K=K||"";var ctype,ret=0,au=$nim.instN(de,K),cc=$nim.G.V(au+$nim.bJ+"items");if(cc){ctype=cc.getAttribute('type')||cc.ctype;switch(ctype){case 'list':ret=cc.options.length;break;default:ret=cc.childNodes.length;break;}}return ret;},Selected:function(de,K,index){K=K||"";index=$nim.undef(index)? -1:index;var ctype,node,dq,ret=false,au=$nim.instN(de,K),cc=$nim.G.V(au+$nim.bJ+"items");if(cc){ctype=cc.getAttribute('type')||cc.ctype;switch(ctype){case 'treeview':node=$nim.G.Search(cc,'key',index)||$nim.G.Search(cc,'value',index);if(node){ret=node.getAttribute('selected');}break;case 'list':dq=cc.options||[];if(dq.length>0&&dq[index]){ret=dq[index].selected;}break;default:dq=cc.childNodes||[];if(dq.length>0&&dq[index]){ret=dq[index].getAttribute('selected');}break;}}dq=null;return ret;},SetSelected:function(de,K,index,value){K=K||"";index=$nim.undef(index)? -1:index;var ctype,node,dq,ret=false,au=$nim.instN(de,K),cc=$nim.G.V(au+$nim.bJ+"items");if(cc){ctype=cc.getAttribute('type')||cc.ctype;switch(ctype){case 'treeview':node=$nim.G.Search(cc,'key',index)||$nim.G.Search(cc,'value',index);if(node){node.setAttribute('selected',value);}break;case 'list':dq=cc.options||[];if(index>=0&&index<dq.length){dq[index].selected=value;}break;default:dq=cc.childNodes||[];if(index>=0&&index<dq.length){var bq=dq[index].id.resolveName(),base=bq.Control+"."+bq.Component+"."+bq.ItemName,check=$f.cc(bq.Form,base+".check")||{};if(check){check.checked=value;}else{dq[index].setAttribute('selected',value);}}break;}}dq=null;},GetAllSelected:function(de,K,blFull){K=K||"";var x,ctype,dq,ret=[],au=$nim.instN(de,K),cc=$nim.G.V(au+$nim.bJ+"items");if(cc){ctype=cc.getAttribute('type')||cc.ctype;switch(ctype){case 'list':dq=cc.options||[];break;default:dq=cc.childNodes||[];break;}for(x=0;x<dq.length;x++){switch(ctype){case 'list':if(dq[x].selected){ret.push('true');}else{ret.push('false');}break;default:var bq=dq[x].id.resolveName(),base=bq.Control+"."+bq.Component+"."+bq.ItemName,check=$f.cc(bq.Form,base+".check")||{};if(check){if(check.checked||blFull)ret.push(check.checked);}else{if(dq[x].getAttribute('selected')=='true'||blFull){ret.push((dq[x].getAttribute('selected')=='true'));}}break;}}}dq=null;return ret;},GetAllValues:function(de,K,blFull){K=K||"";var x,ctype,dq,ret=[],au=$nim.instN(de,K),cc=$nim.G.V(au+$nim.bJ+"items");if(cc){ctype=cc.getAttribute('type')||cc.ctype;switch(ctype){case 'list':dq=cc.options||[];break;default:dq=cc.childNodes||[];break;}for(x=0;x<dq.length;x++){switch(ctype){case 'list':if(dq[x].selected||blFull){ret.push(dq[x].value);}break;default:var bq=dq[x].id.resolveName(),base=bq.Control+"."+bq.Component+"."+bq.ItemName,check=$f.cc(bq.Form,base+".check")||{};if(check.checked||dq[x].getAttribute('selected')=='true'||blFull){ret.push(dq[x].getAttribute('value'));}break;}}}dq=null;return ret;},GetAllChecked:function(de,K,blFull){K=K||"";var x,ctype,dq,ret=[],au=$nim.instN(de,K),cc=$nim.G.V(au+$nim.bJ+"items");if(cc){ctype=cc.getAttribute('type')||cc.ctype;switch(ctype){case 'list':dq=cc.options||[];break;default:dq=cc.childNodes||[];break;}for(x=0;x<dq.length;x++){switch(ctype){case 'list':if(dq[x].checked||blFull){ret.push('true');}else{ret.push('false');}break;default:var bq=dq[x].id.resolveName(),base=bq.Control+"."+bq.Component+"."+bq.ItemName,check=$f.cc(bq.Form,base+".check")||{};if(check.checked||blFull){ret.push(check.checked);}break;}}}dq=null;return ret;},GetAllCaptions:function(de,K,blFull){K=K||"";var x,ctype,dq,ret=[],au=$nim.instN(de,K),cc=$nim.G.V(au+$nim.bJ+"items");if(cc){ctype=cc.getAttribute('type')||cc.ctype;switch(ctype){case 'list':dq=cc.options||[];break;default:dq=cc.childNodes||[];break;}for(x=0;x<dq.length;x++){switch(ctype){case 'list':if(dq[x].selected||blFull){ret.push(dq[x].innerText);}break;default:var bq=dq[x].id.resolveName(),base=bq.Control+"."+bq.Component+"."+bq.ItemName,check=$f.cc(bq.Form,base+".check")||{},label=$f.cc(bq.Form,base+".caption");if(label){if(check.checked||dq[x].getAttribute('selected')=='true'||blFull){ret.push(label.innerText);}}break;}}}dq=null;return ret;},GetText:function(de,K,index){K=K||"";index=$nim.undef(index)? -1:index;var ctype,dq,ret=false,au=$nim.instN(de,K),cc=$nim.G.V(au+$nim.bJ+"items");if(cc){ctype=cc.getAttribute('type')||cc.ctype;switch(ctype){case 'treeview':ret='';break;case 'list':dq=cc.options||[];if(dq.length>0&&dq[index]){if(dq.length>0&&dq[index]){ret=dq[index].innerText;}}break;default:dq=cc.childNodes||[];if(dq.length>0&&dq[index]){ret=dq[index].innerText;}break;}}dq=null;return ret||'';},SetText:function(de,K,index,caption,value){K=K||"";index=$nim.undef(index)? -1:index;var ctype,dq,ret=false,au=$nim.instN(de,K),cc=$nim.G.V(au+$nim.bJ+"items");if(cc){ctype=cc.getAttribute('type')||cc.ctype;switch(ctype){case 'treeview':ret='';break;case 'list':dq=cc.options||[];if(dq.length>0&&dq[index]){if(caption){$nim.G.i18n(dq[index],'innerText',caption);}if(value){dq[index].value=value;}}break;default:dq=cc.childNodes||[];if(dq.length>0&&dq[index]){if(caption){$nim.G.i18n(dq[index],'innerText',caption);}if(value){dq[index].value=value;}}break;}}dq=null;},GetValue:function(de,K,index){K=K||"";index=$nim.undef(index)? -1:index;var ctype,node,dq,ret=false,au=$nim.instN(de,K),cc=$nim.G.V(au+$nim.bJ+"items");if(cc){ctype=cc.getAttribute('type')||cc.ctype;switch(ctype){case 'treeview':node=$nim.G.Search(cc,'key',index)||$nim.G.Search(cc,'value',index);if(node){ret=node.getAttribute('value');}break;case 'list':dq=cc.options||[];if(dq.length>0&&dq[index]){ret=dq[index].value;}break;default:dq=cc.childNodes||[];if(dq.length>0&&dq[index]){ret=dq[index].value;}break;}}dq=null;return ret||'';},GetItemData:function(de,K,index){K=K||"";index=$nim.undef(index)? -1:index;var ctype,node,dq,ret='',au=$nim.instN(de,K),cc=$nim.G.V(au+$nim.bJ+"items");if(cc){ctype=cc.getAttribute('type')||cc.ctype;switch(ctype){case 'treeview':node=$nim.G.Search(cc,'key',index)||$nim.G.Search(cc,'value',index);if(node){ret=node.getAttribute('itemData');}break;case 'list':dq=cc.options||[];if(dq.length>0&&dq[index]){ret=dq[index].getAttribute('itemData');}break;default:dq=cc.childNodes||[];if(dq.length>0&&dq[index]){ret=dq[index].getAttribute('itemData');}break;}}dq=null;return ret||'';},SetItemData:function(de,K,index,idata,value){K=K||"";index=$nim.undef(index)? -1:index;var ctype,node,dq,ret=false,au=$nim.instN(de,K),cc=$nim.G.V(au+$nim.bJ+"items");if(cc){ctype=cc.getAttribute('type')||cc.ctype;switch(ctype){case 'treeview':node=$nim.G.Search(cc,'key',index)||$nim.G.Search(cc,'value',index);if(node){node.setAttribute('itemData',idata);if(!$nim.undef(value))node.setAttribute('value',value);}break;case 'list':dq=cc.options||[];if(dq.length>0&&dq[index]){dq[index].setAttribute('itemData',idata);dq[index].value=$nim.undef(value)?dq[index].value:value;}break;default:dq=cc.childNodes||[];if(dq.length>0&&dq[index]){dq[index].setAttribute('itemData',idata);dq[index].value=$nim.undef(value)?dq[index].value:value;}break;}}dq=null;return ret;},SelectIndex:function(de,K,index){de=de||"";K=K||"";index=$nim.undef(index)? -1:index;if(de&&K){var cc,prev= -1,e,af,lelem,lindex,grp,lgrp,x,ctype,dq,au=$nim.instN(de,K),list=$nim.G.V(au);if(typeof index=='number'){cc=$nim.G.V(au+$nim.bJ+"items");}else{if(index.indexOf('-')== -1){cc=$nim.G.V(au+$nim.bJ+"items");grp='';}else{grp=index.split('-');index=grp[grp.length-1];grp.splice(grp.length-1,1);grp=grp.join('-');cc=$nim.G.V(au+$nim.bJ+"item"+$nim.bJ+grp+$nim.bJ+"group");}}if(cc){ctype=cc.getAttribute('type')||cc.ctype;switch(ctype){case 'list':prev=cc.selectedIndex||0;dq=cc.options||[];if(dq.length>0&&dq[index]){cc.selectedIndex=index;}break;case 'treeview':lindex=list.getAttribute('last');if(lindex&&lindex!==''){if(lindex.indexOf('-')== -1){lelem=$nim.G.V(au+$nim.bJ+"items");lgrp='';}else{lgrp=lindex.split('-');lindex=lgrp[lgrp.length-1];lgrp.splice(lgrp.length-1,1);lgrp=lgrp.join('-');lelem=$nim.G.V(au+$nim.bJ+"item"+$nim.bJ+lgrp+$nim.bJ+"group");}if(lelem){dq=lelem.childNodes;if(list.getAttribute('multiple')!='true'){for(x=0;x<dq.length;x++){dq[x].setAttribute('selected','false');dq[x].childNodes[0].className=$nim.aX('item_select','',dq[x].childNodes[0].className);dq[x].childNodes[0].className=$nim.aX('  ',' ',dq[x].childNodes[0].className);}}}}dq=cc.childNodes||[];if(list.getAttribute('multiple')!='true'){for(x=0;x<dq.length;x++){dq[x].setAttribute('selected','false');dq[x].childNodes[0].className=$nim.aX('item_select','',dq[x].childNodes[0].className);dq[x].childNodes[0].className=$nim.aX('  ',' ',dq[x].childNodes[0].className);}}if(dq.length>0&&dq[index]){dq[index].setAttribute('selected','true');dq[index].childNodes[0].className+=' item_select';list.setAttribute('selectedIndex',index);if(grp){grp=grp+'-'+index;}else{grp=index;}list.setAttribute('last',grp);}break;case 'check':break;default:prev=parseInt(cc.getAttribute('selectedIndex'))||0;dq=cc.childNodes||[];if(dq.length>0&&dq[index]){if(cc.getAttribute('multiple')!='true'){for(x=0;x<dq.length;x++){dq[x].setAttribute('selected','false');dq[x].className=$nim.aX('item_select','',dq[x].className);dq[x].className=$nim.aX('  ',' ',dq[x].className);}}dq[index].setAttribute('selected','true');dq[index].className+=' item_select';cc.setAttribute('selectedIndex',index);}break;}af=$f.af(de,K);if(af.onchange&&index!=prev){e=$nim.G.buildEvent('system',af);af.onchange(e);}}}dq=null;},SelectCheck:function(de,K,index,value){de=de||"";K=K||"";value=$nim.undef(value)?true:value;index=$nim.undef(index)? -1:index;if(de&&K){var ctype,dq,prev= -1,au=$nim.instN(de,K),cc=$nim.G.V(au+$nim.bJ+"items");if(cc){ctype=cc.getAttribute('type')||cc.ctype;switch(ctype){case 'treeview':break;case 'list':dq=cc.options||[];break;default:dq=cc.childNodes||[];break;}if(dq.length>0&&dq[index]){switch(ctype){case 'treeview':break;case 'list':if(typeof(dq[index].checked)=='boolean'){dq[index].checked=value;}if(typeof(dq[index].selected)=='boolean'){dq[index].selected=value;}break;default:var bq=dq[index].id.resolveName(),base=bq.Control+"."+bq.Component+"."+bq.ItemName,check=$f.cc(bq.Form,base+".check");if(check&& !$nim.undef(check.checked)){check.checked=value;}break;}}}}dq=null;},SelectValue:function(de,K,value){de=de||"";K=K||"";if(de&&K){var x,af,ctype,prev= -1,dq,e,index,ret=false,au=$nim.instN(de,K),cc=$nim.G.V(au+$nim.bJ+"items");if(cc){ctype=cc.getAttribute('type')||cc.ctype;switch(ctype){case 'treeview':ret='';break;case 'list':prev=cc.selectedIndex||0;dq=cc.options||[];for(x=0;x<dq.length;x++){if(value==dq[x].value){dq.selectedIndex=x;index=x;break;}}break;case 'check':break;default:prev=parseInt(cc.getAttribute('selectedIndex'))||0;dq=cc.childNodes||[];if(cc.getAttribute('multiple')!='true'){for(x=0;x<dq.length;x++){dq[x].setAttribute('selected','false');dq[x].className=$nim.aX('item_select','',dq[x].className);dq[x].className=$nim.aX('  ',' ',dq[x].className);}}for(x=0;x<dq.length;x++){if(value==dq[x].getAttribute('value')){dq[x].setAttribute('selected','true');dq[x].className+=' item_select';cc.setAttribute('selectedIndex',x);index=x;break;}}break;}af=$f.af(de,K);if(af.onchange&&index!=prev){e=$nim.G.buildEvent('system',af);af.onchange(e);}}}dq=null;return ret;},SelectCaption:function(de,K,value){de=de||"";K=K||"";if(de&&K){var x,ctype,dq,ret=false,au=$nim.instN(de,K),cc=$nim.G.V(au+$nim.bJ+"items");if(cc){ctype=cc.getAttribute('type')||cc.ctype;switch(ctype){case 'treeview':ret='';break;case 'list':dq=cc.options||[];for(x=0;x<dq.length;x++){if(dq[x]&&dq[x].innerText){if(value.toLowerCase()==dq[x].innerText.toLowerCase()){dq.selectedIndex=x;break;}}}break;default:dq=cc.childNodes||[];if(cc.getAttribute('multiple')!='true'){for(x=0;x<dq.length;x++){dq[x].setAttribute('selected','false');dq[x].className=$nim.aX('item_select','',dq[x].className);dq[x].className=$nim.aX('  ',' ',dq[x].className);}}for(x=0;x<dq.length;x++){if(dq[x]&&dq[x].innerText){if(value.toLowerCase()==dq[x].innerText.toLowerCase()){dq[x].setAttribute('selected','true');dq[x].className+=' item_select';cc.setAttribute('selectedIndex',x);break;}}}break;}}}dq=null;return ret;},SelectedItem:function(de,K){de=de||"";K=K||"";if(de&&K){var sel,ctype,node,dq,ret="",au=$nim.instN(de,K),cc=$nim.G.V(au+$nim.bJ+"items");if(cc&&cc.options.selectedIndex> -1){ctype=cc.getAttribute('type')||cc.ctype;switch(ctype){case 'treeview':node=$nim.G.Search(cc,'selected',true);if(node){bq=node.id.resolveName();ret=bq.ItemName;}break;case 'list':dq=cc.options||[];if(dq.selectedIndex>=0){ret=dq[dq.selectedIndex].value;}break;default:dq=cc.childNodes||[];sel=cc.getAttribute('selectedIndex');if(sel>=0&&sel<dq.length){ret=dq[sel].getAttribute('value');}break;}}}dq=null;return ret;},SelectedCaption:function(de,K){de=de||"";K=K||"";if(de&&K){var sel,ctype,node,dq,ret="",au=$nim.instN(de,K),cc=$nim.G.V(au+$nim.bJ+"items");if(cc&&cc.options&&cc.options.selectedIndex> -1){ctype=cc.getAttribute('type')||cc.ctype;switch(ctype){case 'treeview':node=$nim.G.Search(cc,'selected',true);if(node){bq=node.id.resolveName();cc=$nim.G.V(au+$nim.bJ+"item"+$nim.bJ+bq.ItemName+".caption");if(cc)ret=cc.innerText;}break;case 'list':dq=cc.options||[];if(dq.selectedIndex>=0){ret=dq[dq.selectedIndex].innerText;}break;default:dq=cc.childNodes||[];sel=cc.getAttribute('selectedIndex');if(sel>=0&&sel<dq.length){ret=dq[sel].getAttribute('value');}break;}}}dq=null;return ret;},GetItemName:function(de,K,srch){K=K||"";var bq,ctype,node,ret="",au=$nim.instN(de,K),cc=$nim.G.V(au+$nim.bJ+"items");if(cc){ctype=cc.getAttribute('type')||cc.ctype;switch(ctype){case 'treeview':node=$nim.G.Search(cc,'key',srch)||$nim.G.Search(cc,'value',srch);if(node){bq=node.id.resolveName();ret=bq.ItemName;}break;default:break;}}return ret;},GetItemParent:function(de,K,srch){K=K||"";var ctype,node,ret="",au=$nim.instN(de,K),cc=$nim.G.V(au+$nim.bJ+"items");if(cc){ctype=cc.getAttribute('type')||cc.ctype;switch(ctype){case 'treeview':node=$nim.G.Search(cc,'key',srch)||$nim.G.Search(cc,'value',srch);if(node){if(node.parentNode&&node.parentNode.parentNode){ret=node.parentNode.parentNode.getAttribute('value');}}break;default:break;}}return ret;},GetItemCaption:function(de,K,srch){K=K||"";var ctype,node,ret="",au=$nim.instN(de,K),cc=$nim.G.V(au+$nim.bJ+"items");if(cc){ctype=cc.getAttribute('type')||cc.ctype;switch(ctype){case 'treeview':node=$nim.G.Search(cc,'key',srch)||$nim.G.Search(cc,'value',srch);if(node){cc=$nim.G.V(node.id+".caption");if(cc)ret=cc.innerText;}break;default:break;}}return ret;},Exists:function(de,K,srch){K=K||"";var x,F,dq,node,ctype,exists=false,au=$nim.instN(de,K),cc=$nim.G.V(au+$nim.bJ+"items");if(cc){ctype=cc.getAttribute('type')||cc.ctype;switch(ctype){case 'treeview':node=$nim.G.Search(cc,'key',srch)||$nim.G.Search(cc,'value',srch);if(node){exists=true;}break;case 'list':dq=cc.options||[];for(x=0,F=dq.length;x<F;x++){if(dq[x].value==srch||dq[x].text==srch){exists=true;break;}}break;default:dq=cc.childNodes||[];for(x=0;x<dq.length;x++){if(srch==dq[x].getAttribute('value')){exists=true;break;}}break;}}dq=null;return exists;},Find:function(de,K,srch){K=K||"";var x,F,dq,node,ctype,exists= -1,au=$nim.instN(de,K),cc=$nim.G.V(au+$nim.bJ+"items");if(cc){ctype=cc.getAttribute('type')||cc.ctype;switch(ctype){case 'treeview':node=$nim.G.Search(cc,'key',srch)||$nim.G.Search(cc,'value',srch);if(node){exists=node.id||true;}break;case 'list':dq=cc.options||[];for(x=0,F=dq.length;x<F;x++){if(dq[x]){if((dq[x].value&&dq[x].value.toLowerCase()==srch.toLowerCase())||(dq[x].text&&dq[x].text.toLowerCase()==srch.toLowerCase())){exists=x;break;}}}break;default:dq=cc.childNodes||[];for(x=0;x<dq.length;x++){if(srch.toLowerCase()==dq[x].getAttribute('value').toLowerCase()){exists=x;break;}}break;}}dq=null;return exists;},FindExact:function(de,K,srch){K=K||"";var x,F,dq,ctype,exists= -1,au=$nim.instN(de,K),cc=$nim.G.V(au+$nim.bJ+"items");if(cc){ctype=cc.getAttribute('type')||cc.ctype;switch(ctype){case 'treeview':node=$nim.G.Search(cc,'key',srch);if(node){exists=node.id||true;}break;case 'list':dq=cc.options||[];for(x=0,F=dq.length;x<F;x++){if(dq[x].value==srch||dq[x].text==srch){exists=x;break;}}break;default:dq=cc.childNodes||[];for(x=0;x<dq.length;x++){if(srch==dq[x].getAttribute('value')){exists=x;break;}}break;}}dq=null;return exists;}},PicClip:{_update:function(de,K){de=de||"";K=K||"";var cc,image,au,styles;var left,right,top,bottom;var pxL,pxT,pxW,pxH,cell,rows,cols;au=$nim.instN(de,K);cc=$nim.G.V(au);image=$nim.G.V(au+$nim.bJ+"image");if(cc&&image){pxW=dA(cc.getAttribute('cellwidth'));cols=dA(cc.getAttribute('cols'));pxH=dA(cc.getAttribute('cellheight'));rows=dA(cc.getAttribute('rows'));cell=dA(cc.getAttribute('cellindex'));cell=cell?cell:0;if(!isNaN(pxW)&& !isNaN(pxW)&& !isNaN(cols)&& !isNaN(rows)){if(cell>=0&&cell<(cols*rows)){pxL=(cell-(Math.floor(cell/cols)*cols))*pxW;pxT=Math.floor(cell/cols)*pxH;left=pxL;top=pxT;styles=[{name:'position',value:'absolute'},{name:'left',value:(-left)+'px'},{name:'top',value:(-top)+'px'},{name:'visibility',value:'visible'}];$f.size(de,K,pxW,pxH);$f.setstyle(de,K+$nim.bJ+"image",styles);$f.setstyle(de,K+$nim.bJ+"div",'overflow','hidden');}}}},Rows:function(de,K,value){de=de||"";K=K||"";var cols,rows,pxH,props,noval=$nim.undef(value);var au,cc,image;au=$nim.instN(de,K);cc=$nim.G.V(au);image=$nim.G.V(au+$nim.bJ+"image");if(cc){if(noval){return dA(cc.getAttribute('rows'));}else if(image){cols=cc.getAttribute('cols');cols=cols?cols:1;rows=value;rows=rows?rows:1;pxH=Math.floor(image.naturalHeight/rows);cc.setAttribute('rows',rows.toString());props=[{name:'cellheight',value:pxH.toString()}];$f.setprop(cc.id.resolveName('form'),cc.id.resolveName('control'),props);$nim.by.PicClip._update(de,K);}}return null;},Cols:function(de,K,value){de=de||"";K=K||"";var cols,rows,pxW,props,noval=$nim.undef(value);var au=$nim.instN(de,K),cc=$nim.G.V(au),image=$nim.G.V(au+$nim.bJ+"image");if(cc){if(noval){return dA(cc.getAttribute('cols'));}else if(image){rows=cc.getAttribute('rows');rows=rows?rows:1;cols=value;cols=cols?cols:1;pxW=Math.floor(image.naturalWidth/cols);cc.setAttribute('cols',cols.toString());props=[{name:'cellwidth',value:pxW.toString()}];$f.setprop(cc.id.resolveName('form'),cc.id.resolveName('control'),props);$nim.by.PicClip._update(de,K);}}return null;},GraphicCell:function(de,K,value){de=de||"";K=K||"";var au=$nim.instN(de,K),noval=$nim.undef(value),cc=$nim.G.V(au);if(cc){if(noval){return dA(cc.getAttribute('cellindex'));}else{var cols=dA(cc.getAttribute('cols')),rows=dA(cc.getAttribute('rows'));if(value>=0&&value<(cols*rows)){cc.setAttribute('cellindex',value);$nim.by.PicClip._update(de,K);}}}return null;},GetCellCount:function(de,K){de=de||"";K=K||"";var w,h,au=$nim.instN(de,K),cc=$nim.G.V(au);if(cc){w=dA(cc.getAttribute('cols'));w=w?w:1;h=dA(cc.getAttribute('rows'));h=h?h:1;return dA(w*h);}},ResetCellSize:function(de,K){de=de||"";K=K||"";var cols,rows,nw,nh,styles,au=$nim.instN(de,K),cc=$nim.G.V(au),image=$nim.G.V(au+$nim.bJ+"image");if(cc&&image){rows=cc.getAttribute('rows');rows=rows?rows:1;cols=cc.getAttribute('cols');cols=cols?cols:1;nw=image.naturalWidth/cols;nh=image.naturalHeight/rows;cc.setAttribute('cellwidth',nw.toString());cc.setAttribute('cellheight',nh.toString());styles=[{name:'width',value:(nw*cols)+'px'},{name:'height',value:(nh*rows)+'px'}];$f.setstyle(cc.id.resolveName('form'),cc.id.resolveName('control')+".image",styles);$nim.by.PicClip._update(de,K);}},SetCellSize:function(de,K,nw,nh){de=de||"";K=K||"";var cols,rows,styles,au=$nim.instN(de,K),cc=$nim.G.V(au),image=$nim.G.V(au+$nim.bJ+"image");if(cc&&image){rows=cc.getAttribute('rows');rows=rows?rows:1;cols=cc.getAttribute('cols');cols=cols?cols:1;cc.setAttribute('cellwidth',nw.toString());cc.setAttribute('cellheight',nh.toString());styles=[{name:'width',value:(nw*cols)+'px'},{name:'height',value:(nh*rows)+'px'}];$f.setstyle(cc.id.resolveName('form'),cc.id.resolveName('control')+".image",styles);$nim.by.PicClip._update(de,K);}},GetImageSize:function(de,K){de=de||"";K=K||"";var cols,rows,nw,nh,styles,au=$nim.instN(de,K),cc=$nim.G.V(au),image=$nim.G.V(au+$nim.bJ+"image");if(cc&&image){return{width:image.naturalWidth,height:image.naturalHeight};}},GetCellSize:function(de,K){de=de||"";K=K||"";var w,h,au=$nim.instN(de,K),cc=$nim.G.V(au);if(cc){w=dA(cc.getAttribute('cellwidth'));w=w?w:1;h=dA(cc.getAttribute('cellheight'));h=h?h:1;return{width:w,height:h};}},GetCellWidth:function(de,K){de=de||"";K=K||"";var au=$nim.instN(de,K),cc=$nim.G.V(au);if(cc){return dA(cc.getAttribute('cellwidth'));}},GetCellHeight:function(de,K){de=de||"";K=K||"";var au=$nim.instN(de,K),cc=$nim.G.V(au);if(cc){return dA(cc.getAttribute('cellheight'));}}}});$nim.aO=cU({Query:function(dlg,af,bE,val){var cdlg,idlg,ret=[];var x,d,wDlg,ctrls,widgets;$k.instance.save();if(dlg=='*'&&af=='*'){for(d=0;d<App.Dialogs.length;d++){cdlg=App.Dialogs[d].resolveName('form');idlg=App.Dialogs[d].resolveName('forminst');if($f.getprop(idlg,'',bE).toLowerCase()==val.toLowerCase()){ret.push(idlg);}ctrls=App.Dialog[cdlg].Controls;widgets=App.Dialog[cdlg].Widgets;for(wDlg in widgets){if($f.getprop(idlg,widgets[wDlg].resolveName('instctrl'),bE).toLowerCase()==val.toLowerCase()){ret.push(widgets[wDlg]);}}for(x=0;x<ctrls.length;x++){if($f.getprop(idlg,ctrls[x],bE).toLowerCase()==val.toLowerCase()){ret.push($f.getinstname(idlg,ctrls[x]));}}}}else if(dlg&&af=='*'){cdlg=dlg.resolveName('form');idlg=dlg.resolveName('forminst');ctrls=App.Dialog[cdlg].Controls;widgets=App.Dialog[cdlg].Widgets;for(wDlg in widgets){if($f.getprop(idlg,widgets[wDlg].resolveName('instctrl'),bE).toLowerCase()==val.toLowerCase()){ret.push(widgets[wDlg]);}}for(x=0;x<ctrls.length;x++){if($f.getprop(idlg,ctrls[x],bE).toLowerCase()==val.toLowerCase()){ret.push($f.getinstname(idlg,ctrls[x]));}}}else if(dlg=='*'){for(d=0;d<App.Dialogs.length;d++){idlg=App.Dialogs[d].resolveName('forminst');if($f.getprop(idlg,af,bE).toLowerCase()==val.toLowerCase()){ret.push(idlg);}}}$k.instance.restore();return ret;},am:function(au){return $nim.G.V(au);},aa:function(cY,af){var ret="";cY=cY||"";af=af||"";if($nim.undef(KERNEL.curApp)||cY.indexOf('app.')> -1){ret=cY;}else{if(cY.indexOf(KERNEL.curApp+$nim.as)== -1){ret=KERNEL.curApp+$nim.as+KERNEL.curAppIndex+$nim.bM;ret+=$nim.bs+$nim.aO.instForm(cY,'');}else{ret=cY.resolveName('appinst')+$nim.bs+$nim.aO.instForm(cY,'');}}if(af!==''){ret+=$nim.aY+af;}return ret;},enumerateName:function(bq){var ret=bq.App;ret+=(bq.AppIndex)?$nim.as+bq.AppIndex+$nim.bM:'';ret+=$nim.bs+bq.Form;ret+=$nim.dP+bq.FormIndex+$nim.cb;ret+=(bq.Control)?$nim.aY+bq.Control:'';ret+=(bq.Component)?$nim.aY+bq.Component:'';return ret;},au:function(cY,af,bq){var ret,retapp="";cY=cY||"";af=af||"";bq=bq||"";var iname=cY.resolveName();if(iname.App){KERNEL.curAppIndex=iname.AppIndex;KERNEL.curName=iname.App;KERNEL.curApp=iname.App;if(iname.Form){KERNEL.formInst=iname.FormIndex;cY=iname.Form;}}else{if(App&&App.Dialog&&App.Dialog[cY]){if(KERNEL.formInst>App.Dialog[cY].count){KERNEL.formInst=App.Dialog[cY].count;}if(App&&KERNEL.curApp!=App.App.name&&App.InstName){$nim.aO.setInstance(App.InstName);}}else{if(KERNEL.formInst){KERNEL.formInst=0;}}}retapp=KERNEL.curApp+$nim.as+KERNEL.curAppIndex+$nim.bM;if($nim.undef(KERNEL.curApp)){ret=cY;}else{ret=retapp+$nim.bs+$nim.aO.instForm(cY,'');}if(iname.Control){if(ret.indexOf('.'+iname.Control)== -1)ret+=$nim.aY+iname.Control;}ret+=(iname.Component)?$nim.aY+iname.Component:'';ret+=(af)?$nim.aY+af:'';ret=ret.toLowerCase();if(($nim.G.V(ret)===null)&&($nim.G.V(ret+'.div')===null)&&($nim.G.V(ret+'.body')===null)){if($nim.aO.instForm(cY,'')){ret=$nim.aO.instForm(cY,'');ret+=(af)?$nim.aY+af:'';}else{ret=retapp+$nim.bs+$nim.aO.instForm(cY,'');ret+=(af)?$nim.aY+af:'';}}ret+=(bq)?$nim.aY+bq:'';return ret;},baseName:function(cY,af){cY=cY||"";af=af||"";if(cY===''){if(af.indexOf($nim.bs)> -1){af=af.split($nim.bs)[1];}return af.split($nim.aY)[2];}else if(af===''){if(cY.indexOf($nim.bs)> -1){cY=cY.split($nim.bs)[1];}return cY.split($nim.as)[0];}else{if(af.indexOf($nim.bs)> -1){af=af.split($nim.bs)[1];}if(cY.indexOf($nim.bs)> -1){cY=cY.split($nim.bs)[1];}return cY.split($nim.as)[0]+$nim.aY+af.split($nim.aY)[0];}},instForm:function(cY,af){var ret='';cY=cY||"";af=af||"";if(cY){var iname=cY.resolveName();if(iname.App){KERNEL.curAppIndex=iname.AppIndex;KERNEL.curApp=KERNEL.curName=iname.App;}if(iname.Form){KERNEL.formInst=iname.FormIndex;cY=iname.Form;}af=af||"";if((cY.indexOf($nim.aY)== -1)&&(cY.indexOf($nim.as)== -1)){ret+=cY+$nim.dP+KERNEL.formInst+$nim.cb;}else{ret+=cY;}if(iname.Control){if(iname.Control.indexOf('page.')!= -1){af=iname.Control;}}ret+=(af)?$nim.aY+af:'';}return ret.toLowerCase();},Type:function(de,K){de=de||"";K=K||"";var ret=null,au=$nim.instN(de,K),cc=$nim.am(au);if(cc&&cc["ctype"]){ret=cc["ctype"];}else{ret=$nim.G.ce($nim.aO.Type,arguments);}return ret||'';},aF:function(type,de,dlg_title,l,t,w,h,style){'use strict';de=de.toLowerCase();var uGlb=$nim.cK.DlgStyles;var uDef=$nim.cn.dialog;var dm,aX=App.App.guid||'';var c,size,ret,hname,cc;var dialog,aj,dlg_style;var body_hgt,title_hgt,title_fnt,title_fsize,back_hgt,cY,bx;var dragEnable,blWidg,pad,hpad,id,targBody;ret='';dragEnable=false;blWidg=false;pad=uDef.dlg_border;title_hgt=uDef.title_height;title_fnt=uDef.title_font;title_fsize=uDef.title_fontsize;id=$nim._.core.windowid+1;targBody=$nim.G.V(FORMS.Target+$nim.aY+'body');hpad=(pad/2);if(!targBody){targBody=$nim.G.V(FORMS.Target);}if(!targBody){targBody=$nim.G.V("desktop"+DESKTOP.currentDesktop+$nim.aY+'body');}if(App&&$nim.themes[App.theme]=='plain'){type='plain';}dialog=$nim.G.V(de);if(dialog===null){de=(de)?de:"dialog"+id;dlg_title=(dlg_title)?dlg_title:"Form "+id;w=(w)?w:400;h=(h)?h:200;if(t== -999||l== -999||$nim.undef(t)||$nim.undef(l)){size={width:w,height:h};c=$nim.ax.getCenteredTopLeft(size);if(t== -999||$nim.undef(t)){t=c.top;}if(l== -999||$nim.undef(l)){l=c.left;}}if(!$nim.undef(targBody.menu)&&targBody.id.indexOf("desktop")== -1){if(targBody.menu===true){t=t+$nim.cn.menus.menu_height;}}if(FORMS.list.indexOf(de)== -1){FORMS.list.push(de);}body_hgt=h;back_hgt=h;switch(type){case 'plain':hname='plain-'+style;if($nim.undef($nim.HTML[hname])){CGI.Get($nim._keys(33)+'cgi/'+$nim.file[globals.cgiVer].dialog+'?ver=2.0&aid='+aX+'&uid='+$nim.security.login+'&eml='+$nim.security.email+'&type=plain&style='+style,false);if(CGI.data.responseText!==''){$nim.HTML[hname]=CGI.data.responseText;}}break;case 'skin32':hname='skin32-'+style;if($nim.undef($nim.HTML[hname])){CGI.Get($nim._keys(33)+'cgi/'+$nim.file[globals.cgiVer].dialog+'?ver='+globals.cgiVer+'&aid='+aX+'&uid='+$nim.security.login+'&eml='+$nim.security.email+'&type=skin&style='+style,false);bx=KERNEL.cleanText(CGI.data.responseText);if(CGI.data.responseText!==''){$nim.HTML[hname]=bx;}}break;default:break;}cY=$nim.HTML[hname];if(!$nim._keys(33)){return '';}var bq=de.resolveName();dm={"<title.hgt>":title_hgt,"<dlg.title>":dlg_title,"<dlg.name>":de,"<overflow>":'overflow:hidden;text-overflow:clip;',"<absolute>":'position:absolute;',"<voidhref>":'javascript:void(0);',"<helpdlg>":"$f.help('"+de+"');","<mindlg>":"$f.min('"+de+"');","<maxdlg>":"$f.max('"+de+"');","<dockrgt>":"$f.dockright('"+de+"');","<docklft>":"$f.dockleft('"+de+"');","<docktop>":"$f.docktop('"+de+"');","<dockbot>":"$f.dockbottom('"+de+"');","<fullscrn>":"$f.fullscreen('"+de+"');","<toggledlg>":"$f.togglestate('"+de+"');"};if(App&&$nim.themes[App.theme]=='linux'){dm["<float.rgt>"]='float:left;';}else{dm["<float.rgt>"]='float:right;';}if($nim.Agent.usingIE||$nim.Agent.usingFF){dm["<back.transform>"]='transform: rotateY(180deg)';dm["<body.transform>"]='';}else{dm["<back.transform>"]='transform: rotateY(180deg) translateZ(1px)';dm["<body.transform>"]='transform: translateZ(1px)';}dm["<dlg.form>"]=de;dm["<closedlg>"]="$f.sysclose($heap."+bq.App+"['"+bq.Form+"'],'"+de+"');";cY=$nim.aX(dm,null,cY);dlg_style='pointer-events:auto;box-sizing:border-box;'+$nim._keys(23)+"z-index:"+($nim.ab.MOVE2TOP+id);dm={};switch(type){case 'plain':back_hgt+=title_hgt;dm["<width>"]=(w+(2*hpad));cY=$nim.aX("<width>",(w+(2*hpad)),cY);if((style&uGlb.caption)==uGlb.caption){dm["<caption.mgn>"]=8;dm["<title.hgt>"]=(title_hgt+1);body_top=(title_hgt+1);}else{dm["<caption.mgn>"]=0;dm["<title.hgt>"]=0;body_top=0;}dm["<height>"]=back_hgt;dm["<color.title>"]=uDef.bdr_text;dm["<color.body>"]=uDef.doc_color;dm["<color.back>"]=uDef.back_color;dm["<resize.top>"]=(back_hgt-22);dm["<resize.lft>"]=((w+(2*hpad))-22);dm["<start.hgt>"]="100%";dm["<body.mrgn>"]="0";dm["<body.wdt>"]="100%";dm["<body.hgt>"]=body_hgt;dm["<back.wdt>"]="100%";dm["<back.hgt>"]=back_hgt;dlg_style+=";overflow:hidden";dlg_style+=";left:"+(isNaN(l)?l:l+'px');dlg_style+=";top:"+(isNaN(t)?t:t+'px');dlg_style+=";width:"+(isNaN(w)?w:w+'px');dlg_style+=";height:"+(isNaN(h)?h:h+'px');break;case 'skin32':var body_top;var percwidth=100*(w-(2*pad))/w;dm["<width>"]=w;dm["<height>"]=(h+title_hgt);if((style&uGlb.caption)==uGlb.caption){dm["<title.hgt>"]=title_hgt;body_top=(title_hgt+pad);body_hgt=h;back_hgt=h+title_hgt;}else{dm["<title.hgt>"]=0;body_top=pad;body_hgt=h+title_hgt;back_hgt=body_hgt;}dm["<caption.mgn>"]=(pad+2);dm["<caption.hgt>"]=(title_hgt);dm["<body.mrgn>"]=pad;dm["<start.hgt>"]="100%";dm["<footr.top>"]=(h-6);dm["<resize.top>"]=((h+title_hgt+2*pad)-uDef.resize_height);dm["<resize.lft>"]=((w+(2*pad))-uDef.resize_width);dm["<color.title>"]=uDef.bdr_text;dm["<color.dlg>"]=uDef.dlg_color;dm["<color.body>"]=uDef.dlg_color;dm["<color.border>"]=uDef.bdr_color;dm["<body.wdt>"]=percwidth.toFixed(6)+"%";dm["<back.wdt>"]=percwidth.toFixed(6)+"%";dm["<body.hgt>"]=body_hgt;dm["<back.hgt>"]=body_hgt-2;dlg_style+=";border-radius:"+uDef.dlg_bdrradius;dlg_style+=";left:"+(isNaN(l)?l:l+'px');dlg_style+=";top:"+(isNaN(t)?t:t+'px');dlg_style+=";width:"+(isNaN(w)?w:w+'px');dlg_style+=";height:"+(isNaN(h)?h:(h+title_hgt+(pad*2))+'px');break;default:break;}dm["<title.font>"]=(title_fnt);dm["<title.fontsize>"]=(title_fsize);dm["<color.btn>"]=uDef.btn_color;dm["<color.back>"]=uDef.back_color;dm["<back.lft>"]=(type=='plain')?'0':pad;dm["<back.top>"]=(type=='plain')?'0':pad+2;cY=$nim.aX(dm,null,cY);var handle,aI=$nim.G.vDOM("div");aI.attrib($nim._keys(7),dlg_style);switch(type){case 'plain':aI["ctype"]='dialog.plain';break;case 'skin32':aI["ctype"]='dialog.skin';break;default:break;}$nim.G.setAttrs(aI,{parent:targBody.id,id:de,"prv-visibility":'visible',"prv-display":'inline-block',display:'inline-block',"ctype":aI["ctype"]||'',type:(type=='plain')?'document':'dialog',dlg_style:style,state:'restore',stateto:'',control:'false',facing:'face',ftimer:'0',stimer:'0',rtimer:'0',lpx:l,tpx:t,wpx:w,hpx:h,actw:w,acth:h,curw:w,curh:h});aI.innerHTML=cY;cc=aI.create();if(cc){try{targBody.appendChild(cc);}catch(err){if($k.errhandler){$k.errhandler(err,{type:'Dialog.appendChild',target:{id:de}},'$f.uidialog');}}dialog=$nim.G.V(de);if(dialog){dialog["ctype"]=aI["ctype"];if((style&uGlb.dragable)==uGlb.dragable){dragEnable=true;}if((style&uGlb.caption)==uGlb.caption){handle=$nim.G.V(de+$nim._keys(12));}else{handle=$nim.G.V(de+$nim.aY+'body');}if(dragEnable&&handle!==null&&$nim._syselems.indexOf(FORMS.Target)> -1){handle["ctype"]=aI["ctype"];$nim.ab.makeDragable(dialog,handle,dragEnable);}$with($nim.G,'initElem',[[de,aI["ctype"]],[de+$nim.aY+"resize","resize"],[de+$nim.aY+"min","resize"],[de+$nim.aY+"max","resize"],[de+$nim.aY+"dlgtitle",aI["ctype"]],[de+$nim.aY+"body",aI["ctype"]]]);if(targBody.id.indexOf("desktop")== -1){blWidg=true;aj=$nim.G.V(de+$nim.aY+'body');}$nim.df(dialog.id,"widget",blWidg);if(handle){$nim.df(handle.id,"widget",blWidg);}if(aj){$nim.df(aj.id,"widget",blWidg);}if(style&(uGlb.sizable)){var bf=$nim.G.V(de+$nim._keys(5));if(bf&&$nim._syselems.indexOf(FORMS.Target)> -1){$nim.ab.makeSizeable(dialog,bf);}}}$nim.G.evalStyles(de,cc,style);ret=de;}}else{$f.restore(de);ret=de;}$f.hide(de,'page.back');$nim.ab.setOrigCoords(null,$nim.G.V(de),null,false,false,true);FORMS.Target="desktop"+DESKTOP.currentDesktop;aI=null;dialog=null;handle=null;cc=null;$with($nim.G,'attachHotkey',[[de+'.close','Esc'],[de+'.min','Alt+Shift+Down'],[de+'.max','Alt+Shift+Up'],[de+'.dockrgt','Shift+Right'],[de+'.docklft','Shift+Left'],[de+'.docktop','Shift+Up'],[de+'.dockbot','Shift+Down']]);$nim.G.DlgInstance.add(ret);$nim.G.mergeObjects($nim._struct[ret],{type:(type=='plain')?'document':'dialog',control:'false'});return ret;},aC:function(de,l,t,w,h,style){'use strict';de=de.toLowerCase();var uGlb=$nim.cK.DlgStyles;var uDef=$nim.cn.dialog;var c,size,handle,ret,id,dialog,cc,aI,dlg_style,dragEnable;var aj,targBody;handle=null;ret='';id=$nim._.core.windowid+1;dragEnable=false;targBody=$nim.G.V(FORMS.Target+$nim.aY+'body');if(!targBody){targBody=$nim.G.V(FORMS.Target);}if(!targBody){targBody=$nim.G.V("desktop"+DESKTOP.currentDesktop+$nim.aY+'body');}dialog=$nim.G.V(de);if(dialog===null){if(t== -999||l== -999||$nim.undef(t)||$nim.undef(l)){size={width:w,height:h};c=$nim.ax.getCenteredTopLeft(size);if(t== -999||$nim.undef(t)){t=c.top;}if(l== -999||$nim.undef(l)){l=c.left;}}if(!$nim.undef(targBody.menu)){if(targBody.id.indexOf("desktop")== -1){if(targBody.menu===true){t=t+$nim.cn.menus.menu_height;}}}if(FORMS.list.indexOf(de)== -1){FORMS.list.push(de);}aI=$nim.G.vDOM("div");dlg_style="pointer-events:auto;position:absolute;height:"+(h)+"px;width:"+(w)+"px;top:"+t+"px;left:"+l+"px;"+$nim._keys(23)+"z-index:"+($nim.ab.MOVE2TOP);if(!$nim._keys(23)){return '';}if((style&uGlb.dragable)==uGlb.dragable){dragEnable=true;}aI.attrib($nim._keys(7),dlg_style);$nim.G.setAttrs(aI,{parent:targBody.id,id:de,"prv-visibility":'visible',"prv-display":'inline-block',display:'inline-block',"ctype":'dialog.surface',type:'surface',dlg_style:style,state:'restore',stateto:'',control:'false',facing:'face',ftimer:'0',stimer:'0',rtimer:'0',lpx:l,tpx:t,wpx:w,hpx:h,actw:w,acth:h,curw:w,curh:h});cc=aI.create();if(cc){cc["ctype"]='dialog.surface';try{targBody.appendChild(cc);}catch(err){if($k.errhandler){$k.errhandler(err,{type:'Surface.appendChild',target:{id:de}},'$f.uisurface');}}dialog=$nim.G.V(de);if(dialog){dialog["ctype"]='dialog.surface';dialog.width=$nim.G.dk(dialog);dialog.height=$nim.G.dC(dialog);dialog.originalOpacity=dialog.style['opacity'];dialog.originalLeft=l;dialog.originalTop=t;dialog.originalWidth=w;dialog.originalHeight=h;$nim.df(dialog.id,"state",'restore');var cY='<div id="<dlg.name>.body" style="box-sizing:border-box;<overflow><absolute>vertical-align:top;width:100%;height:100%;"></div>'+'<a id="<dlg.name>.resize" dock="!!!!" index="<dlg.name>" display="none" origSize="<resize.lft>,<resize.top>,<resize.wid>,<resize.hgt>" dock="FTFT" form="<dlg.form>" '+'style="display:none;top:<resize.top>px;left:<resize.lft>px;float:right;z-index:200;<absolute>" class="size_graphic">'+'<span>&nbsp;&nbsp;</span></a>';cY=$nim.aX({"<resize.top>":(h-uDef.resize_height),"<resize.lft>":(w-uDef.resize_width),"<resize.wid>":(uDef.resize_width),"<resize.hgt>":(uDef.resize_height),"<dlg.name>":de,"<overflow>":'overflow:hidden;text-overflow:clip;',"<absolute>":'position:absolute;',"<body.hgt>":h,"<body.wdt>":w},null,cY);dialog.innerHTML=cY;aj=$nim.G.V(de+$nim.aY+'body');if(targBody.id.indexOf("desktop")== -1){$nim.df(dialog.id,"widget",'true');$nim.df(dialog.id,'dock',FORMS.Dock);$nim.df(aj.id,"widget",'true');}else{$nim.df(dialog.id,"widget",'false');$nim.df(dialog.id,'dock','----');$nim.df(aj.id,"widget",'false');}$nim.G.lockFlags(dialog);$nim.ax.bG(de,"dialog.surface");$nim.ax.bG(de+$nim.aY+"resize","resize");$nim.ax.bG(de+$nim.aY+'body',"dialog.surface");handle=$nim.G.V(de+".body");if(dragEnable){$nim.ab.makeDragable(dialog,handle,true);}if(style&(uGlb.sizable)){if(FORMS.Target.indexOf('desktop')> -1){$f.makesizeable(de,'xy');}}}}$nim.G.evalStyles(de,cc,style);ret=de;}else{$f.restore(de);ret=de;}$nim.ab.setOrigCoords(null,$nim.G.V(de),null,false,false,true);FORMS.Target="desktop"+DESKTOP.currentDesktop;dialog=null;aI=null;handle=null;$nim.G.DlgInstance.add(ret);$nim.G.mergeObjects($nim._struct[ret],{type:'surface',control:'false'});return ret;},setInstance:function(af){var cc,bq,ret=false,ctrlName=$nim.aX("start.","",af);if(ctrlName){bq=ctrlName.resolveName();ctrlName=$nim.aO.enumerateName(bq);cc=$nim.G.V(ctrlName);if(cc){if(cc.getAttribute("appid")){KERNEL.curTarget=cc;KERNEL.curId=cc.id;KERNEL.curAppId=(cc.getAttribute("appid"))?dA(cc.getAttribute("appid")):0;KERNEL.aA=cc.id.resolveName('formindex');KERNEL.curAppIndex=(cc.getAttribute("curinst"))?dA(cc.getAttribute("curinst")):0;KERNEL.curForm=bq.Form;KERNEL.formInst=bq.FormIndex;var tmpApp=ad[$nim.aq.sFind(KERNEL.curAppId,KERNEL.curAppIndex)];App=tmpApp?tmpApp:App;if(App){App.Event={};App.Event.ElementId=cc.id;App.Event.AppIndex=KERNEL.curAppIndex;App.Event.Form=KERNEL.curForm;App.Event.FormIndex=KERNEL.formInst;App.Event.Control=bq.Control;App.Event.Component=bq.Component;if(bq.Form){$nim.G.SetMe(cc.id,bq.Form);if(App.Dialog[bq.Form]){App.Dialog[bq.Form].FormIndex=KERNEL.formInst;App.Dialog[bq.Form].Control=bq.Control;App.Dialog[bq.Form].Component=bq.Component;}}}$nim.bi=ad[$nim.aq.sFind(KERNEL.curAppId,KERNEL.curAppIndex)];if($nim.bi){$nim.G.AssignInstance($nim.bi,ctrlName);if($nim.bi.Current){ret=true;if($nim.bi.Current.Form){if(!$nim.undef($nim.bi.Dialog)){if(!$nim.undef($nim.bi.Dialog[$nim.bi.Current.Form])){if(!$nim.bi.Model)$nim.bi.Model=$nim.bi.Dialog[$nim.bi.Current.Form].Model;$nim.bi.Model._focus=$nim.bi.Current.Form;$nim.bi.Events=$nim.bi.Dialog[$nim.bi.Current.Form].Events;$nim.bi.Widgets=$nim.bi.Dialog[$nim.bi.Current.Form].Widgets;$nim.bi.DlgCode=$nim.bi.Dialog[$nim.bi.Current.Form].Code;}}else{$nim.bi.Model._focus=null;$nim.bi.Model=null;$nim.bi.Events=null;$nim.bi.Widgets=null;$nim.bi.DlgCode=null;}}if(!$nim.undef($nim.bi.Code)){if($nim.undef($nim.bi.Code.Vars)){$nim.bi.Code.Vars={};}$nim.bi.Globals=$nim.bi.Code.Vars;if($nim.undef($nim.bi.Code.Services)){$nim.bi.Code.Services={};}$nim.bi.Services=$nim.bi.Code.Services;}}$k.instance.setapp($nim.bi);DESKTOP.update=true;}else{DESKTOP.update=true;}}}}cc=null;return ret;},setFocus:function(cc){var id,last;if(cc["ctype"]=='imagex'){id=$nim._.core.lastFocus;if(id){last=$f.af(id.resolveName('form'),id.resolveName('control'));if(last)last.blur();}$nim._.core.lastFocus=cc.id;}else{if($nim._.drag.ap){if($nim._.drag.ap!=cc){if($nim.G.cu($nim._.drag.ap,$nim._d)){$nim.G.resetZIndex($nim._.drag.ap,$nim.ab.MOVE2MID);}}}$f.zorder(cc.id,1);$nim._.drag.ap=cc;$nim._.drag.lastdragged_id=cc.id;}},fClose:function(e){'use strict';var search,J;if(typeof(e)=='string'){J=$nim.G.V(e);}else{e=$nim.ab.fixEvent(e);J=$nim.ab.findTarget(e);}search=$nim._keys(20);while((J)&&(J.id.substring(0,search.length)!=search)){J=J.parentNode?J.parentNode:J.parentElement;if(J.nodeName=='HTML')break;}if(J){if(J.id.substring(0,search.length)!=search)J=null;if(J){var id=J.attributes['index'].value;$nim.ax.removeElementById(id);$nim.ax.removeElementById(id+$nim.aY+'hnd');}}J=null;},Unload:function(de,K){K=K||"";var ctype,au,cc;ctype='';au=$nim.instN(de,K);cc=$f.cc(de,K);if(K!==''){$f.sysunload(de,K);}else{if($nim.cK.revision=="0"){$f.sysunload(de);}else{if(App!==null){if(App.Dialog[de]&&App.Dialog[de].count>=1){$f.sysunload(de);}else{if(cc!==null){ctype=cc["ctype"];$k.instance.clrdlgid(au);$nim.ax.bK(au);if(!$nim.undef(ctype)){if($nim.G.cu(cc,$nim._d)===false){au+=$nim.bJ+"div";}$nim.ax.bK(au);}$f.sysclose(App.Dialog[de],de);if(!KERNEL.isAnyFormLoaded()){if((App)&&(!$nim.undef(App))){if(App.Close){App.Close();}}}$f.sysunload(de);}}}else{$f.sysunload(de);}}}cc=null;if(App&&App.Code&&App.Code._callback){if(App.Code._callback.onUnload){App.Code._callback.onUnload(de,K);}}},UnloadAll:function(de,K){K=K||"";var ctype,au,cc;ctype='';au=$nim.instN(de,K);cc=$f.cc(de,K);if(K!==''){$f.sysunload(de,K);}else{if($nim.cK.revision=="0"){$f.sysunload(de);}else{ctype='';if(cc){ctype=cc["ctype"];$k.instance.clrdlgid(au);$nim.ax.bK(au);if(!$nim.undef(ctype)){if($nim.G.cu(cc,$nim._d)===false){au+=$nim.bJ+"div";}$nim.ax.bK(au);}if((App!==null)&&(!$nim.undef(App))){$f.syscloseAll(App.Dialog[de],de);if(!KERNEL.isAnyFormLoaded()){if((App!==null)&&(!$nim.undef(App))){if(App.Close){App.Close();}}}}else{$f.sysunload(de);}}}}cc=null;if(App&&App.Code&&App.Code._callback){if(App.Code._callback.onUnloadAll){App.Code._callback.onUnloadAll(de,K);}}},Acquire:function(target,orientation){var i=0,F;var child,dlg,aj,fsize;dlg=$nim.G.V(target);aj=$nim.G.V(target+'.body');if(!aj){aj=$nim.G.V(target);}orientation=orientation?orientation:'vertical';if(aj){fsize=$f.getsize(target.resolveName('form'));if(aj.childNodes.length>0){for(i=0,F=aj.childNodes.length;i<F;i++){child=aj.childNodes[i];if(child.dock=='!!!!'){$nim.ab.flipChildProps(true,child,fsize,'px');}}}}if(dlg){$nim.ab.flipFormProps(orientation,dlg,fsize,'px');}},Release:function(target,orientation){var i=0,F;var child,dlg,aj,fsize;dlg=$nim.G.V(target);aj=$nim.G.V(target+'.body');if(!aj){aj=$nim.G.V(target);}orientation=orientation?orientation:'vertical';if(aj){fsize=$f.getsize(target.resolveName('form'));if(aj.childNodes.length>0){for(i=0,F=aj.childNodes.length;i<F;i++){child=aj.childNodes[i];if(child.dock!='!!!!'){$nim.ab.flipChildProps(true,child,fsize,'%');}}}}if(dlg){$nim.ab.flipFormProps(orientation,dlg,fsize,'%');}},GetParent:function(de,K){var ret,cc=$f.cc(de,K);if(cc){ret=cc.getAttribute('parent');}else{return $nim.G.ce($nim.aO.GetParent,arguments);}return ret;},Consume:function(target,blFlatten){var i,F,dlg,child,ret={},data=[];var aj=$nim.G.V(target+'.body');if(!aj){aj=$nim.G.V(target);}if(aj){if(aj.childNodes.length>0){for(i=0,F=aj.childNodes.length;i<F;i++){child=aj.childNodes[i];if(child.dock=='!!!!'){dlg=child.id.resolveName('form');data.push(App.Model.pull(dlg));}}}}if(blFlatten){for(i=0;i<data.length;i++){ret=$nim.G.mergeObjects(ret,data[i]);}return ret;}else{return data;}},Digest:function(target,digestParams,data,clear){var x=0,e,aM,aj;var scroll,pos;var au,bq,cform,iform,cview,e,item,size,fsize;var cdata,cparm;scroll={};pos={target:target};aj=$nim.G.V(target+'.body');if(!aj){aj=$nim.G.V(target);}digestParams.orientation=digestParams.orientation?digestParams.orientation:'vertical';if(aj){fsize=$f.getsize(target.resolveName('instform'));scroll={y:aj.scrollTop,x:aj.scrollLeft};if(clear){while(aj.firstChild){aj.removeChild(aj.firstChild);}digestParams._result=[];}if(!digestParams._result){digestParams._result=[];}if(digestParams.key){digestParams.dataCount=data.length;for(x=0;x<data.length;x++){if(App&&App.Dialog){cdata=data[x];if(cdata[digestParams.key]){cparm=digestParams[cdata[digestParams.key]];cform=cdata.dialog?cdata.dialog:cparm.name;cview=cdata.state?cdata.state:cparm.state;e=cdata.event?cdata.event:cparm.event;if(cform&&App.Dialog[cform]){FORMS.Target=target;pos={target:target,left:0,top:0};au=App.Dialog[cform].New(pos,true);item=$nim.G.V(au);if(item){iform=au.resolveName('instform');item.setAttribute('dataindex',x);if(cdata.id){item.setAttribute('dataid',cdata.id);}if(cdata._styles&&cdata._styles.length){$f.setstyle(iform,'',cdata._styles);}if(cdata._props&&cdata._props.length){$f.setprop(iform,'',cdata._props);}if(cdata._events&&cdata._events.length){for(e=0;e<cdata._events.length;e++){aM=cdata._events[e];aM.name=(aM.name.indexOf('.')== -1)?'.'+aM.name:aM.name;$f.setevent(iform,aM.name.split('.')[0],aM.name.split('.')[1],aM['fn']);}}if(cview){$f.alter.view.set(iform,cview,false);}if(e){e(au,digestParams,cdata,x);}$f.setstyle(iform,'',[{name:'hnd.width',value:'100%'},{name:'resize.display',value:'none'}]);if(['true','w','h','width','height'].indexOf($nim._struct[au]['autosize'])== -1)$nim.ab.flipFormProps(digestParams.orientation,item,fsize,'%');bq=$nim.copy(cdata);bq._dataindex=x;bq._elemid=item.id;digestParams._result.push(bq);}try{App.Model.push((cdata._data)?cdata._data:cdata,cform);}catch(err){}}}}}}else{digestParams.dataCount=data.length;for(x=0;x<data.length;x++){if(App&&App.Dialog&&App.Dialog[digestParams.name]){cdata=data[x];cform=cdata.dialog?cdata.dialog:digestParams.name;cview=cdata.state?cdata.state:digestParams.state;e=cdata.event?cdata.event:digestParams.event;FORMS.Target=target;pos={target:target,left:0,top:0};au=App.Dialog[cform].New(pos,true);item=$nim.G.V(au);if(item){iform=au.resolveName('instform');item.setAttribute('dataindex',x);if(cdata.id){item.setAttribute('dataid',cdata.id);}if(cdata._styles&&cdata._styles.length){$f.setstyle(iform,'',cdata._styles);}if(cdata._props&&cdata._props.length){$f.setprop(iform,'',cdata._props);}if(cdata._events&&cdata._events.length){for(e=0;e<cdata._events.length;e++){aM=cdata._events[e];aM.name=(aM.name.indexOf('.')== -1)?'.'+aM.name:aM.name;$f.setevent(iform,aM.name.split('.')[0],aM.name.split('.')[1],aM['fn']);}}if(cview){$f.alter.view.set(iform,cview,false);}if(e){e(au,digestParams,cdata,x);}$f.setstyle(iform,'',[{name:'hnd.width',value:'100%'},{name:'resize.display',value:'none'}]);if(['true','w','h','width','height'].indexOf($nim._struct[au]['autosize'])== -1)$nim.ab.flipFormProps(digestParams.orientation,item,fsize,'%');bq=$nim.copy(cdata);bq._dataindex=x;bq._elemid=item.id;digestParams._result.push(bq);}try{App.Model.push((cdata._data)?cdata._data:cdata,digestParams.name);}catch(err){}}}}}if(aj){aj.scrollTop=scroll.y;aj.scrollLeft=scroll.x;}aj=null;item=null;return digestParams;},Min:function(de,pos,G){de=de||"";var dlg,xcnt,O,bZ,rows,brdr,dtop,dleft,pad=$nim.cn.dialog.dlg_border,au=$nim.instN(de,''),cc=$nim.am(au);if(typeof(pos)=='function'){G=pos;pos=null;}pos=pos||{};if(cc){if($f.getprop(de,'','state')=='min'){$f.restore(de,pos,G);}else{if($nim.G.TriggerDlgEvent(au,'Minimize',1))return;$nim.G.pushStyles(cc,$nim._pop);if($nim.cn.sounds.minimize!==''){var audio=new Audio($nim.cn.sounds.minimize);audio.play();}bZ=DESKTOP.minimized[DESKTOP.currentName];if(bZ.indexOf(au)== -1){if(bZ.indexOf('')!= -1){bZ[bZ.indexOf('')]=au;}else{bZ.push(au);}}O=$nim.ax.getWindowDimensions();dlg=bZ.indexOf(au);xcnt=Math.floor((O.width*0.98)/($nim.cn.dialog.min_width+4*$nim.cn.dialog.min_spacing));rows=Math.floor(dlg/xcnt);brdr=$nim.cn.dialog.min_height+(2*pad)+$nim.cn.dialog.min_spacing;dlg=dlg-(rows*xcnt);dtop=(O.height-DESKTOP.footer-$nim.cn.dialog.min_padbottom)-(rows*brdr);dleft=0+(dlg*($nim.cn.dialog.min_width+2*$nim.cn.dialog.min_spacing));$nim.G.transitionState(cc,de,true,null,false,'min');$f[$nim.mv](de,'',pos.left||(dleft+$nim.cn.dialog.min_padleft),pos.top||dtop,$nim.cn.dialog.min_width,$nim.cn.dialog.min_height,pos.speed||0.45,function(anim){if(anim.pos==100){$nim.G.triggerDlgResize('Minimize',au,null,2,null,cc);}G&&G(anim);});bZ=null;}}},Max:function(de,G){de=de||"";var bZ,ew=0,el=0,eh=0,et=0,al,ah,pad=$nim.cn.dialog.dlg_border,au=$nim.instN(de,''),cc=$nim.am(au);if(cc){if($nim.G.TriggerDlgEvent(au,'Maximize',1))return;$nim.G.pushStyles(cc,$nim._pop);if($nim.cn.sounds.maximize!==''){var audio=new Audio($nim.cn.sounds.maximize);audio.play();}bZ=DESKTOP.minimized[DESKTOP.currentName];if(bZ.indexOf(au)!= -1){bZ[bZ.indexOf(au)]='';}al=DESKTOP.width;ah=DESKTOP.height;if(!$nim.G.cu(cc,$nim._s)){ew=$nim.cn.dialog.max_padright;eh=$nim.cn.dialog.max_padbottom;el=$nim.cn.dialog.max_padleft;et=$nim.cn.dialog.max_padtop;if(App&&$nim.themes[App.theme]=='v3.2'){al=al+(pad/2);ah=ah-(pad/2);}}if($nim.G.cu(cc,$nim._k)){ew=($nim.cn.dialog.max_padright);eh=($nim.cn.dialog.max_padbottom);}$nim.G.transitionState(cc,de,false,10,false,'max');$f[$nim.mv](de,'',el,et+DESKTOP.header,al-(el+ew),ah-(et+eh),0.45,function(anim){if(anim.pos==100){$nim.G.triggerDlgResize('Maximize',au,null,2,null,cc);$nim.G.TriggerDlgEvent(au,'Resize',null);}G&&G(anim);});bZ=null;}},FullScreen:function(de,G){if(KERNEL.sdkMode)return;de=de||'';var uGlb=$nim.cK.DlgStyles;var style,bZ,ew=0,el=0,eh=0,et=0,al,ah,pad=$nim.cn.dialog.dlg_border,title_hgt=$nim.cn.dialog.title_height+pad,au=$nim.instN(de,''),cc=$nim.am(au),aj=$nim.am(au+$nim.bJ+'body');if(cc){if($nim.G.TriggerDlgEvent(au,'FullScreen',1))return;$nim.G.pushStyles(cc,$nim._pop);if($nim.cn.sounds.maximize!==''){var audio=new Audio($nim.cn.sounds.maximize);audio.play();}bZ=DESKTOP.minimized[DESKTOP.currentName];if(bZ.indexOf(au)!= -1){bZ[bZ.indexOf(au)]='';}al=DESKTOP.width;ah=DESKTOP.height;if(!$nim.G.cu(cc,$nim._s)){style=$nim.dE(cc.id,'dlg_style');if((style&uGlb.caption)==uGlb.caption){et=title_hgt+pad;}else{et=pad;}eh=2*pad+et;el=pad+1;ew=pad+1;et--;if(App&&$nim.themes[App.theme]=='v3.2'){al=al-pad;ah=ah-pad;}}$nim.G.transitionState(cc,de,false,10,false,'full');$f['moveto'](de,'',-el,-(et+2),al+(el+ew),ah+(et+eh+1),0.45,function(anim){if(anim.pos==100){cc.style.right= -(el+ew)+'px';cc.style.width='';cc.style.bottom= -(pad)+'px';aj.style.height='calc(100% - '+(et+(pad*2))+'px)';cc.style.height='';$nim.G.triggerDlgResize('FullScreen',au,null,2,null,cc);$f.setprop(de,'','state','full');}G&&G(anim);});bZ=null;}},Restore:function(de,pos,G){de=de||"";var bZ,st,au=$nim.instN(de,''),cc=$nim.am(au);if(typeof(pos)=='function'){G=pos;pos=null;}pos=pos||{};if(cc){st=$f.getprop(de,'','state');if(st!='restore'){$f.setvisible(de,'resize',true);if($nim.G.TriggerDlgEvent(au,'Restore',1))return;if(['restore'].indexOf(st)> -1)return;if(st.indexOf('dock')> -1){$f.setprop(de,'','dockSize','');}if($nim.cn.sounds.restore!==''){var audio=new Audio($nim.cn.sounds.restore);audio.play();}bZ=DESKTOP.minimized[DESKTOP.currentName];if(bZ.indexOf(au)!= -1){bZ[bZ.indexOf(au)]='';}var dst=$nim.dE(cc.id,'dockState');var dsize=$nim.dE(cc.id,'dockSize'),osize=$nim.dE(cc.id,'restoreSize'),osize=dsize||osize,left=dA(osize.split(',')[0]),top=dA(osize.split(',')[1]),width=dA(osize.split(',')[2]),height=dA(osize.split(',')[3]);if(st!='max'&&(width>DESKTOP.width||height>DESKTOP.height)){$nim.aO.Max(de);}else{if(!dsize){$nim.G.transitionState(cc,de,false,null,true,'restore');$f[$nim.mv](de,'',pos.left||left,pos.top||top,width,height,pos.speed||0.45,function(anim){if(anim.pos==100){$nim.G.triggerDlgResize('Restore',au,null,2,$nim._pop,cc);$nim.G.TriggerDlgEvent(au,'Resize',null);}G&&G(anim);});}else{$f[dst](de);}}bZ=null;}}},DockTop:function(de,K,G){K=K||"";var el,et,ew,eh,al,ah,dlg,au=$nim.instN(de,''),pad=$nim.cn.dialog.dlg_border,O=$nim.ax.getWindowDimensions(),cc=$f.cc(de,K);if(cc){if(!K){$nim.G.TriggerDlgEvent(au,'Resize',1);ew=$nim.cn.dialog.max_padright;eh=$nim.cn.dialog.max_padbottom;el=$nim.cn.dialog.max_padleft;et=$nim.cn.dialog.max_padtop;al=O.width;ah=O.height;if($nim.G.cu(cc,$nim._k)){ew=($nim.cn.dialog.max_padright-5);eh=($nim.cn.dialog.max_padbottom-5);}if(App&&$nim.themes[App.theme]=='v3.2'){al=al-(pad*2);ah=ah-(pad*2);}$nim.G.transitionState(cc,de,false,null,false,'docktop');$f[$nim.mv](de,'',el,et,(al-(el+ew)),(ah-(et+eh))/2,0.55,function(anim){if(anim.pos==100){$nim.G.updateDlgCoords(cc,'docktop');$nim.G.triggerDlgResize('Resize',au,1,2,null,cc);}G&&G(anim);});}else{dlg=$nim.am(au);if(dlg){var dlgSize=$f.getsize(au+$nim.bJ+'body');el=dlgSize.width*0.005;et=dlgSize.height*0.005;$f[$nim.mv](de,K,el,et,(dlgSize.width*0.990),((dlgSize.height*0.990)/2),0.55,function(anim){if(anim.pos==100){$nim.SetId(au);}G&&G(anim);});}}}O=null;},DockBottom:function(de,K,G){K=K||"";var el,et,ew,eh,al,ah,dlg,au=$nim.instN(de,''),pad=$nim.cn.dialog.dlg_border,O=$nim.ax.getWindowDimensions(),cc=$f.cc(de,K);if(cc){if(!K){$nim.G.TriggerDlgEvent(au,'Resize',1);ew=$nim.cn.dialog.max_padright;eh=$nim.cn.dialog.max_padbottom;el=$nim.cn.dialog.max_padleft;et=$nim.cn.dialog.max_padtop;al=O.width;ah=O.height;if($nim.G.cu(cc,$nim._k)){ew=($nim.cn.dialog.max_padright-5);eh=($nim.cn.dialog.max_padbottom-5);}if(App&&$nim.themes[App.theme]=='v3.2'){al=al-(pad*2);ah=ah-(pad*2);}$nim.G.transitionState(cc,de,false,null,false,'dockbottom');$f[$nim.mv](de,'',el,et+((ah-(et+eh))/2),(al-(el+ew)),(ah-(et+eh))/2,0.55,function(anim){if(anim.pos==100){$nim.G.updateDlgCoords(cc,'dockbottom');$nim.G.triggerDlgResize('Resize',au,1,2,null,cc);}G&&G(anim);});}else{dlgInst=$nim.instN(de,"");dlg=$nim.am(dlgInst);if(dlg){var dlgSize=$f.getsize(dlgInst+$nim.bJ+'body');el=dlgSize.width*0.005;et=(dlgSize.height*0.990)/2;$f[$nim.mv](de,K,el,et,(dlgSize.width*0.990),((dlgSize.height*0.990)/2),0.55,function(anim){if(anim.pos==100){$nim.SetId(au);}G&&G(anim);});}}}O=null;},DockLeft:function(de,K,G){K=K||"";var el,et,ew,eh,es,al,ah,dlg,au=$nim.instN(de,''),pad=$nim.cn.dialog.dlg_border,O=$nim.ax.getWindowDimensions(),cc=$f.cc(de,K);if(cc){if(!K){$nim.G.TriggerDlgEvent(au,'Resize',1);ew=$nim.cn.dialog.max_padright;eh=$nim.cn.dialog.max_padbottom;el=$nim.cn.dialog.max_padleft;et=$nim.cn.dialog.max_padtop;es=1.5*$nim.cn.dialog.max_spacing;al=O.width;ah=O.height;if($nim.G.cu(cc,$nim._k)){ew=($nim.cn.dialog.max_padright-5);eh=($nim.cn.dialog.max_padbottom-5);}if(App&&$nim.themes[App.theme]=='v3.2'){al=al-(pad*2);ah=ah-(pad*2);}$nim.G.transitionState(cc,de,false,null,false,'dockleft');$f[$nim.mv](de,K,el,et,(al-(el+ew+es))/2,ah-(et+eh),0.55,function(anim){if(anim.pos==100){$nim.G.updateDlgCoords(cc,'dockleft');$nim.G.triggerDlgResize('Resize',au,1,2,null,cc);}G&&G(anim);});}else{dlg=$nim.am(au);if(dlg){var dlgSize=$f.getsize(au+$nim.bJ+'body');el=dlgSize.width*0.005;et=dlgSize.height*0.005;$f[$nim.mv](de,K,el,et,((dlgSize.width*0.990)/2),(dlgSize.height*0.990),0.55,function(anim){if(anim.pos==100){$nim.SetId(au);}G&&G(anim);});}}}O=null;},DockRight:function(de,K,G){K=K||"";var el,et,ew,eh,es,al,ah,dlg,au=$nim.instN(de,''),pad=$nim.cn.dialog.dlg_border,O=$nim.ax.getWindowDimensions(),cc=$f.cc(de,K);if(cc){if(!K){$nim.G.TriggerDlgEvent(au,'Resize',1);ew=$nim.cn.dialog.max_padright;eh=$nim.cn.dialog.max_padbottom;el=$nim.cn.dialog.max_padleft;et=$nim.cn.dialog.max_padtop;es=1.5*$nim.cn.dialog.max_spacing;al=O.width;ah=O.height;if($nim.G.cu(cc,$nim._k)){ew=($nim.cn.dialog.max_padright-5);eh=($nim.cn.dialog.max_padbottom-5);}if(App&&$nim.themes[App.theme]=='v3.2'){al=al-(pad*2);ah=ah-(pad*2);}$nim.G.transitionState(cc,de,false,null,false,'dockright');$f[$nim.mv](de,K,((al-(el+ew))/2)+es,et,(al-(el+ew+es))/2,ah-(et+eh),0.55,function(anim){if(anim.pos==100){$nim.G.updateDlgCoords(cc,'dockright');$nim.G.triggerDlgResize('Resize',au,1,2,null,cc);}G&&G(anim);});}else{dlg=$nim.am(au);if(dlg){var dlgSize=$f.getsize(au+$nim.bJ+'body');el=(dlgSize.width*0.990)/2;et=dlgSize.height*0.005;$f[$nim.mv](de,K,el,et,((dlgSize.width*0.990)/2),(dlgSize.height*0.990),0.55,function(anim){if(anim.pos==100){$nim.SetId(au);}G&&G(anim);});}}}O=null;},Refresh:function(de,K){var disp,au=$nim.instN(de,''),cc=$f.cc(de,K);if(cc){disp=cc.style.display;cc.style.display='none';cc.style.display=disp;$nim.G.TriggerDlgEvent(au,'Refresh',au);}else{$nim.G.ce($nim.aO.Refresh,arguments);}},Center:function(de,K,xW,yH){var pW=$nim.pW,pH=$nim.pH,J='',cc=$f.cc(de,K),dlg=$f.cc(de);if(cc){J=(K)?$nim.instN(de):cc.getAttribute('parent');if(!K){xW=$nim.undef(xW)?DESKTOP.width/2:xW;yH=$nim.undef(yH)?DESKTOP.height/2:yH;}else{xW=(dlg&& !xW)?dlg.width/2:xW;yH=(dlg&& !yH)?dlg.height/2:yH;}var x=pW(J,xW),y=pH(J,yH),l=x-($nim.G.dk(cc)/2),t=y-($nim.G.dC(cc)/2);if((isNaN(l)===false)&&(l!==null)){$nim.G.cS(cc,l+"px");}if((isNaN(t)===false)&&(t!==null)){$nim.G.cN(cc,t+"px");}}else{$nim.G.ce($nim.aO.Center,arguments);}},GetCenter:function(de,K){var ret=null,L,T,W,H,cc=$f.cc(de,K);if(cc){L=$nim.G.cX(cc)||cc.offsetLeft;T=$nim.G.cF(cc)||cc.offsetTop;W=cc.offsetWidth||$nim.G.dk(cc);H=cc.offsetHeight||$nim.G.dC(cc);ret={x:L+(W/2),y:T+(H/2)};}else{return $nim.G.ce($nim.aO.GetCenter,arguments);}return ret;},hCenter:function(de,K){var pW=$nim.pW,pH=$nim.pH,J='',cc=$f.cc(de,K);if(cc){J=(K)?$nim.instN(de):cc.getAttribute('parent');var x=pW(J,'50%'),l=x-($nim.G.dk(cc)/2);if((isNaN(l)===false)&&(l!==null)){$nim.G.cS(cc,l+"px");}}else{$nim.G.ce($nim.aO.hCenter,arguments);}},vCenter:function(de,K){var pW=$nim.pW,pH=$nim.pH,J='',cc=$f.cc(de,K);if(cc){J=(K)?$nim.instN(de):cc.getAttribute('parent');var y=pH(J,'50%'),t=y-($nim.G.dC(cc)/2);if((isNaN(t)===false)&&(t!==null)){$nim.G.cN(cc,t+"px");}}else{$nim.G.ce($nim.aO.vCenter,arguments);}},Title:function(de,txt){var au=$nim.instN(de,''),notxt=$nim.undef(txt);var cc=$nim.am(au+$nim._keys(12));if(cc){if(!notxt)cc.setAttribute('title',$nim.G.i18n(cc,'innerText',txt));return!notxt?$nim.G.i18n(cc,'innerText',txt):cc.innerText;}else{return $nim.G.ce($nim.aO.Title,arguments);}},Visible:function(de,K,visVal){var cc,noval,disVal,prvVis,prvDisp;var au=$nim.instN(de,K);au=(au.indexOf(']~')== -1)?$nim.bName(de,K):au;if(visVal&&visVal.toString().toLowerCase()=='show'){$nim.aO.Show(de,K);return;}if(visVal&&visVal.toString().toLowerCase()=='hide'){$nim.aO.Hide(de,K);return;}cc=$f.cc(de,K);if(cc){noval=$nim.undef(visVal);prvVis=cc.getAttribute('prv-visibility')||'visible';prvDisp=(cc.style['position']=='absolute')?(cc.getAttribute('prv-display')||'inline-block'):cc.getAttribute('prv-display');visVal=(visVal===true||visVal=='visible')?prvVis:'hidden';disVal=(visVal=='visible')?(prvDisp||'inline'):'none';if(noval){return(cc.style['visibility']=="hidden"||cc.style['display']=='none')?false:true;}else{$nim.G.setDisplay(cc,disVal,false);$nim.cQ(au,'visibility',visVal);$nim.df(au,'visible',(visVal=='visible'));}}else{return $nim.G.ce($nim.aO.Visible,arguments);}return null;},SetCoords:function(de,K,lW,tH,wW,hH,blRsze){var pW=$nim.pW,pH=$nim.pH,J='',cc=$f.cc(de,K);if(lW.top){hH=lW.height;wW=lW.width;tH=lW.top;lW=lW.left;}if(cc){J=(K)?$nim.instN(de):cc.getAttribute('parent');var l=pW(J,lW),t=pH(J,tH),w=pW(J,wW),h=pH(J,hH);if((isNaN(l)===false)&&(l!==null)){$nim.G.cS(cc,l+"px");}if((isNaN(t)===false)&&(t!==null)){$nim.G.cN(cc,t+"px");}if(blRsze){$nim.aO.Size(de,K,w,h);$nim.ab.resizeChildren(null,cc,false);}else{if((isNaN(w)===false)&&(w!==null)){$nim.G.cT(cc,w+'px');}if((isNaN(h)===false)&&(h!==null)){$nim.G.cz(cc,h+'px');}}}else{$nim.G.ce($nim.aO.SetCoords,arguments);}},GetCoords:function(de,K){var ret,cc=$f.cc(de,K);if(cc){ret={left:$nim.G.cX(cc)||cc.offsetLeft||0,top:$nim.G.cF(cc)||cc.offsetTop||0};if(['true','w','h','height','width'].indexOf($nim.dE(cc.id,'autosize'))> -1||['block','inline-block'].indexOf($nim.dE(cc.id,'displaymode'))> -1||$nim.G.isCustom(de,K)){ret.width=cc.offsetWidth;ret.height=cc.offsetHeight;}else{ret.width=cc.offsetWidth||$nim.G.dk(cc);ret.height=cc.offsetHeight||$nim.G.dC(cc);}ret.left=(ret.left=='0px')?cc.offsetLeft:ret.left;ret.top=(ret.top=='0px')?cc.offsetTop:ret.top;}else{return $nim.G.ce($nim.aO.GetCoords,arguments);}return ret;},Size:function(de,K,wval,hval){if(wval&&wval.width){hval=wval.height;wval=wval.width;}var pW=$nim.pW,pH=$nim.pH,uDlg=$nim.cn.dialog,uGlb=$nim.cK.DlgStyles;var w,h,style,isSurf,percwidth,wadj=0,hadj=0,J='',au=$nim.instN(de,K),cc=$f.cc(de,K),af=$f.af(de,K);if(cc){if(cc.dock!='!!!!'){var bf=$nim.am(au+$nim._keys(5)),dhnd= !K?$nim.am(au+$nim.bJ+'hnd'):null,aj= !K?$nim.am(au+$nim.bJ+'body'):null,pad=uDlg.dlg_border,title_hgt=uDlg.title_height,dw=$nim.am(au+$nim.bJ+'page.back'),dfoot=$nim.am(au+$nim.bJ+'footer');J=(K)?$nim.instN(de):cc.getAttribute('parent');w=$nim.G.minMaxW(cc,pW(J,wval));h=$nim.G.minMaxH(cc,pH(J,hval));style=$nim.dE(cc.id,'dlg_style');if((App&&$nim.themes[App.theme]=='v3.2')&&($nim.G.cu(cc,$nim._d)&& !$nim.G.cu(cc,$nim._p))){if(aj){isSurf=aj["ctype"].indexOf("surface")> -1;if(!isSurf){wadj=(2*pad);if((style&uGlb.caption)==uGlb.caption){hadj=title_hgt;}else{hadj=0;}if(h<hadj){hadj=hadj-pad;}hadj++;}}if((isNaN(w)===false)&&(w!==null)){$nim.G.cT(cc,w);if(aj){if(dhnd){$nim.G.cT(dhnd,w);}percwidth=100*((w-wadj)/w);$nim.G.cT(aj,percwidth.toFixed(6)+"%");percwidth=100*((w-(1.4*wadj))/w);if(dw){$nim.G.cT(dw,percwidth.toFixed(6)+"%");}}if(bf){if(w>36){$nim.G.cS(bf,((w-uDlg.resize_width)+(isSurf?4:1))+"px");}}}if((!$nim.G.cu(cc,$nim._d)&& !isNaN(h))||($nim.G.cu(cc,$nim._d))){if(h>=uDlg.min_height||isSurf){$nim.G.cz(cc,h);if($nim.G.cu(cc,$nim._k)){hadj=hadj+(pad*2.4);}if(aj){$nim.G.cz(aj,h-hadj);}if(dw){$nim.G.cz(dw,h-(pad*2.4));}h=h+(isSurf?(2*pad):(2*pad));if(bf){$nim.G.cN(bf,(h-uDlg.resize_height+(isSurf?2: -3))+"px");}}}}else{if(aj&&aj["ctype"].indexOf("surface")== -1){hadj=title_hgt;if(App&&$nim.themes[App.theme]!='v3.2'){wadj=2;}}if((isNaN(w)===false)&&(w!==null)){$nim.G.cT(cc,w);if(aj){if(dhnd){$nim.G.cT(dhnd,w-wadj);}percwidth=100;$nim.G.cT(aj,percwidth.toFixed(6)+"%");}if($nim.G.cu(cc,$nim._k)){$nim.G.cT(dfoot,w);}if(bf){$nim.G.cS(bf,(w-22)+"px");}}if((isNaN(h)===false)&&(h>hadj)){$nim.G.cz(cc,h);if(aj){if((style&uGlb.caption)==uGlb.caption){$nim.G.cz(aj,h-hadj);}else{$nim.G.cz(aj,h);}}if(bf){$nim.G.cN(bf,(h-22)+"px");}}}if(!K){if(!$f.getprop(de,'','stateTo')&&$f.getprop(de,'','state')=='-'){$f.setprop(de,'','state','restore');}}if($nim.dE(af.id,"scaletype")=='true'){$nim.ab.resizeFont(af);}}}else{$nim.G.ce($nim.aO.Size,arguments);}},Resize:function(de,K,w,h){var blRes=false,st,au=$nim.instN(de,''),cc=$f.cc(de,K);if((cc)&& !$nim.undef(cc["ctype"])){st=$nim.dE(cc.id,'stateTo');$nim._.drag.reSizeItems.length=0;$nim._.drag.zones.length=0;if($nim.G.cu(cc,$nim._d)){$nim.aO.Size(de,K,w,h);$nim.ab.resizeChildren(null,cc,false);if(!st&&dA($nim.dE(cc.id,'stimer'))==0){if(App&&de==KERNEL.curForm){if(App.Dialog[de]){$nim.G.TriggerDlgEvent(au,'Resize',null);}}$nim.G.updateDlgCoords(cc,st);}}}else{$nim.G.ce($nim.aO.Resize,arguments);}},GetSize:function(de,K){var ret=null;var cc=$f.cc(de,K);if(cc){if(cc.offsetWidth===0||cc.offsetHeight===0){ret={width:$nim.G.dk(cc)||cc.offsetWidth,height:$nim.G.dC(cc)||cc.offsetHeight};}else{ret={width:cc.offsetWidth,height:cc.offsetHeight};}}else{return $nim.G.ce($nim.aO.GetSize,arguments);}return ret;},BoxSize:function(de,K){var ret=null;var cc=$f.cc(de,K);if(cc){return $nim.G.boxSize(cc);}else{return $nim.G.ce($nim.aO.BoxSize,arguments);}},NaturalSize:function(de,K){var ret=null;var cc=$f.cc(de,K);if(cc){if(cc.naturalWidth&&cc.naturalHeight){ret={width:cc.naturalWidth,height:cc.naturalHeight,};}else{ret={width:$nim.G.dk(cc)||cc.offsetWidth,height:$nim.G.dC(cc)||cc.offsetHeight};}}else{return $nim.G.ce($nim.aO.NaturalSize,arguments);}return ret;},Push:function(de,bq){var ok,ctrl_name,dlgType,curApp,widgInst,widget;var inst=$f.getinstname(de),oinst=inst.resolveName('instform'),de=inst.resolveName('form');var cc=$f.cc(inst);if(cc){de=cc.getAttribute('model-data')||de;}if(App&&(cc||(App.Dialog&&App.Dialog[de]))){if(!App.Model.elemids[de]|| !App.Model.fields[de]){return;}if(!App.Model.record){App.Model.record={};}if(bq){App.Model.record[oinst]=bq;App.Model.object[oinst]=bq;}$nim.MODEL._saveObject(App.Model,de,App.Model.object[oinst],App.Model.fields[de]);if(App.Dialog[de]&&Object.keys(App.Dialog[de].Widgets).length>0){curApp=App.InstName;for(widget in App.Dialog[de].Widgets){$nim.SetId(curApp);widgInst=App.Dialog[de].Widgets[widget];ok=$nim.SetId(widgInst);ctrl_name=widget.resolveName('control');if(ok&&App.Model.enabled[ctrl_name]){if(bq[widget.resolveName('control')]){App.Model.record[oinst][ctrl_name]=bq[ctrl_name];App.Model.object[oinst][ctrl_name]=bq[ctrl_name];App.Model.push(ctrl_name);}}else{if(console&& !App.Model.enabled[ctrl_name]){console.log($nim["const"].model(widgInst.resolveName('app')+'.'+widgInst.resolveName('form'),'push'));}}}$nim.SetId(curApp);curApp=null;}$nim.MODEL.push(App.Model,de,inst+".body",false);}},Pull:function(de){var ok,ctrl_name,widgInst,widget;var inst=$f.getinstname(de),oinst=inst.resolveName('instform'),de=inst.resolveName('form');var cc=$f.cc(inst);if(cc){de=cc.getAttribute('model-data')||de;}if(App&&(cc||(App.Dialog&&App.Dialog[de]))){if(!App.Model.elemids[de]|| !App.Model.fields[de])return;if(!App.Model.record){App.Model.record={};}$nim.MODEL.pull(App.Model,de,$f.getinstname(de)+".body",false);App.Model.object[oinst]=$nim.MODEL._loadObject(App.Model.elemids[de],App.Model.fields[de]);if(!App.Model.record[oinst])App.Model.record[oinst]=$nim.copy(App.Model.object[oinst]);if(App.Dialog[de]&&Object.keys(App.Dialog[de].Widgets).length>0){var curApp=App.InstName;for(widget in App.Dialog[de].Widgets){$nim.SetId(curApp);widgInst=App.Dialog[de].Widgets[widget];ok=$nim.SetId(widgInst);ctrl_name=widget.resolveName('control');if(ok&&App.Model.enabled[ctrl_name]){var bq=App.Model.pull(ctrl_name);$nim.SetId(curApp);App.Model.object[oinst][ctrl_name]=bq;}else{if(console&& !App.Model.enabled[ctrl_name]){console.log($nim["const"].model(widgInst.resolveName('app')+'.'+widgInst.resolveName('form'),'pull'));}}}$nim.SetId(curApp);curApp=null;}if(App.Model.flattenOnPull[de]){return $nim.G.flattenValueObjects(App.Model.object[oinst]);}else{return App.Model.object[oinst];}}},Hide:function(de,K){var r=$nim.resolve(de,K);if(r.div){$nim.G.setDisplay(r.div,'none',false);r.div.style['visibility']="hidden";r.div.setAttribute('display','none');r.div.setAttribute('visible',false);var dlg=r.dlg.resolveName('form')||r.dlg;if(!K&&App&&App.Dialog&&App.Dialog[dlg]){$nim.SetId(dlg);$f.events(dlg,'Hide')(dlg,dlg.resolveName());$nim.SetId(dlg);}}else{$nim.G.ce($nim.aO.Hide,arguments);}},Show:function(de,K){var st,prvDisp,r=$nim.resolve(de,K,'bName');if(r.div){st=$f.getprop(r.dlg,'','state');if(!r.af&&st=='min'){$f.restore(r.dlg);}if($nim.undef(App.Previous)){$nim.G.AssignInstance(App,r.inst);}if(!r.af&& !st)$f.setprop(r.dlg,'','state','restore');prvDisp=(r.div.style['position']=='absolute')?(r.div.getAttribute('prv-display')||'inline-block'):r.div.getAttribute('prv-display');$nim.G.setDisplay(r.div,(r.div.tagName=='LI')?'block':prvDisp||'inline-block',false);r.div.style['visibility']="visible";r.div.setAttribute('display',(r.div.tagName=='LI')?'block':prvDisp||'inline-block');r.div.setAttribute('visible',true);$k.instance.setbyelemid(r.inst);if(App&&App.Dialog){if(!r.af&&App.Dialog[r.dlg]&&App.Dialog[r.dlg].Activate&& !App.Dialog[r.dlg].isActivated){App.Dialog[r.dlg].Activate();}}}else{$nim.G.ce($nim.aO.Show,arguments);}},isEnabled:function(de,K){var ret=true,r=$nim.resolve(de,K,'bName');if(r.div){if($nim.undef(App.Previous))$nim.G.AssignInstance(App,r.inst);ret=(r.div.getAttribute('disabled'))?false:ret;$k.instance.setbyelemid(r.inst);}else{ret=K?$nim.G.ce($nim.aO.isEnabled,arguments):ret;}return ret;},isVisible:function(de,K){var ret=false,r=$nim.resolve(de,K,'bName');if(r.div){if($nim.undef(App.Previous))$nim.G.AssignInstance(App,r.inst);ret=(r.div.style['visibility']=="hidden"||r.div.style['display']=="none")?false:true;$k.instance.setbyelemid(r.inst);}else{ret=K?$nim.G.ce($nim.aO.isVisible,arguments):ret;}return ret;},isWidget:function(de,K){var r=$nim.resolve(de,K);return $nim.G.isWidget(r.div);},eachForm:function(G){var dlg;for(dlg in App.Dialog){G&&G(dlg);}},eachControl:function(de,G){de=de||"";var x,ctrls,wDlg,widgets;if(App.Dialog[de]){$k.instance.save();ctrls=App.Dialog[de].Controls;widgets=App.Dialog[de].Widgets;for(wDlg in widgets){$k.instance.save();$nim.SetId(widgets[wDlg]);G&&G(widgets[wDlg].resolveName('instform'),'');$nim.aO.eachControl(widgets[wDlg].resolveName('form'),G);$k.instance.restore();}for(x=0;x<ctrls.length;x++){G&&G(de,ctrls[x]);}$k.instance.restore();}},Width:function(de,K,W){var G,r=$nim.resolve(de,K);G=(r.af)?'Size':'Resize';if(r.div){if(W)$nim.aO[G](r.dlg,r.af,$nim.pW(r.div.id,W),$nim.G.dC(r.div));else return r.div.offsetWidth||$nim.G.dk(r.div);}},Height:function(de,K,H){var G,r=$nim.resolve(de,K);G=(r.af)?'Size':'Resize';if(r.div){if(H)$nim.aO[G](r.dlg,r.af,$nim.G.dk(r.div),$nim.pH(r.div.id,H));else return r.div.offsetHeight||$nim.G.dC(r.div);}},WidthRange:function(de,K,minW,W,maxW){var r=$nim.resolve(de,K);$nim.cQ(r.inst,"min-width",minW);$nim.cQ(r.inst,"max-width",maxW);if(r.div){$nim.aO.Resize(r.dlg,r.af,$nim.pW(r.div.id,W),$nim.G.dC(r.div));}},HeightRange:function(de,K,minH,H,maxH){var r=$nim.resolve(de,K);$nim.cQ(r.inst,"min-height",minH);$nim.cQ(r.inst,"max-height",maxH);if(r.div){$nim.aO.Resize(r.dlg,r.af,$nim.G.dk(r.div),$nim.pH(r.div.id,H));}},MoveTo:function(de,K,nWx,nHy,nWw,nHh,speed,G){var cc,au=$nim.instN(de,K);var anim,J='',pW,pH;var nx,ny,nw,nh;pW=$nim.pW;pH=$nim.pH;cc=$f.cc(de,K);if(cc){$nim.by.cL(de,K,nWx,nHy);$nim.aO.Resize(de,K,nWw,nHh);J=(K)?$nim.instN(de):cc.getAttribute('parent');nx=pW(J,nWx);ny=pH(J,nHy);nw=pW(J,nWw);nh=pH(J,nHh);anim={method:'move',"elem":au,dlg:de,af:K,movdist:100,origdist:100,cdist:0,pos:100,chkpos:2,count:100,isVisible:$f.isvisible(de,K),nx:nx,ny:ny,nw:nw,nh:nh};KERNEL.Slide(anim);if(G)G(anim);}else{$nim.G.ce($nim.aO.MoveTo,arguments);}},SlideTo:function(de,K,nWx,nHy,nWw,nHh,speed,G){var anim,pW,pH,J='',cdist,slopx,slopy,cc,au;var nx,ny,nw,nh,cx,cy,cw,ch;pW=$nim.pW;pH=$nim.pH;if(globals.suppressliding){$nim.aO.MoveTo(de,K,nWx,nHy,nWw,nHh,speed,G);return;}G=(typeof(G)=='function')?G:null;au=$nim.instN(de,K);cc=$f.cc(de,K);if(cc){if(dA($nim.dE(cc.id,"stimer"))>0){$nim.aK.remove(dA($nim.dE(cc.id,'stimer')));$nim.df(cc.id,"stimer","0");}J=(K)?$nim.instN(de):cc.getAttribute('parent');nx=pW(J,nWx);ny=pH(J,nHy);nw=pW(J,nWw);nh=pH(J,nHh);cx=$nim.G.cX(cc)||cc.offsetLeft;cy=$nim.G.cF(cc)||cc.offsetTop;cw=$nim.G.dk(cc)||cc.offsetWidth;ch=$nim.G.dC(cc)||cc.offsetHeight;cdist=$k.distance(nx,ny,cx,cy);if(nw<=0){nw=cw;}if(nh<=0){nh=ch;}if((cdist<3)||(isNaN(cdist))){cdist=$k.distance(0,nw,0,cw);}if((cdist<3)||(isNaN(cdist))){cdist=$k.distance(0,nh,0,ch);}if(speed<0.002){speed=0.002;}if((nx-cx)!==0){slopx=(nx-cx)/cdist;}else{slopx=0;}if((ny-cy)!==0){slopy=(ny-cy)/cdist;}else{slopy=0;}anim={method:'move',"elem":au,dlg:de,af:K,movdist:0,origdist:cdist,cdist:cdist,pos:0,chkpos:2,count:0,decay:true,speed:speed,call:G,cx:cx,cy:cy,cw:cw,ch:ch,slopx:slopx,slopy:slopy,isVisible:$f.isvisible(de,K),nx:nx,ny:ny,nw:nw,nh:nh};return $nim.aK.add(cc,anim,25,KERNEL.Slide);}else{$nim.G.ce($nim.aO.SlideTo,arguments);}},CenterTo:function(de,K,nWx,nHy,nWw,nHh,speed,G){var anim,pW,pH,J,cdist,slopx,slopy,cc,au;var nx,ny,nw,nh,cx,cy,cw,ch;pW=$nim.pW;pH=$nim.pH;J='';G=(typeof(G)=='function')?G:null;au=$nim.instN(de,K);cc=$f.cc(de,K);if(cc){if(globals.suppressliding){nx=pW(J,nWx);ny=pH(J,nHy);nw=pW(J,nWw);nh=pH(J,nHh);cw=$nim.G.dk(cc);if(nw<=0)nw=cw;ch=$nim.G.dC(cc);if(nh<=0)nh=ch;$nim.aO.MoveTo(de,K,nx-(nw/2),ny-(nh/2),nw,nh,speed,G);return;}if(dA($nim.dE(cc.id,"stimer"))>0){$nim.aK.remove(dA($nim.dE(cc.id,'stimer')));$nim.df(cc.id,"stimer","0");}J=(K)?$nim.instN(de):cc.getAttribute('parent');nx=pW(J,nWx);ny=pH(J,nHy);nw=pW(J,nWw);nh=pH(J,nHh);cx=$nim.G.cX(cc);cy=$nim.G.cF(cc);cw=$nim.G.dk(cc);ch=$nim.G.dC(cc);if(nw<=0){nw=cw;}if(nh<=0){nh=ch;}cx=cx+(nw/2);cy=cy+(nh/2);cdist=$k.distance(nx,ny,cx,cy);if((cdist<3)||(isNaN(cdist))){cdist=$k.distance(0,nw,0,cw);}if((cdist<3)||(isNaN(cdist))){cdist=$k.distance(0,nh,0,ch);}if(speed==0){speed=0.20;}if((nx-cx)!==0){slopx=(nx-cx)/cdist;}else{slopx=0;}if((ny-cy)!==0){slopy=(ny-cy)/cdist;}else{slopy=0;}anim={method:'center',"elem":au,dlg:de,af:K,decay:true,speed:speed,call:G,cx:cx,cy:cy,cw:cw,ch:ch,movdist:0,origdist:cdist,cdist:cdist,slopx:slopx,slopy:slopy,nx:nx,ny:ny,nw:nw,nh:nh,count:0,isVisible:$f.isvisible(de,K),pos:0,chkpos:2};return $nim.aK.add(cc,anim,25,KERNEL.Slide);}else{$nim.G.ce($nim.aO.CenterTo,arguments);}},Flip:function(de,fdir,interval,G){var cc=$f.cc(de,'');var yAng=0,xAng=0;G=(typeof(G)=='function')?G:null;if(cc&&interval>=2&&dA($nim.dE(cc.id,'rtimer'))==0){if($nim.dE(cc.id,'facing')===null){$nim.df(cc.id,'facing',"face");}switch(fdir){case 'h':case 'horiz':case 'horizontal':if($nim.dE(cc.id,'facing')=="face"){$nim.df(cc.id,'facing',"back");yAng=180/interval;}else{$nim.df(cc.id,'facing',"face");yAng= -180/interval;}break;case 'v':case 'vert':case 'vertical':if($nim.dE(cc.id,'facing')=="face"){$nim.df(cc.id,'facing',"back");xAng=180/interval;}else{$nim.df(cc.id,'facing',"face");xAng= -180/interval;}break;default:break;}return $f.rotateto(de,"",{x:xAng,y:yAng,z:0},interval,function(anim){var bq=anim.dialog.resolveName();var cc=$nim.am(anim.dialog),start=$nim.am('start.'+anim.dialog),back=$nim.am(anim.dialog+'.page.back');$nim.SetId(anim.dialog);switch(anim.count){case(anim.halfstep):if($nim.dE(cc.id,'facing')=="face"){if(cc.getAttribute('toggleonflip')!="false"){$f.hide(bq.Form,'page.back');$f.show(bq.Form,'body');}if(start){start.style['z-index']='1000';}if(back){back.style['z-index']='-1';}}else{if(cc.getAttribute('toggleonflip')!="false"){$f.hide(bq.Form,'body');$f.show(bq.Form,'page.back');}if(start){start.style['z-index']='-1';}if(back){back.style['z-index']='1000';}}break;case(0):if($nim.dE(cc.id,'facing')=="face"){$nim.G.setElemStyle('start.',anim.dialog.resolveName('form'),'pointer-events','auto');}else{$nim.G.setElemStyle('start.',anim.dialog.resolveName('form'),'pointer-events','none');}if($nim.Agent.usingIE){$f.refresh(bq.Form);}G&&G(anim);break;default:break;}});}else{$nim.G.ce($nim.aO.Flip,arguments);}},Switch:function(old_dlg,new_dlg,blPos,blSize){var st,coords;if($f.isloaded(old_dlg)){st=$f.state(old_dlg);if(blPos||blSize)coords=$f.getcoords(old_dlg);$f.unload(old_dlg);$f.load(new_dlg);if(st=='restore'){$f.restore(new_dlg);if(coords&&blPos)$f.setpos(new_dlg,'',coords.left,coords.top);if(coords&&blSize)$f.resize(new_dlg,'',coords.width,coords.height);}else{$f[st](new_dlg);}$f.show(new_dlg);}},RotateTo:function(de,K,deg,count,G){var rtimer,anim,cc,au;G=(typeof(G)=='function')?G:null;au=$nim.instN(de,K);cc=$f.cc(de,K);if(cc){$nim.C.fC(cc);if(dA($nim.dE(cc.id,"rtimer"))==0){anim={"elem":au,dlg:de,af:K,step:deg,halfstep:Math.floor(count/2),count:count,call:G};rtimer=setInterval(function(){KERNEL.Rotate(anim);},30);anim._timer=rtimer;$nim.df(cc.id,"rtimer",rtimer);return rtimer;}else if(count<1){window.clearInterval(dA($nim.dE(cc.id,'rtimer')));$nim.df(cc.id,"rtimer","0");}}else{$nim.G.ce($nim.aO.RotateTo,arguments);}}});$nim.route=function(bq,arr,delim){var ret=true;var chk=bq;if(typeof(arr)=='string')arr=arr.split(delim||',');arr.forEach(function(aM){if(chk[aM]){chk=chk[aM];}else{ret=false;}});return ret;};$nim.bName=$nim.aO.aa;$nim.am=$nim.aO.am;$nim.instN=$nim.aO.au;$nim.df=$nim.by.df;$nim.dE=$nim.by.dE;$nim.cQ=$nim.by.cQ;$nim.dj=$nim.by.dj;$nim.aX=$nim.C.aX;$nim.Menu=$nim.C.Menu;$nim.defaultTick=$nim.by.defaultTick;$nim.StatusBar=$nim.C.StatusBar;$nim.ToolBar=$nim.C.ToolBar;$nim.Tooltip=$nim.C.Tooltip;$nim.G.zindex={'-5':0,'-4':Math.floor($nim.ab.MOVE2BOTTOM/4),'-3':Math.floor($nim.ab.MOVE2BOTTOM/2),'-2':$nim.ab.MOVE2BOTTOM,'-1':$nim.ab.MOVE2BACK,'0':$nim.ab.MOVE2MID,'1':$nim.ab.MOVE2TOP,'2':$nim.ab.MOVE2DRAG,'3':$nim.ab.MOVE2TOPMOST,'4':$nim.ab.POPUP+100,'5':$nim.ab.POPUP+200,'6':$nim.ab.POPUP+300,'7':$nim.ab.POPUP+400,'10':999999999};$nim.Key={_last:null,Code:null,isCtrl:false,isAlt:false,isShift:false,detectKeys:function(evtobj){var bS;$nim.Key.isAlt=evtobj.altKey;$nim.Key.isCtrl=evtobj.ctrlKey;$nim.Key.isShift=evtobj.shiftKey;$nim.Key.Info=evtobj.code||'';$nim.Key.Code=evtobj.keyCode;$nim.Key.Char=($nim.Key.Code>31&&$nim.Key.Code<128)?String.fromCharCode(evtobj.keyCode):'';bS=[27,13,37,38,39,40,32,46,8,33,34,35,36].indexOf(evtobj.keyCode);if(bS> -1)$nim.Key.Char=['Esc','Enter','Left','Up','Right','Down','Space','Del','BkSpce','PgUp','PgDown','End','Home'][bS];},downKeyEvent:function(evtobj){var audio;var aJ=evtobj&&evtobj.target?(evtobj.target.tagName.toLowerCase()||''):'';if(KERNEL&& !KERNEL.keyEvent){if(keyTmr){clearTimeout(keyTmr);keyTmr=0;}keyTmr=setTimeout(function(){try{KERNEL.keyEvent=true;if($nim.cn.sounds.typed_key!==''){audio=new Audio($nim.cn.sounds.typed_key);audio.play();}$nim.Key.detectKeys(evtobj);if(($nim.bi!==null)&&(!$nim.undef($nim.bi))){if(ad[0]&&ad[0].instanceOf=='desktop'){if(evtobj.keyCode==13&&ad[0].EnterKey){ad[0].EnterKey(KERNEL.curForm);}else if(ad[0].KeyPress){ad[0].KeyPress(KERNEL.curForm);}}if(evtobj.keyCode==13&&$nim.bi.EnterKey){$nim.bi.EnterKey(KERNEL.curForm);}else if($nim.bi.KeyPress){if(['textarea','input'].indexOf(aJ)== -1){$nim.G.triggerHotKey();}$nim.bi.KeyPress(KERNEL.curForm);}}}catch(err){}finally{KERNEL.keyEvent=false;}},25);}},upKeyEvent:function(evtobj){if(KERNEL&& !KERNEL.keyEvent){if(keyTmr){clearTimeout(keyTmr);keyTmr=0;}keyTmr=setTimeout(function(){try{KERNEL.keyEvent=true;$nim.Key.detectKeys(evtobj);if(evtobj.target&&evtobj.target.onchange){evtobj.target.onchange(evtobj);}if(($nim.bi!==null)&&(!$nim.undef($nim.bi))){if(ad[0]&&ad[0].instanceOf=='desktop'&&ad[0].KeyUp){ad[0].KeyUp(KERNEL.curForm);}if($nim.bi.KeyUp){$nim.bi.KeyUp(KERNEL.curForm);}}}catch(err){}finally{KERNEL.keyEvent=false;}},25);}}};var _cos={},_sin={},keyTmr;for(var x=0;x<=360;x++){_cos[x]=Math.cos(3.1457*x/180);_sin[x]=Math.sin(3.1457*x/180);}if($nim.Agent.usingIE===false){window.onbeforeunload=function(){var x,F,ret=null;for(x=1,F=ad.length;x<F;x++){if(ad[x].App.isLoaded){if(ad[x].Vars.running){ret="There are apps running.";break;}}}return ret;};}window.addEventListener("keydown",$nim.Key.downKeyEvent);window.addEventListener("keyup",$nim.Key.upKeyEvent);window.addEventListener("mouseup",$nim.Mouse.onmouseup);window.addEventListener("mousedown",$nim.Mouse.onmousedown);window.addEventListener("mousemove",$nim.Mouse.onmousemove);window.addEventListener("click",$nim.Mouse.click);window.addEventListener("orientationchange",$nim.ax.onorientationchange);window.addEventListener("resize",$nim.ax.onresize);document.ready=function(){$nim._.core.docDimensions=$nim.ax.findDocumentDimensions();$nim._.core.winDimensions=$nim.ax.findWindowDimensions();DESKTOP.width=$nim._.core.winDimensions.width;$nim.ax.buildKey();};document.onabort=function(){var x,F;for(x=0,F=ad.length;x<F;x++){if(ad[x].App.isLoaded){if(ad[x].Vars.running){ad[x].NoStart();}}}};document.onunload=function(){var x,F;for(x=0,F=ad.length;x<F;x++){if(ad[x].App.isLoaded){if(ad[x].Logoff&&ad[x].InstName){ad[x].Logoff();}if(ad[x].Vars.running){ad[x].Close();}}}};document.title="";document.onselectstart=function(){return false;};$nim.G.isDocVisible(function(){if($nim.G.isDocVisible()){if(DESKTOP){DESKTOP.visible=true;}}else{if(DESKTOP){DESKTOP.visible=false;}}});if($nim.Agent.isMobile){window.addEventListener("touchstart",function(e){e.preventDefault();$nim.Mouse.onmousedown(e);});window.addEventListener("touchend",function(e){e.preventDefault();$nim.Mouse.onmouseup(e);$nim.Mouse.click(e);});window.addEventListener("touchmove",function(e){e.preventDefault();$nim.Mouse.onmousemove(e);});}if(!$nim.HTML){$nim.HTML={};} 
'use strict';$nim.MODEL=cU({_loadValue:function(aJ,ctype){var p,dB,options,index,value,name,O=document;var cc=$f.find(aJ,"");switch(ctype){case "textbox":case "textarea":value=cc.value;break;case "multilist":cc=$f.find(aJ+$nim.aY+"items","");if(cc!==null){value=[];for(p=0,dB=cc.options.length;p<dB;p++){if(cc.options[p].selected===true){value.push(cc.options[p].value);}}}break;case "listbox":case "combobox":cc=$f.find(aJ+$nim.aY+"items","");if(cc!==null){index=cc.selectedIndex;if(index>=0){value=cc.options[index].value;}break;}break;case "option":case "option-left":case "option-right":break;case "optiongrp":case "optiongrp-left":case "optiongrp-right":name=cc.getAttribute('name');options=O.getElementsByName(name);for(p=0,dB=options.length;p<dB;p++){if(options[p].checked){value=options[p].value;}}break;case "checkbox":case "checkbox-left":case "checkbox-right":value=$f.getvalue(aJ.resolveName('instform'),aJ.resolveName('control'));break;case "image":case "imagex":case "picclip":value=cc.src;break;case "imgbutton":value=cc.src;break;default:break;}if(typeof(value)=="string"){value=$nim.aX({"'":"\'",'"':'\"','\\"':'\"',"\\'":"\'"},null,value);}O=null;return value;},_loadCaption:function(aJ,ctype){var p,dB,name,options,icaption="",O=document;var cc=$f.find(aJ,"");switch(ctype){case "label":case "label-left":case "label-right":case "label-center":case "button":icaption=$f.gettext(aJ.resolveName('instform'),aJ.resolveName('control'));break;case "option":case "option-left":case "option-right":break;case "optiongrp":case "optiongrp-left":case "optiongrp-right":name=cc.getAttribute('name');options=O.getElementsByName(name);for(p=0,dB=options.length;p<dB;p++){if(options[p].checked){icaption=$f.gettext(options[p].id.resolveName('instform'),options[p].id.resolveName('control'));}}break;case "checkbox":case "checkbox-left":case "checkbox-right":icaption=$f.gettext(aJ.resolveName('instform'),aJ.resolveName('control'));break;case "imgbutton":icaption=$f.gettext(aJ.resolveName('instform'),aJ.resolveName('control'));break;default:break;}if(typeof(icaption)=="string"){icaption=$nim.aX({"'":"\'",'"':'\"','\\"':'\"',"\\'":"\'"},null,icaption);}O=null;return icaption;},_loadList:function(aJ,ctype){var p,dB,name,options,value=null,O=document;var cc=$f.find(aJ,"");switch(ctype){case "listbox":case "combobox":case "multilist":value=[];cc=$f.find(aJ+$nim.aY+"items","");for(p=0,dB=cc.options.length;p<dB;p++){value.push(cc.options[p].text);}break;case "option":case "option-left":case "option-right":break;case "optiongrp":case "optiongrp-left":case "optiongrp-right":name=cc.getAttribute('name');options=O.getElementsByName(name);for(p=0,dB=options.length;p<dB;p++){value.push($f.gettext(options[p].id.resolveName('instform'),options[p].id.resolveName('control')));}break;default:break;}O=null;return value;},_loadSelected:function(aJ,ctype){var p,dB,name,options,value=null,O=document;var cc=$f.find(aJ,"");switch(ctype){case "listbox":case "combobox":case "multilist":value=[];cc=$f.find(aJ+$nim.aY+"items","");for(p=0,dB=cc.options.length;p<dB;p++){if(cc.options[p].selected===true){value.push(cc.options[p].value);}}break;case "option":case "option-left":case "option-right":break;case "optiongrp":case "optiongrp-left":case "optiongrp-right":name=cc.getAttribute('name');options=O.getElementsByName(name);for(p=0,dB=options.length;p<dB;p++){if(options[p].checked){value=options[p].value;}}break;default:break;}O=null;return value;},_loadObject:function(bW,bU){var p,c,dB,cc,value,key,bb,self=this;var ct={};if((bW.length>0)&&(bW.length==bU.length)){for(p=0,dB=bW.length;p<dB;p++){bb=bU[p].toLowerCase();if(bb.indexOf('-')> -1){cc=$nim.G.V(bW[p]);if(cc!==null){value=self._loadValue(cc.id,cc["ctype"]);var bZ=bb.split("-");var tmp=ct;for(c=0;c<bZ.length;c++){if(c==(bZ.length-1)){tmp[bZ[c]]=value;}else{if($nim.undef(tmp[bZ[c]])){tmp[bZ[c]]={};}}if(Array.isArray(tmp[bZ[c]]))tmp=tmp[bZ[c]][0];else tmp=tmp[bZ[c]];}}}else{cc=$nim.G.V(bW[p]);if(cc!==null){value=self._loadValue(cc.id,cc["ctype"]);if(!$nim.undef(value)){ct[bb]=value;}switch(cc["ctype"]){case "label":case "label-left":case "label-right":case "label-center":case "button":key=bb+"_caption";ct[key]=self._loadCaption(cc.id,cc["ctype"]);ct[bb]=self._loadCaption(cc.id,cc["ctype"]);break;case "option":case "option-left":case "option-right":break;case "optiongrp":case "optiongrp-left":case "optiongrp-right":key=bb+"_caption";ct[key]=self._loadCaption(cc.id,cc["ctype"]);break;case "checkbox":case "checkbox-left":case "checkbox-right":key=bb+"_caption";ct[key]=self._loadCaption(cc.id,cc["ctype"]);break;case "imgbutton":key=bb+"_caption";ct[key]=self._loadCaption(cc.id,cc["ctype"]);break;default:break;}}}}}return ct;},_lCaseObject:function(inObj){var outObj={};var aM,lCaseField;for(aM in inObj){lCaseField=aM.toLowerCase();outObj[lCaseField]=inObj[aM];}return outObj;},_saveObject:function(bz,de,inObj,bU){var p,c,q,dB,qlen,name,value='',cc,elemId,key,options,bb,O=document;if(bU.length>0){var modelObj=$nim.MODEL._lCaseObject(inObj);for(p=0,dB=bU.length;p<dB;p++){bb=bU[p].toLowerCase();if(bb.indexOf('-')> -1){if(!$nim.undef(bz.data[de][bb])){elemId=bz.data[de][bb].aJ;}cc=$nim.G.V(elemId);if(cc!==null){var bZ=bb.split("-");var tmp=modelObj;for(c=0;c<bZ.length;c++){if(c==(bZ.length-1)){value=tmp[bZ[c]];}if(Array.isArray(tmp[bZ[c]])){tmp=tmp[bZ[c]][0];}else{tmp=tmp[bZ[c]];}}}bz.data[de][bb].value=value;}else{if($nim.undef(bz.data[de][bb])){bz.data[de][bb]={};}if(!$nim.undef(bz.data[de][bb].aJ)){elemId=bz.data[de][bb].aJ;}cc=$nim.G.V(elemId);if(cc!==null){switch(bz.data[de][bb]["ctype"]){case "label":case "label-left":case "label-right":case "label-center":case "button":key=bb+"_caption";if(!$nim.undef(modelObj[key])){bz.data[de][bb].caption=modelObj[key];}else{bz.data[de][bb].caption=modelObj[bb];}bz.data[de][bb].value=modelObj[bb];break;case "textbox":case "textarea":bz.data[de][bb].value=modelObj[bb];break;case "multilist":cc=$f.find(elemId+$nim.aY+"items","");for(q=0,qlen=cc.options.length;q<qlen;q++){if(cc.options[q].value==modelObj[bb]){bz.data[de][bb].value=modelObj[bb];}}break;case "listbox":case "combobox":cc=$f.find(elemId+$nim.aY+"items","");for(q=0,qlen=cc.options.length;q<qlen;q++){if(cc.options[q].value==modelObj[bb]){bz.data[de][bb].index=q;bz.data[de][bb].value=modelObj[bb];}}break;case "optiongrp":case "optiongrp-left":case "optiongrp-right":name=cc.getAttribute('name');options=O.getElementsByName(name);for(q=0,qlen=options.length;q<qlen;q++){if(options[q].value==modelObj[bb]){bz.data[de][bb].value=modelObj[bb];}}break;case "checkbox":case "checkbox-left":case "checkbox-right":bz.data[de][bb].value=modelObj[bb];key=bb+"_caption";bz.data[de][bb].caption=modelObj[key];break;case "image":case "imagex":case "picclip":bz.data[de][bb].src=modelObj[bb];bz.data[de][bb].value=modelObj[bb];break;case "imgbutton":bz.data[de][bb].src=modelObj[bb];bz.data[de][bb].value=modelObj[bb];key=bb+"_caption";bz.data[de][bb].caption=modelObj[key];break;default:break;}}}}}O=null;},_loadArrayElmIds:function(dlg,filter,filterval){var i,ilen,aE,dN,ibody=$nim.G.V(dlg),ct=[];if(ibody!==null){if(ibody.childNodes.length>0){for(i=0,ilen=ibody.childNodes.length;i<ilen;i++){var key=null;aE=ibody.childNodes[i];key=$nim.aX($nim.aY+"div","",aE.id);dN=$nim.G.V(key);switch(filter){case 'element':switch(filter){case 'div':if(aE!==null){ct.push(aE.id);}break;case 'elem':if(dN!==null){ct.push(dN.id);}break;default:break;}break;case 'type=':if(filterval=="default"){switch(aE["ctype"]){case "textbox":case "textarea":case "multilist":case "listbox":case "combobox":case "label":case "label-left":case "label-right":case "label-center":case "button":case "option":case "option-left":case "option-right":case "optiongrp":case "optiongrp-left":case "optiongrp-right":case "checkbox":case "checkbox-left":case "checkbox-right":case "image":case "imagex":case "picclip":case "imgbutton":ct.push(dN.id);break;default:break;}}else if(aE["ctype"]==filterval){ct.push(dN.id);}break;case 'type!=':if(aE["ctype"]!=filterval){ct.push(dN.id);}break;default:break;}}}}return ct;},_loadArrayValues:function(bW){var p,dB,cc,self=this;var ct=[];if(bW.length>0){for(p=0,dB=bW.length;p<dB;p++){cc=$nim.G.V(bW[p]);if(cc!==null){ct.push(self._loadValue(bW[p],cc["ctype"]));}}}return ct;},_loadArrayCaptions:function(bW){var p,dB,cc,ct=[];if(bW.length>0){for(p=0,dB=bW.length;p<dB;p++){cc=$nim.G.V(bW[p]);if(cc!==null){ct.push(self._loadCaption(bW[p],cc["ctype"]));}}}return ct;},_loadArrayBindIds:function(bW){var p,dB,cc,ct=[];if(bW.length>0){for(p=0,dB=bW.length;p<dB;p++){cc=$nim.G.V(bW[p]);if(cc!==null){ct.push($nim.dE(cc.id,"bindid"));}}}return ct;},_loadRowArray:function(tableNme,rowId,co){var p,dB,row,col,table=$nim.G.V(tableNme),ct=[];if(table!==null){if(rowId> -1&&rowId<table.rows.length){row=table.rows[rowId];if(co.length>0){for(p=0,dB=co.length;p<dB;p++){if(co[p]> -1&&co[p]<row.cells.length){col=row.cells[co[p]];ct.push(col.innerHTML);}else{ct.push("");}}}}}return ct;},_loadRowObject:function(tableNme,bU,rowId,co){var p,dB,row,col,bb,table=$nim.G.V(tableNme),ct=[];if(table!==null){if(rowId> -1&&rowId<table.rows.length){row=table.rows[rowId];if(co.length>0){for(p=0,dB=co.length;p<dB;p++){if(co[p]> -1&&co[p]<row.cells.length){col=row.cells[co[p]];if(p> -1&&p<bU.length){bb=bU[p].toLowerCase();ct[bb]=col.innerHTML;}}}}}}return ct;},_loadColArray:function(tableNme,colId,aryRowIds){var p,dB,row,col,table=$nim.G.V(tableNme),ct=[];if(table!==null){if(aryRowIds.length>0){for(p=0,dB=aryRowIds.length;p<dB;p++){if(aryRowIds[p]> -1&&aryRowIds[p]<table.row.length){row=table.rows[aryRowIds[p]];if(colId> -1&&colId<row.cells.length){col=row.cells[colId];ct.push(col.innerHTML);}else{ct.push("");}}}}}return ct;},_loadColObject:function(tableNme,bU,colId,aryRowIds){var p,dB,row,col,bb,table=$nim.G.V(tableNme),ct=[];if(table!==null){if(aryRowIds.length>0){for(p=0,dB=aryRowIds.length;p<dB;p++){if(aryRowIds[p]> -1&&aryRowIds[p]<table.rows.length){row=table.rows[aryRowIds[p]];if(colId> -1&&colId<row.cells.length){col=row.cells[colId];if(aryRowIds[p]> -1&&aryRowIds[p]<bU.length){bb=bU[p].toLowerCase();ct[bb]=col.innerHTML;}}}}}}return ct;},pull:function(bz,de,dp,recurse,prefix){var tabNme,ay,bq,aM,an,i,p,ilen,dB,dlg,options,aE,dN,ai,icaption=null,idisplay=null,idisabled=null,value=null,index=null,bind=null,bV=null,name=null,key=null,isrc=null,cc,O=document;var ibody=$nim.G.V(dp);recurse=(recurse)?recurse:0;prefix=(prefix)?prefix:"";if(prefix!==''){prefix+="-";}if(bz&&(!recurse)){if(!bz.record)bz.record={};if(!bz.fields)bz.fields={};bz.fields[de]=[];if(!bz.elemids)bz.elemids={};bz.elemids[de]=[];}if(ibody!==null){if(ibody.childNodes.length>0){$f.events(de,'OnPull')(dp.resolveName('instform'));for(i=0,ilen=ibody.childNodes.length;i<ilen;i++){icaption=null;bind=null,bV=null;name=null;key=null;value=null;index=null;isrc=null;aE=ibody.childNodes[i];if(aE&&aE.getAttribute){key=$nim.aX($nim.aY+"div","",aE.id);aM=key.split($nim.aY);name=$nim.aX(" ","",aM[1]);if(recurse<globals._services.recurselimit){switch(aE["ctype"]){case "tab":ai=$nim.dE(aE.id,'pages');for(p=1;p<=ai;p++){tabNme=aE.id;tabNme=$nim.aX($nim.aY+"div",$nim.aY+"page"+p+$nim.aY+"body",tabNme);bq=tabNme.resolveName();$nim.MODEL.pull(bz,de,tabNme,recurse+1,bq.Control);}break;case "div":recurse++;bq=aE.id.resolveName();$nim.MODEL.pull(bz,de,aE.id,recurse,"");break;case "panel":recurse++;ay=$nim.aX($nim.aY+"div",$nim.aY+"body",aE.id);bq=ay.resolveName();$nim.MODEL.pull(bz,de,ay,recurse,bq.Control);break;case "panellist":case "panel-list":ai=aE.getAttribute('count');for(p=1;p<=ai;p++){ay=$nim.aX($nim.aY+"div",$nim.aY+p+$nim.aY+"body",aE.id);bq=ay.resolveName();$nim.MODEL.pull(bz,de,ay,recurse+1);}break;default:break;}}bind=$nim.dE(aE.id,"bind");bV=prefix+$nim.dE(aE.id,"bindid");if(bind=="true"||bV){dN=$nim.G.V(key);if(dN){dlg=dp.resolveName('forminst');switch(aE["ctype"]){case "textbox":case "textarea":if((bz.fields[de].indexOf(bV)== -1)&&(bz.elemids[de].indexOf(dN.id)== -1)){bz.fields[de].push(bV);bz.elemids[de].push(dN.id);}value=dN.value;break;case "multilist":if((bz.fields[de].indexOf(bV)== -1)&&(bz.elemids[de].indexOf(dN.id)== -1)){bz.fields[de].push(bV);bz.elemids[de].push(dN.id);}cc=$f.find(dlg,name+$nim.aY+"items");if(cc!==null){value=[];cc=$f.find(key+$nim.aY+"items","");for(p=0,dB=cc.options.length;p<dB;p++){if(cc.options[p].selected===true){value.push(cc.options[p].value);}}}break;case "listbox":case "combobox":if((bz.fields[de].indexOf(bV)== -1)&&(bz.elemids[de].indexOf(dN.id)== -1)){bz.fields[de].push(bV);bz.elemids[de].push(dN.id);}cc=$f.find(dlg,name+$nim.aY+"items");if(cc!==null){index=cc.selectedIndex;if(index>=0){value=cc.options[index].value;}}break;case "label":case "label-left":case "label-right":case "label-center":if((bz.fields[de].indexOf(bV)== -1)&&(bz.elemids[de].indexOf(dN.id)== -1)){bz.fields[de].push(bV);bz.elemids[de].push(dN.id);}icaption=null;value=$f.gettext(dlg,name);break;case "button":if((bz.fields[de].indexOf(bV)== -1)&&(bz.elemids[de].indexOf(dN.id)== -1)){bz.fields[de].push(bV);bz.elemids[de].push(dN.id);}icaption=$f.gettext(dlg,name);value=$f.gettext(dlg,name);break;case "option":case "option-left":case "option-right":break;case "optiongrp":case "optiongrp-left":case "optiongrp-right":if((bz.fields[de].indexOf(bV)== -1)&&(bz.elemids[de].indexOf(dN.id)== -1)){bz.fields[de].push(bV);bz.elemids[de].push(dN.id);}name=dN.getAttribute('name');options=O.getElementsByName(name);for(p=0,dB=options.length;p<dB;p++){if(options[p].checked){value=options[p].value;icaption=$f.gettext(dlg,options[p].id);}}break;case "checkbox":case "checkbox-left":case "checkbox-right":if((bz.fields[de].indexOf(bV)== -1)&&(bz.elemids[de].indexOf(dN.id)== -1)){bz.fields[de].push(bV);bz.elemids[de].push(dN.id);}value=$f.getvalue(dlg,name);icaption=$f.gettext(dlg,name);break;case "image":case "imagex":case "picclip":if((bz.fields[de].indexOf(bV)== -1)&&(bz.elemids[de].indexOf(dN.id)== -1)){bz.fields[de].push(bV);bz.elemids[de].push(key+$nim.aY+'image');}value=$nim.G.V(key+$nim.aY+'image').src;break;case "imgbutton":if((bz.fields[de].indexOf(bV)== -1)&&(bz.elemids[de].indexOf(dN.id)== -1)){bz.fields[de].push(bV);bz.elemids[de].push(key+$nim.aY+'image');}value=$nim.G.V(key+$nim.aY+'image').src;icaption=$f.gettext(dlg,name);break;default:break;}if(key){an={};if(!$nim.undef(icaption)){an.caption=icaption;}if(!$nim.undef(value)){an.value=value;}if(!$nim.undef(index)){an.index=index;}if(!$nim.undef(isrc)){an.src=isrc;}if(!$nim.undef(dN.disabled)){an.disabled=dN.disabled;}an.display=dN.style.display;if(an.display===""){an.display="inline";}an.elemdiv=aE.id;an.aJ=dN.id;if($nim.undef(bz.data[de])){bz.data[de]={};}if($nim.undef(bz.data[de][bV])){bz.data[de][bV]={};}var refObj=bz.data[de][bV];if(!$nim.undef(an.caption)){refObj.caption=an.caption;}if(!$nim.undef(an.value)){refObj.value=an.value;}if(!$nim.undef(an.index)){refObj.index=an.index;}if(!$nim.undef(an.src)){refObj.src=an.src;}if(!$nim.undef(an.disabled)){refObj.disabled=an.disabled;}refObj.display=an.display;refObj["ctype"]=aE["ctype"];refObj.elemdiv=an.elemdiv;refObj.aJ=an.aJ;}}}}}$f.events(de,'AfterPull')(dp.resolveName('instform'));}}},push:function(bz,de,dp,recurse,prefix){var p,q,i,ilen,qlen,dB,tabNme,ay,aM,dlg,bq,options,aE,dN,ai,icaption=null,idisplay=null,idisabled=null,value=null,index=null,bind=null,bV=null,name=null,key=null,isrc=null,cc,O=document;var ibody=$nim.G.V(dp);recurse=(recurse)?recurse:0;prefix=(prefix)?prefix:"";if(prefix!==''){prefix+="-";}if(ibody!==null){if(ibody.childNodes.length>0){$f.events(de,'OnPush')(dp.resolveName('instform'));for(i=0,ilen=ibody.childNodes.length;i<ilen;i++){icaption=null,idisplay=null,idisabled=null,value=null,index=null,bind=null,bV=null,name=null,key=null,isrc=null,aE=ibody.childNodes[i];if(aE&&aE.getAttribute){key=$nim.aX($nim.aY+"div","",aE.id);aM=key.split($nim.aY);name=$nim.aX(" ","",aM[1]);dN=$nim.G.V(key);if(recurse<globals._services.recurselimit){switch(aE["ctype"]){case "tab":ai=$nim.dE(aE.id,'pages');for(p=1;p<=ai;p++){tabNme=$nim.aX($nim.aY+"div",$nim.aY+"page"+p+$nim.aY+"body",aE.id);bq=tabNme.resolveName();$nim.MODEL.push(bz,de,tabNme,recurse+1,bq.Control);}break;case "div":recurse++;bq=aE.id.resolveName();$nim.MODEL.push(bz,de,aE.id,recurse,"");break;case "panel":recurse++;ay=$nim.aX($nim.aY+"div",$nim.aY+"body",aE.id);bq=ay.resolveName();$nim.MODEL.push(bz,de,ay,recurse,bq.Control);break;case "panellist":case "panel-list":ai=aE.getAttribute('count');for(p=1;p<=ai;p++){ay=$nim.aX($nim.aY+"div",$nim.aY+p+$nim.aY+"body",aE.id);bq=ay.resolveName();$nim.MODEL.push(bz,de,ay,recurse+1,bq.Control);}break;default:break;}}bind=$nim.dE(aE.id,"bind");bV=prefix+$nim.dE(aE.id,"bindid");if(bind=="true"||bV){key=aE.id;if(key){if($nim.undef(bz.data[de][bV])){bz.data[de][bV]={};}value=bz.data[de][bV].value;index=bz.data[de][bV].index||null;icaption=bz.data[de][bV].caption||undefined;idisplay=bz.data[de][bV].display||undefined;idisabled=bz.data[de][bV].disabled||undefined;dlg=dp.resolveName('forminst');switch(aE["ctype"]){case "textbox":case "textarea":if((bz.fields[de].indexOf(bV)== -1)&&(bz.elemids[de].indexOf(dN.id)== -1)){bz.fields[de].push(bV);bz.elemids[de].push(dN.id);}if(!$nim.undef(value))dN.value=value;break;case "multilist":if((bz.fields[de].indexOf(bV)== -1)&&(bz.elemids[de].indexOf(dN.id)== -1)){bz.fields[de].push(bV);bz.elemids[de].push(dN.id);}cc=$f.find(dlg,name+$nim.aY+"items");if(cc!==null){value=value;if(!$nim.undef(value)){for(q=0,qlen=value.length;q<qlen;p++){for(p=0,dB=cc.options.length;p<dB;p++){if(cc.options[p].value==value[q]){cc.options[p].selected=true;}}}}}break;case "listbox":case "combobox":if((bz.fields[de].indexOf(bV)== -1)&&(bz.elemids[de].indexOf(dN.id)== -1)){bz.fields[de].push(bV);bz.elemids[de].push(dN.id);}cc=$f.find(dlg,name+$nim.aY+"items");if(cc!==null){if(!$nim.undef(index)){cc.selectedIndex=index;}if(!$nim.undef(value)){cc.value=value;}}break;case "label":case "label-left":case "label-right":case "label-center":if(!$nim.undef(icaption)){$f.settext(dlg,name,icaption);}else if(!$nim.undef(value)){$f.settext(dlg,name,value);}break;case "button":if(!$nim.undef(icaption)){$f.setcaption(dlg,name,icaption);}else if(!$nim.undef(value)){$f.setcaption(dlg,name,value);}break;case "optiongrp":case "optiongrp-left":case "optiongrp-right":if((bz.fields[de].indexOf(bV)== -1)&&(bz.elemids[de].indexOf(dN.id)== -1)){bz.fields[de].push(bV);bz.elemids[de].push(dN.id);}if(!$nim.undef(value)){name=dN.getAttribute('name');options=O.getElementsByName(name);for(p=0,qlen=options.length;p<qlen;p++){if(options[p].value==value){options[p].selected=true;}else{options[p].selected=false;}}}break;case "option":case "option-left":case "option-right":case "checkbox":case "checkbox-left":case "checkbox-right":if((bz.fields[de].indexOf(bV)== -1)&&(bz.elemids[de].indexOf(dN.id)== -1)){bz.fields[de].push(bV);bz.elemids[de].push(dN.id);}if(!$nim.undef(value)){$f.setchecked(dlg,name,value);}if(!$nim.undef(icaption)){$f.settext(dlg,name,icaption);}break;case "image":case "imagex":case "picclip":cc=$f.find(dlg,name+$nim.aY+"image");if(!$nim.undef(value)){cc.src=value;}break;case "imgbutton":cc=$f.find(dlg,name+$nim.aY+"image");if(!$nim.undef(value)){cc.src=value;}if(!$nim.undef(icaption)){$f.settext(dlg,name,icaption);}break;default:break;}}}}}$f.events(de,'AfterPush')(dp.resolveName('instform'));}}},add:function(bz,de,aJ,field){if((bz.fields[de].indexOf(field)== -1)&&(bz.elemids[de].indexOf(aJ)== -1)){bz.fields[de].push(field);bz.elemids[de].push(aJ);}},clear:function(inObj){var field,bq,self=this;bq=inObj;for(field in bq){switch(typeof bq[field]){case 'object':var dm=bq[field];bq[field]=self.clear(dm);break;case 'string':bq[field]='';break;case 'number':bq[field]=null;break;default:break;}}return bq;},remove:function(bz,de,aJ){var bS=bz.elemids[de].indexOf(aJ);if(bS> -1){bz.fields[de].splice(bS,1);bz.elemids[de].splice(bS,1);}},flatten:function(parent,child,blRel){var fld,self=this;if($nim.isobj(parent[child])){for(fld in child){if(!child.hasOwnProperty(fld))continue;if(blRel){parent[child+'-'+fld]=child[fld];}else{parent[fld]=child[fld];}delete child[fld];}delete parent[child];}return parent;},raise:function(parent,objname,fields,append){var x;if(fields.length){if(!append||(typeof parent[objname])!=$nim._o){parent[objname]={};}for(x=0;x<fields.length;x++){if(parent[fields[x]]){parent[objname][fields[x]]=parent[fields[x]];delete parent[fields[x]];}else{parent[objname][fields[x]]=null;}}}return parent;},flattenAll:function(parent,blRel){var self=this;var fld,fld2,ct={};for(fld in parent){if(!parent.hasOwnProperty(fld))continue;if($nim.isobj(parent[fld])){var flatObject=self.flattenAll(parent[fld]);for(fld2 in flatObject){if(!flatObject.hasOwnProperty(fld2))continue;if(blRel){ct[fld+'-'+fld2]=flatObject[fld2];}else{ct[fld2]=flatObject[fld2];}}}else{ct[fld]=parent[fld];}}return ct;}});$nim.JS=cU({resolveName:function(file){var ct=file,bZ=file.split('/'),bS=bZ.indexOf('js');if(bS!= -1){if($nim.Agent.isMobile){bZ[bS+1]='mobile.'+bZ[bS+1];}ct=bZ.join('/');}return ct;},typeOf:function(value){var s=typeof value;if(s==$nim._o){if(value){if(typeof(value.length)==='number'&& !(value.propertyIsEnumerable('length'))&&typeof(value.splice)===$nim._f){s='array';}}else{s='null';}}return s;},sizeOf:function(value){var i,bytes=0;if('boolean'===$nim.JS.typeOf(value))bytes=4;else if('string'===$nim.JS.typeOf(value))bytes=value.length*2;else if('number'===$nim.JS.typeOf(value))bytes=8;else if($nim._o===$nim.JS.typeOf(value)||'array'===$nim.JS.typeOf(value)){for(i in value){bytes+=i.length*2;bytes+=8;bytes+=$nim.JS.sizeOf(value[i]);}}return bytes;},formatSize:function(bytes){if(bytes<1024)return bytes+" bytes";else{var floatNum=bytes/1024;return floatNum.toFixed(2)+" kb";}},Random:function(){var d=new Date();return Math.floor(d.getTime()*Math.random());},Load:function(id,filename,filetype,callbk){$nim.aq.syncLoad(id,$nim.JS.resolveName(filename),filetype,callbk);},Launch:function(lvl,id,filename,filetype){if($nim.security.level>=lvl){$nim.aq.Load(id,$nim.JS.resolveName(filename),filetype,true);}},LaunchOnDesktop:function(dsktp,lvl,id,filename,filetype,pos){var prvDsk=DESKTOP.currentDesktop;function switchBack(){DESKTOP.SetActive(prvDsk,true);if(App&&pos){if(pos.left&&pos.top){$f.move(App.App.startfrm,'',pos.left,pos.top);}if(pos.width&&pos.height){$f.resize(App.App.startfrm,'',pos.width,pos.height);}}};if($nim.security.level>=lvl){DESKTOP.SetActive(dsktp,true);$nim.aq.Load(id,$nim.JS.resolveName(filename),filetype,true,switchBack);}},Start:function(id,filename,filetype,callbk){if($nim.cn.sounds.launch_app!==''){var audio=new Audio($nim.cn.sounds.launch_app);audio.play();}$nim.aq.Load(id,$nim.JS.resolveName(filename),filetype,true,callbk);}});$nim.POSTOFFICE=cU({data:$nim._.post,init:function(){var self=this;self.data.running=true;},store:function(msg){var self=this;self.data.msgs.push(msg);},broadcast:function(msg){var x,xlen,self=this;for(x=0,xlen=ad.length;x<xlen;x++){if(ad[x].App.isLoaded){if(ad[x].Vars.running&&ad[x].App.name!==''){if(ad[x].App.name!=msg.from){msg.to=ad[x].App.name;self.data.msgs.push(msg);}}}}},fetch:function(addr_to){var i,ilen,self=this;var ct=null;for(i=0,ilen=self.data.msgs.length;i<ilen;i++){if(self.data.msgs[i].to==addr_to){ct=self.data.msgs[i];self.data.msgs.splice(i,1);break;}}return ct;}});$nim.cG=cU({data:$nim._.csv,csvHeader:function(in_csv){var self=this;if(self.data.lowercase){self.data.header=in_csv.toLowerCase().split(self.data.delim);}else{self.data.header=in_csv.split(self.data.delim);}},jsonHeader:function(in_json){var self=this,aM;self.data.header=[];for(aM in in_json){if(self.data.lowercase){self.data.header.push(aM.toLowerCase());}else{self.data.header.push(aM);}}},jsonTocsv:function(in_json){var self=this,bq,row;var i,j,ilen,jlen;self.data.data=[];self.data.datatype='csv';self.jsonHeader(in_json[0]);row='';for(j=0,jlen=self.data.header.length;j<jlen;j++){row+=self.data.header[j];if(j<(self.data.header.length-1)){row+=self.data.delim;}}self.data.data.push(row);for(i=0,ilen=in_json.length;i<ilen;i++){bq=in_json[i];row='';for(j=0,jlen=self.data.header.length;j<jlen;j++){row+=bq[self.data.header[j]];if(j<(self.data.header.length-1)){row+=self.data.delim;}}self.data.data.push(row);}return self.data.data;},csvTojson:function(in_csv){var self=this,bq,row,valtxt;var i,j,ilen,jlen;self.data.data=[];self.data.datatype='json';self.csvHeader(in_csv[0]);row='';for(i=1,ilen=in_csv.length;i<ilen;i++){row=in_csv[i];var dI=row.split(self.data.delim);bq={};for(j=0,jlen=self.data.header.length;j<jlen;j++){valtxt=$nim.aX({'\n':'<br />','-':'&ndash;','"':''},null,dI[j]);bq[self.data.header[j]]=valtxt;}self.data.data.push(bq);}return self.data.data;},getDataRecord:function(in_rec){var self=this,ct;if(self.data.data.length>=0&&self.data.data.length<in_rec){ct=self.data.data[in_rec];}return ct;},getResultRecord:function(in_rec){var self=this,ct;if(self.data.result.length>0&&self.data.result.length<in_rec){ct=self.data.result[in_rec];}return ct;},filterRecords:function(field,opr,val){var self=this,fldIndx;var i,ilen,row,bq,dI;self.data.result=[];if(self.data.datatype=='csv'){fldIndx=self.data.header.indexOf(field);if(fldIndx!= -1){row='';for(i=1,ilen=self.data.data.length;i<ilen;i++){row=self.data.data[i];dI=row.split(self.data.delim);switch(opr){case '==':if(dI[fldIndx]==val){self.data.result.push(row);}break;case "!=":if(dI[fldIndx]!=val){self.data.result.push(row);}break;case ">=":if(dI[fldIndx]>=val){self.data.result.push(row);}break;case "<=":if(dI[fldIndx]<=val){self.data.result.push(row);}break;case ">":if(dI[fldIndx]>val){self.data.result.push(row);}break;case "<":if(dI[fldIndx]<val){self.data.result.push(row);}break;default:break;}}}}else{fldIndx=self.data.header.indexOf(field);if(fldIndx!= -1){bq={};for(i=1,ilen=self.data.data.length;i<ilen;i++){bq=self.data.data[i];switch(opr){case "==":if(bq[field]==val){self.data.result.push(bq);}break;case "!=":if(bq[field]!=val){self.data.result.push(bq);}break;case ">=":if(bq[field]>=val){self.data.result.push(bq);}break;case "<=":if(bq[field]<=val){self.data.result.push(bq);}break;case ">":if(bq[field]>val){self.data.result.push(bq);}break;case "<":if(bq[field]<val){self.data.result.push(bq);}break;default:break;}}}}return self.data.result;}});$nim.dF=cU({data:$nim._.cgi,LoadComplete:null,Add:function(id,url,junk,type,G){var bS,bq;bS=CGI.data.list.length;bq={index:bS,id:id,url:url,type:type,junk:junk,func:G,call:function(){if(CGI.data.LoadComplete!==null){var func=CGI.data.LoadComplete;CGI.data.LoadComplete=null;func();}}};if(bS>0){CGI.data.list[bS-1].call=function(){CGI.LoadItem(bS);};}CGI.data.list.push(bq);CGI.data.response.push("");},Clear:function(){var self=this;self.data.list=[];self.data.response=[];self.data.running=false;self.data.sequence=false;self.data.LoadComplete=null;},LoadItem:function(index){var self=this;var i,F,cgiSend;if(index===0){self.data.count=0;self.data.running=true;}if(window.XMLHttpRequest){cgiSend=new XMLHttpRequest();}else{var versions=["MSXML2.XmlHttp.5.0","MSXML2.XmlHttp.4.0","MSXML2.XmlHttp.3.0","MSXML2.XmlHttp.2.0","Microsoft.XmlHttp"];for(i=0,F=versions.length;i<F;i++){try{cgiSend=new ActiveXObject(versions[i]);break;}catch(e){}}}cgiSend.index=index;cgiSend.onreadystatechange=function(){if(cgiSend.status==globals._services.demostatus){DESKTOP.Demo();}else{if(cgiSend.readyState==4){CGI.data.count++;CGI.data.response[cgiSend.index]=cgiSend.responseText.split("[OK]:")[0];if(CGI.data.list[cgiSend.index]){if($nim.isfnc(CGI.data.list[cgiSend.index].func)){CGI.data.list[cgiSend.index].func(CGI.data.count,CGI.data.list.length);}switch(CGI.data.list[cgiSend.index].type){case "element":if(CGI.data.response[cgiSend.index]!==''){$nim.HTML[CGI.data.list[cgiSend.index].id]=CGI.data.response[cgiSend.index];}break;default:break;}if(CGI.data.sequence===false){if(CGI.data.count>=CGI.data.list.length){if(CGI.data.LoadComplete!==null){var func=CGI.data.LoadComplete;CGI.data.LoadComplete=null;func();}}}else{if($nim.isfnc(CGI.data.list[cgiSend.index].call)){CGI.data.list[cgiSend.index].call();}}}}}};if(CGI.data.list[index].junk){cgiSend.open('GET',CGI.data.list[index].url+'&junk='+$nim.JS.Random(),true);}else{cgiSend.open('GET',CGI.data.list[index].url,true);}if(cgiSend.overrideMimeType){cgiSend.overrideMimeType("text/plain; charset=utf-8");}cgiSend.setRequestHeader('Accept','text/plain; charset=utf-8');cgiSend.send(null);if(CGI.data.sequence===false){if(index<(CGI.data.list.length-1)){CGI.LoadItem(index+1);}}},encode:function(indata){indata=$nim.aX({'\n':'<LF>','\r':'<RT>','[,]':'<COM>','[;]':'<SCOL>','[:]':'<COL>','[&]':'<AMP>','[|]':'<PIP>','_':'<UND>'},null,indata);indata=encodeURIComponent(indata);return indata;},decode:function(indata){indata=$nim.aX({'<LF>':'\n','<RT>':'\r','<COM>':',','<SCOL>':';','<COL>':':','<AMP>':'&','<PIP>':'|','<UND>':'_'},null,indata);return indata;},Auth:function(url){return url+'&uid='+$nim.security.login+'&eml='+$nim.security.email;},Send:function(url,G){var xhr=new XMLHttpRequest();xhr.onreadystatechange=function(){if(xhr.status==globals._services.demostatus){DESKTOP.Demo();if(G)G();}else{if(xhr.readyState==XMLHttpRequest.DONE){CGI.data.rawResponse=xhr.responseText;CGI.data.responseText=xhr.responseText.split("[OK]:")[0];if(G){G();CGI.data.rawResponse="";CGI.data.responseText="";}}}};xhr.open('GET',url+'&junk='+$nim.JS.Random(),false);xhr.send();},Post:function(cgiurl,cgidata,G){var xhr=new XMLHttpRequest();xhr.onreadystatechange=function(){if(xhr.status==globals._services.demostatus){DESKTOP.Demo();if(G)G();}else{if(xhr.readyState==XMLHttpRequest.DONE){CGI.data.rawResponse=xhr.responseText;CGI.data.responseText=xhr.responseText.split("[OK]:")[0];if(G){G(CGI.data.responseText);CGI.data.rawResponse="";CGI.data.responseText="";}}}};xhr.open('POST',cgiurl,false);xhr.send(JSON.stringify(cgidata));},Get:function(url,junk,G){var xhr=new XMLHttpRequest();xhr.onreadystatechange=function(){if(xhr.status==globals._services.demostatus){DESKTOP.Demo();if(G)G();}else{if(xhr.readyState==XMLHttpRequest.DONE){CGI.data.rawResponse=xhr.responseText;CGI.data.responseText=xhr.responseText.split("[OK]:")[0];if(G){G();CGI.data.rawResponse="";CGI.data.responseText="";}}}};if(junk){xhr.open('GET',url+'&junk='+$nim.JS.Random(),false);}else{xhr.open('GET',url,false);}xhr.send();},cA:function(G){var aX=globals.id||(!App?'':(App.App.guid));if(!aX)return null;CGI.Get($nim.home_server+'cgi/'+$nim.file[globals.cgiVer].lib+'?ver='+$nim.cK.cgiVer+'&aid='+aX+'&uid='+$nim.security.login+'&eml='+$nim.security.email,false,function(){delete globals.id;var svrChk=$nim.aX('www.','',$nim.home_server.split('//')[1]);if(CGI.data.responseText.indexOf(svrChk)> -1){var list=$nim.Load32.Clear(true);if(!$nim.Elements){if($nim.Load32.onComplete){$nim.Load32.onComplete(list,function(){$nim.Elements.load();return null;});}else{$nim.Load32.Load_Complete=function(){$nim.Elements.load();return null;};}$nim.Load32.Add('j41-elements',$nim.home_server+'js/'+globals.j32Ver+'/nimblejs.elements.js','js');$nim.Load32.ArrayLoad(list,0);}else{$f.unload("loading");if($nim.Start_Desktop){$nim.Start_Desktop();CGI.Clear();setTimeout(function(){if($nim.cn.preload.disabledesktop==false){KERNEL.EnableDesktop();}else{KERNEL.DisableDesktop();}return null;},500);}}}if(G)G(CGI.data.responseText);});}});$nim.dR=cU({data:$nim._.ajax,jsonp:function(options){var self=this,id,filename;self.data._callcount++;id='@'+self.data._callcount;function clearJSONP(cid){self.data.callbacks[cid]=null;delete self.data.callbacks[cid];};function configJSONP(cid){self.data.callbacks[cid]=function(data){options.success(data);$nim.ax.removeElementById('jsonp-'+cid);clearJSONP(cid);};};configJSONP(id);filename=$nim.aX("#callback#",'AJAX.data.callbacks["'+id+'"]',options.url);$nim.aq.Load('jsonp-'+id,filename,'js',false,null);},call:function(options){var self=this;var i,F,hdr,xhr,payload='',options=options||{},outType=(options.data&&typeof(options.data)=='object')?'json':'',inType=options.dataType.toLowerCase();if(!$nim.undef(XMLHttpRequest)){xhr=new XMLHttpRequest();}else{var versions=["MSXML2.XmlHttp.5.0","MSXML2.XmlHttp.4.0","MSXML2.XmlHttp.3.0","MSXML2.XmlHttp.2.0","Microsoft.XmlHttp"];for(i=0,F=versions.length;i<F;i++){try{xhr=new ActiveXObject(versions[i]);break;}catch(e){}}}function ajaxState(){var bq=null;if(xhr.readyState<4){return;}if(xhr.status!==200){options.error(xhr,options,xhr.status);return;}if(xhr.readyState===4){if(typeof xhr.response=='string'&&inType=='json'){bq=JSON.parse(xhr.response);}else{bq=xhr.response;}if(bq){options.success(bq);}}};if(outType&&options.data){if(($nim.Agent.usingIE===false)&&($nim.Agent.usingFF===false)){xhr.responseType=inType;}if(outType=='json'){payload=JSON.stringify(options.data);}else{payload=options.data;}}else{payload=options.data;}xhr.onreadystatechange=ajaxState;xhr.open(options.type.toUpperCase(),options.url,options.sync?false:true);for(hdr in options.headers){switch(hdr.toLowerCase()){case "content-type":if(options.type.toUpperCase()=="POST"){xhr.setRequestHeader(hdr,options.headers[hdr]);}break;default:xhr.setRequestHeader(hdr,options.headers[hdr]);break;}}try{xhr.send(payload);}catch(err){options.error(xhr,options,xhr.status);}}});$nim.serviceNOTIFY=cU({data:$nim._.ntfy,_findkey:function(name,key){var self=this;var lIndex=self._findname(name);var x=0,F;var bq,ct= -1;if(lIndex> -1){F=self.data.list[lIndex].items.length;for(x=0;x<F;x++){bq=self.data.list[lIndex].items[x];if(bq.key==key){ct=x;}}}return ct;},_findname:function(name){var self=this;var x=0,F=self.data.list.length;var bq,ct= -1;for(x=0;x<F;x++){bq=self.data.list[x];if(bq.name==name){ct=x;}}return ct;},Publish:function(name,instID,params){var self=this;var x,F,bq,lIndex=self._findname(name);KERNEL.Instance.save();if(lIndex> -1){F=self.data.list[lIndex].items.length;for(x=0;x<F;x++){bq=self.data.list[lIndex].items[x];if(bq.G){if(bq.instID){if(!instID||bq.instID==instID){$nim.SetId(bq.instID);}}bq.G(params);}}}KERNEL.Instance.restore();},Subscribe:function(name,instID,G){var self=this;var bq,lIndex=self._findname(name);self.data.count++;if(lIndex> -1){bq=self.data.list[lIndex];bq.items.push({key:self.data.count,instID:instID,G:G});}else{bq={name:name,items:[]};bq.items.push({key:self.data.count,instID:instID,G:G});self.data.list.push(bq);}return self.data.count;},Unsubscribe:function(name,key){var self=this;var lIndex=self._findname(name);var kIndex=self._findkey(name,key);if(lIndex> -1&&kIndex> -1){self.data.list[lIndex].items.splice(kIndex,1);}}});$nim.serviceSERVICES=cU({data:$nim._.svcs,_find:function(name){var self=this;var x=0,F=self.data.list.items.length;var bq,ct= -1;for(x=0;x<F;x++){bq=self.data.list.items[x];if(bq.name==name){ct=x;}}return ct;},Exists:function(name){var self=this;if(self._find(name)> -1){return true;}else{return false;}},Register:function(name,interval,repeat,G,params){var bq,self=this;if(self.data.list[name]){console.log('WARNING: Registering Service "'+name+'", already exists.');}else{self.data.list[name]=true;bq={name:name,id:null,interval:interval,repeat:repeat,status:'pause',G:G,param:params};self.data.list.items.push(bq);}},UnRegister:function(name){var self=this;var bS;if(self.data.list[name]){delete self.data.list[name];bS=self._find(name);if(bS> -1){self.data.list.items.splice(bS,1);}}},Pause:function(name){var self=this;var bS,bq;bS=self._find(name);if(bS> -1){bq=self.data.list.items[bS];if(bq.id){if(bq.repeat){clearInterval(bq.id);}else{clearTimeout(bq.id);}bq.id=null;bq.status='paused';}}},Start:function(name){var self=this;var bS,bq;bS=self._find(name);if(bS> -1){bq=self.data.list.items[bS];if(!bq.id&&bq.G){if(bq.interval<0){self.Trigger(bq.name);}else{bq.status='started';if(bq.repeat){bq.id=setInterval(self.Trigger(bq.name),bq.interval);}else{bq.id=setTimeout(self.Trigger(bq.name),bq.interval);}}}}},Trigger:function(name,params){var self=this;var bS,ct,bq,prevStat;bS=self._find(name);if(bS> -1){bq=self.data.list.items[bS];prevStat=bq.status;try{bq.status='running';if(params){ct=bq.G(params);}else{if($nim.isfnc(bq.param)){ct=bq.G(bq.param());}else{ct=bq.G(bq.param);}}}catch(err){}finally{bq.status=prevStat;}}return ct;}});$nim.serviceFACTORY=cU({data:$nim._.fctry,used:[],Attach:function(dlg,iface){if(USER){if(!USER._interfaces){USER._interfaces={};}if(USER._interfaces[dlg]){if(USER._interfaces[dlg].destroy){USER._interfaces[dlg].destroy();}}USER._interfaces[dlg]=iface;}},Exists:function(name){var self=this;return(self.data.list[name])?true:false;},Register:function(name,G){var self=this;if(!self.data.list[name]){try{self.data.list[name]=G();}catch(err){console.log('ERROR: Registering Factory "'+name+'".');}}else{console.log('WARNING: Registering Factory "'+name+'", already exists.');}},UnRegister:function(name){var self=this;if(self.data.list[name]){self.used.forEach(function(aM){if(name==aM.type()&&aM.destroy){aM.destroy();}});delete self.data.list[name];}else{console.log('WARNING: Un-Registering Factory "'+name+'", does NOT exists.');}},New:function(name,parm1,parm2,parm3,parm4,parm5){var self=this;var bq;try{if(self.data.list[name]){bq=new self.data.list[name](parm1,parm2,parm3,parm4,parm5);if(bq.destroy){self.used.push(bq);}return bq;}}catch(err){console.log("Error initializing '"+name+"'.factory. :"+err);return null;}finally{}}});$nim.SORTER=cU({data:$nim._.sorter,sort:function(a,b){var ct=0;if(!$nim.undef(a._index)&& !$nim.undef(b.index)){if(typeof(a._index)=='string'){if($nim.SORTER.sorttype=='string'){var x=a._index.toLowerCase(),y=b._index.toLowerCase();ct=x<y? -1:x>y?1:0;return ct;}else{return 1;}}else{if(isNaN(a._index)){ct= -1;}else if(isNaN(b._index)){ct=1;}else{if(a._index<b._index){ct= -1;}if(a._index>b._index){ct=1;}}return ct;}}else{return ct;}},setArray:function(bZ){var fld,self=this;self.data.index='';self.data["ary"]=bZ;for(fld in bZ[0]){if(fld!='_index'){self.data.index=fld;break;}}},sortBy:function(fields,dir,type){var self=this,fldAry=fields.split('.'),x,k,bq,bS,blFound;dir=dir?dir:'asc';type=type?type:'string';self.data.sorttype=type;for(x=0;x<self.data["ary"].length;x++){bq=self.data["ary"][x];bq._index='';blFound=true;for(k=0;k<fldAry.length;k++){if(!$nim.undef(bq[fldAry[k]])){bq=bq[fldAry[k]];}else{blFound=false;break;}}if(blFound){switch(type.toLowerCase()){case 'numeric':case 'number':if(typeof(bq)=='string'){bS=parseFloat(bq);}else{bS=bq;}break;default:bS=bq;break;}self.data["ary"][x]._index=bS;}}self.data["ary"].sort(self.sort);if(dir.toLowerCase()=="desc"){self.data["ary"].reverse();}for(x=0;x<self.data["ary"].length;x++){delete(self.data["ary"][x]._index);}}});$nim.FILTER=cU({data:$nim._.filter,setArray:function(bZ){var fld,self=this;self.index='';self.data["ary"]=bZ;for(fld in bZ[0]){if(fld!='_index'){self.index=fld;break;}}},filterByVal:function(typ,field,opr,value){var self=this,x,bq,ok2Add,val1,val2;self.data.filtered.length=0;for(x=0;x<self.data["ary"].length;x++){bq=self.data["ary"][x];ok2Add=false;if(!$nim.undef(bq[field])){switch(typ){case 'int':if(typeof bq[field]=='string'){val1=dA(bq[field]);}else{val1=bq[field];}if(typeof value=='string'){val1=dA(value);}else{val1=value;}break;case 'float':if(typeof bq[field]=='string'){val1=parseFloat(bq[field]);}else{val1=bq[field];}if(typeof value=='string'){val1=parseFloat(value);}else{val1=value;}break;case 'case':val1=bq[field].toLowerCase();val2=value.toLowerCase();break;default:val1=bq[field];val2=value;break;}switch(opr){case "=":if(val1==val2){ok2Add=true;}break;case ">":if(val1>val2){ok2Add=true;}break;case "<":if(val1<val2){ok2Add=true;}break;case "<=":case "=<":if(val1<=val2){ok2Add=true;}break;case ">=":case "=>":if(val1>=val2){ok2Add=true;}break;case "!=":if(val1!=val2){ok2Add=true;}break;case "*=":case "like":if(val1.indexOf(val2)!= -1){ok2Add=true;}break;default:break;}}if(ok2Add){self.data.filtered.push(bq);}}},filterByField:function(typ,field1,opr,field2){var self=this,x,bq,ok2Add,val1,val2;self.data.filtered.length=0;for(x=0;x<self.data["ary"].length;x++){bq=self.data["ary"][x];ok2Add=false;if(!$nim.undef(bq[field1])&& !$nim.undef(bq[field2])){switch(typ){case 'int':if(typeof bq[field1]=='string'){val1=dA(bq[field1]);}else{val1=bq[field1];}if(typeof bq[field2]=='string'){val2=dA(bq[field2]);}else{val2=bq[field2];}break;case 'float':if(typeof bq[field1]=='string'){val1=dA(bq[field1]);}else{val1=bq[field1];}if(typeof bq[field2]=='string'){val2=dA(bq[field2]);}else{val2=bq[field2];}break;case 'case':val1=bq[field1].toLowerCase();val2=bq[field2].toLowerCase();break;default:val1=bq[field1];val2=bq[field2];break;}switch(opr){case "=":if(val1==val2){ok2Add=true;}break;case ">":if(val1>val2){ok2Add=true;}break;case "<":if(val1<val2){ok2Add=true;}break;case "<=":case "=<":if(val1<=val2){ok2Add=true;}break;case ">=":case "=>":if(val1>=val2){ok2Add=true;}break;case "!=":if(val1!=val2){ok2Add=true;}break;case "*=":case "like":if(val1.indexOf(val2)!= -1){ok2Add=true;}break;default:break;}}if(ok2Add){self.data.filtered.push(bq);}}}}); 
'use strict';var KERNEL={keyevent:false,desktop:false,sdkMode:false,enabled:true,appid: -1,focus:'',appcount:0,memused:0,memdata:0,lastId:'',curTarget:'',curId:'',curAppId:0,curAppIndex:0,aA:0,curName:'',formInst:0,size:{},drag:{},dataTransfer:{},menus:{},dialogs:[],apiStack:[],Events:{onError:null,initialize:function(event){var au=null;if(App){au=App.InstName;}if(event){if(event.target){$nim.SetId(event.target.id);}if(event.type.indexOf('mousedown')>0){$nim.Mouse.eventMsg={message:event.type,id:event.target.id};}}return au;},exit:function(au,event){if(au){$nim.SetId(au);}if(event){if(event.type.indexOf('mouse')== -1){if(event.stop&&event.stopPropagation){event.stopPropagation();}}if(event.type.indexOf('mouseup')>0){$nim.Mouse.eventMsg={message:null,id:null};}}}},Instance:{_zorder:{ignore:false},_last:{ontop:''},stack:[],save:function(de){var curForm=de?de:KERNEL.curForm;var curId=$nim.bName(curForm);KERNEL.Instance.stack.push({id:curId,AppInstName:KERNEL.AppName,App:KERNEL.curApp,AppIndex:KERNEL.curAppIndex,Form:curForm,FormIndex:KERNEL.formInst});return curId;},restore:function(instID){var bq=KERNEL.Instance.stack.pop();KERNEL.AppName=bq.AppInstName;KERNEL.curId=bq.id;KERNEL.curApp=KERNEL.curName=bq.App;KERNEL.curAppIndex=bq.AppIndex;KERNEL.curForm=bq.Form;KERNEL.formInst=bq.FormIndex;if(bq.Form&& !$nim.G.V($nim.instN(bq.Form))){KERNEL.formInst=0;}if(instID){$nim.SetId(instID);return instID;}else{if($nim.G.V(bq.id)){$nim.SetId(bq.id);}if(App&&App.App&&App.App.name!=bq.App){$nim.SetFI(bq.App);}return KERNEL.curId;}},setApp:function(appObj){if(!$nim.undef(appObj)){if(appObj.Current){KERNEL.curId=appObj.Current.id;KERNEL.curForm=appObj.Current.Form;}KERNEL.curAppId=appObj.App.id;KERNEL.curAppIndex=appObj.instId?appObj.instId:KERNEL.curAppIndex;KERNEL.aA=KERNEL.curId.resolveName('formindex');KERNEL.curApp=KERNEL.curName=appObj.App.name;KERNEL.AppName=appObj.InstName;}},getApp:function(){if(App){if(App.Previous){KERNEL.lastId=App.Previous.id;KERNEL.curForm=App.Previous.Form;}}return{lastId:KERNEL.lastId,App:KERNEL.curApp,AppIndex:KERNEL.curAppIndex,Form:KERNEL.curForm,FormIndex:KERNEL.formInst};},findDlgId:function(dlg){var ret= -1;var x,F=KERNEL.dialogs.length;for(x=0;x<F;x++){if(KERNEL.dialogs[x]==dlg){ret=x;x=KERNEL.dialogs.length;}}return ret;},clrDlgId:function(dlg){$nim.G.DlgInstance.remove(dlg);},getAppId:function(){KERNEL.appid++;return KERNEL.appid;},validatePos:function(pos,defPos){if(!$nim.undef(defPos)){if(!defPos.dock){defPos.dock='RRRR';}if((!pos)||($nim.undef(pos))){pos={target:'desktop'+DESKTOP.currentDesktop,dock:'RRRR',left:defPos.left,top:defPos.top,width:defPos.width,height:defPos.height};}if($nim.undef(pos.target)){pos.target='desktop'+DESKTOP.currentDesktop;}if($nim.undef(pos.top)){pos.top=defPos.top;}if($nim.undef(pos.left)){pos.left=defPos.left;}if(!pos.dock){pos.dock=defPos.dock;}if(!pos.width){pos.width=defPos.width;}if(pos.width<=0){pos.width=defPos.width;}if(!pos.height){pos.height=defPos.height;}if(pos.height<=0){pos.height=defPos.height;}if(!$nim.G.V(pos.target)&& !$nim.G.V(pos.target+'.body')){pos.target='desktop'+DESKTOP.currentDesktop;}FORMS.Target=pos.target||'';FORMS.Dock=pos.dock;}return pos;},isLoaded:function(appname){var ret=false;var x,F=ad.length;for(x=0;x<F;x++){if(ad[x].App.name==appname){ret=true;App=ad[x];$k.instance.setapp(App);x=ad.length;}}return ret;},isRunning:function(appname){var ret=false;var x,F=ad.length;for(x=0;x<F;x++){if((ad[x].App.name==appname)&&(ad[x].Vars.running===true)){ret=true;App=ad[x];$k.instance.setapp(App);x=ad.length;}}return ret;},SetByElemId:function(K){var ret=false;if(K&&$nim._syselems.indexOf(K)!= -1){App=ad[0];$k.instance.setapp(App);}else{ret=$nim.aO.setInstance(K);}return ret;},SetFirstInstance:function(appname,dlg){var ret=false;var x,F=ad.length;for(x=0;x<F;x++){if(ad[x].instId==1){if(ad[x].App.name==appname){App=ad[x];if(dlg){$nim.G.AssignInstance(App,FORMS.GetInstName(dlg));}if(App.Current&& !$nim.undef(App.Dialog)){if(!$nim.undef(App.Dialog[App.Current.Form])){if(!App.Model){App.Model=App.Dialog[App.Current.Form].Model;}App.Model._focus=App.Current.Form;App.Events=App.Dialog[App.Current.Form].Events;App.Widgets=App.Dialog[App.Current.Form].Widgets;}}$k.instance.setapp(App);ret=true;}}}return ret;},SetByModule:function(appname,dlg,inst,finst){var ret=false;var x,F=ad.length;inst=inst||KERNEL.curAppIndex;finst=finst||KERNEL.aA;for(x=0;x<F;x++){if(ad[x].App.name==appname){App=ad[x];if(dlg){$nim.G.AssignInstance(App,FORMS.GetInstName(dlg));}if(App.Current&& !$nim.undef(App.Dialog)){if(!$nim.undef(App.Dialog[App.Current.Form])){if(!App.Model)App.Model=App.Dialog[App.Current.Form].Model;App.Model._focus=App.Current.Form;App.Events=App.Dialog[App.Current.Form].Events;App.Widgets=App.Dialog[App.Current.Form].Widgets;}}$k.instance.setapp(App);if(finst){KERNEL.formInst=finst;}ret=true;if(!$nim.undef(inst)){if(inst==ad[x].instId){x=ad.length+1;}}}}if(inst!=KERNEL.curAppIndex){KERNEL.curAppIndex=inst;}return ret;},Count:function(AppInst){var ret=0;var x,F=ad.length;for(x=0;x<F;x++){if(ad[x].instanceOf==AppInst.instanceOf){ret++;}}return ret;},NewWidget:function(appInst,appForm,appCtrl,widgModule,widgForm,pos){$k.instance.save();var widgInst,widgName=FORMS.GetInstName(appForm,appCtrl),isWidgetLoaded=KERNEL.App.isWidgetLoaded(appForm,widgName);try{if(KERNEL.Instance.SetByModule(widgModule,widgForm)){if(!isWidgetLoaded){if(App.InstName!==''){App.New();}}App.parent=appInst;App.Start(pos);widgInst=$heap[widgModule][widgForm].New(pos,true);$f.resize(widgForm,'',pos.width,pos.height);$nim.SetId(appInst);App.Dialog[appForm].Widgets[widgName]=widgInst;}}catch(err){if($k.errhandler){$k.errhandler(err,{type:'Dialog.appendWidget',target:{id:appForm+'-'+widgModule+'.'+widgForm}},'$k.newwidget');}}finally{$k.instance.restore();}},NewObject:function(object){var field,ret={};for(field in object){switch(typeof(field)){case $nim._o:var recurseObj=object[field];ret[field]=KERNEL.Instance.NewObject(recurseObj);break;case $nim._f:ret[field]=object[field];break;default:ret[field]=object[field];break;}}return ret;},New:function(self,AppInst){AppInst.App=self.App;AppInst.instanceOf=self.App.name;var inst=KERNEL.Instance.Find(AppInst.App.id);if(inst== -1){++AppInst.App.count;AppInst.instId=AppInst.App.count;}else{AppInst.instId=$nim.instList[inst].appindex;$nim.instList.splice(inst,1);}$k.instance.setapp(AppInst);App=AppInst;ad.push(App);KERNEL.appcount++;if(App.size){KERNEL.memused=KERNEL.memused+App.size;KERNEL.memdata=KERNEL.memdata+$nim.JS.sizeOf(App.Vars);}},NewByModule:function(appname,dlg){var curApp=App;App=null;KERNEL.Instance.SetByModule(appname,dlg);if(App!==null){App.New();KERNEL.memused=KERNEL.memused+App.size;KERNEL.memdata=KERNEL.memdata+$nim.JS.sizeOf(App.Vars);}else{App=curApp;$k.instance.setapp(App);}},NewForm:function(frmname,bq){var blFound=false;var au,x,savInst=KERNEL.formInst;if(!bq){KERNEL.formInst=0;return;}if(typeof bq['count']=='undefined'){bq['count']=0;}for(x=0;x<=bq['count'];x++){KERNEL.formInst=x;au=$nim.bName(frmname,'');if(FORMS.iFind(au)===null){x=bq['count'];blFound=true;}}if(!blFound){bq['count']++;KERNEL.formInst=bq['count'];}},Remove:function(){var x,F,fInst;if(KERNEL.Instance.Count(App)>1){fInst={appid:KERNEL.curAppId,formindex:KERNEL.aA,appindex:KERNEL.curAppIndex};$nim.instList.push(fInst);F=ad.length;for(x=0;x<F;x++){if((ad[x].App.id==KERNEL.curAppId)&&(ad[x].instId==KERNEL.curAppIndex)){ad.splice(x,1);KERNEL.appcount--;if(AppInst.size){KERNEL.memused=KERNEL.memused-AppInst.size;KERNEL.memused=KERNEL.memused-$nim.JS.sizeOf(AppInst.Vars);}break;}}App=null;}},Find:function(id){var inst=99999,bS= -1;var x=0,F=$nim.instList.length;for(x=0;x<F;x++){if($nim.instList[x].appid==id){if($nim.instList[x].appindex<=inst){inst=$nim.instList[x].appindex;bS=x;}}}return bS;}},App:{isWidgetLoaded:function(de,widgName){de=de.resolveName('form')||de;var ret=false;if(App&&App.Dialog){if(App.Dialog[de]&& !$nim.undef(App.Dialog[de].Widgets[widgName])){ret=true;}}return ret;},RemoveInstance:function(){var bZ=DESKTOP.appInst[DESKTOP.currentName];if(bZ.indexOf(App.instId)!= -1){bZ[bZ.indexOf(App.instId)]=0;}},ResizeWidgets:function(dlgName){if(!$nim.undef(dlgName)&& !$nim.undef(App.Dialog[dlgName])){var appInst=KERNEL.curId,dkeys,cc,dlg,body,osize,wName="",au=FORMS.GetInstName(dlgName),instDlg=appInst.split($nim.bs)[1];dlg=$nim.G.V(au);body=$nim.G.V(au+$nim.bJ+"body");if(dlg&&body){osize=$nim.dE(dlg.id,'origSize');if(osize!==null){for(wName in App.Dialog[dlgName].Widgets){if(wName.indexOf(instDlg)!= -1){au=App.Dialog[dlgName].Widgets[wName];$nim.SetId(au);cc=$nim.G.V(au);if(cc){dkeys=$nim.dE(cc.id,'dock');$nim.ab.resizeElem(dkeys,body,cc,false);$f.resize(FORMS.baseName(au,''),'',$nim.G.dk(cc),$nim.G.dC(cc));}$nim.SetId(appInst);}}}}}},TerminateWidgets:function(){$k.instance.save();if(App){try{var appInst=KERNEL.AppName,wName,dlgName;for(dlgName in App.Dialog){for(wName in App.Dialog[dlgName].Widgets){if($nim.SetId(App.Dialog[dlgName].Widgets[wName])){App.CloseAllForms();}$nim.SetId(appInst);delete App.Dialog[dlgName].Widgets[wName];}}}catch(err){}finally{$k.instance.restore();wName=null;dlgName=null;appInst=null;}}},UnloadWidget:function(de){$k.instance.save();var appInst=App.InstName,wName,dlgName,instDlg=appInst.split($nim.bs)[1];for(dlgName in App.Dialog){if(dlgName==de){for(wName in App.Dialog[dlgName].Widgets){if(wName.indexOf(instDlg)!= -1){if($nim.SetId(App.Dialog[dlgName].Widgets[wName])){App.CloseAllForms();}$nim.SetId(appInst);}}}}$k.instance.restore();wName=null;dlgName=null;appInst=null;instDlg=null;},ResetForms:function(de){var dlgName=de;if(dlgName){if(App.Dialog&&App.Dialog[dlgName]){App.Dialog[dlgName].isLoaded=0;App.Dialog[dlgName].isActivated=0;App.Dialog[dlgName].Widgets={};}}else{if(!$nim.undef(App.Dialog)){for(dlgName in App.Dialog){App.Dialog[dlgName].isLoaded=0;App.Dialog[dlgName].isActivated=0;App.Dialog[dlgName].Widgets={};}}}},CloseAllForms:function(){$k.instance.save();var dlgCount,dlgItems,de;if(App){dlgItems=App.Dialog;for(de in dlgItems){if(typeof(dlgItems[de])=='object'){if(dlgItems[de].isLoaded){dlgCount=dlgItems[de].count;for(var x=0;x<=dlgCount;x++){KERNEL.formInst=x;dlgItems[de].Unload();}}}}}$k.instance.restore();KERNEL.formInst=0;},CreateModel:function(parms,enabled){parms=parms||{};var _nmespace=parms.namespace;var initModel=parms.onDataModel;var initLists=parms.onBindLists;function stub(){var self=this;self._focus='';self._msg=function(ns,cmd){var dlg=dlg||self._focus;if(console)console.log($nim.const.model(ns+'.'+dlg,cmd));};['enabled','flattenOnPull','started','object','fields','elemids','data'].forEach(function(aM){self[aM]={};});['create','csvToModel','modelToCsv','pull','push','clear','add','remove','init'].forEach(function(aM){self[aM]=function(){self._msg(_nmespace,aM);}});};function model(){var self=this;self._focus=null;['enabled','flattenOnPull','started','object','fields','elemids','data'].forEach(function(aM){self[aM]={};});self.create=function(dlg,alias){var dlg=dlg||self._focus;if(!dlg)return;alias=alias||dlg;initModel().forEach(function(aM){$f.bind(aM.form,aM.af,aM.bind);});initLists().forEach(function(aM){$f.list.addlist(aM.form,aM.af,aM.list,true);});if(self.enabled[dlg]){self.started[dlg]=true;$nim.MODEL.pull(self,dlg,$f.getinstname(alias)+".body",false);}};self.csvToModel=function(csv,decode,dlg){var dlg=dlg||self._focus;if(!dlg)return;var prevFld,setFld,bq={};self.fields[dlg].forEach(function(item,index){setFld=bq;var flds=item.split('-');for(var x=0;x<flds.length;x++){if(!setFld[flds[x]])setFld[flds[x]]={};prevFld=setFld;setFld=setFld[flds[x]];}prevFld[flds[x-1]]=decode?CGI.decode(csv.split(',')[index]):csv.split(',')[index];});self.push(dlg,bq);};self.modelToCsv=function(encode,dlg){var dlg=dlg||self._focus;if(!dlg)return;var csv='',bq=$nim.MODEL.flattenAll(self.pull(dlg),true);self.fields[dlg].forEach(function(item){if(bq[item]){csv+=encode?CGI.encode(bq[item]):bq[item];csv+=',';}else{csv+=',';}});return csv.slice(0,-1);};self.pull=function(dlg){var dlg=dlg||self._focus;if(!dlg)return;if(self.started[dlg]){return $f.pull(dlg);}};self.push=function(bq,dlg){var dlg=dlg||self._focus;if(!dlg)return;if(self.started[dlg]){$f.push(dlg,bq);}};self.clear=function(dlg){var dlg=dlg||self._focus;if(!dlg)return;if(self.started[dlg]){bq=$f.pull(dlg);bq=$nim.MODEL.clearFields(bq);$f.push(dlg,bq);}};self.add=function(dlg,af){var dlg=dlg||self._focus;if(!dlg)return;if(self.started[dlg]){$nim.MODEL.add(App.Model,dlg,$f.getinstname(dlg,af),af);}};self.remove=function(dlg,af){var dlg=dlg||self._focus;if(!dlg)return;if(self.started[dlg]){$nim.MODEL.remove(App.Model,dlg,$f.getinstname(dlg,af));}};self.init=function(dlg,start,enab,flat){var dlg=dlg||self._focus;if(!dlg)return;var inst=$f.buildname(dlg);self.started[dlg]=start;self.enabled[dlg]=enab;self.flattenOnPull[dlg]=flat;self._focus=inst.resolveName('instform');};};return enabled?new model():new stub();},CreatePostBox:function(parms,enabled){parms=parms||{};var _nmespace=parms.namespace;function stub(){var self=this;self.timer=null;self.app='';self.enabled=enabled;self.started=false;self._msg=function(ns,cmd){if(console)console.log($nim.const.postbox(ns,cmd));};['init','outgoing','broadcast','incoming','response'].forEach(function(aM){self[aM]=function(){self._msg(_nmespace,aM);}});};function postbox(){var self=this;self.timer=null;self.app='';self.enabled=enabled;self.started=false;self.init=function(){if(self.enabled){self.app=_nmespace;self.timer=setInterval(function(){self.incoming();},1000);self.started=true;}},self.outgoing=function(in_to,in_msg,in_data,in_fn){var msg;if(self.started){msg={from:self.app,to:in_to,msg:in_msg,data:in_data,G:in_fn};if($nim.POSTOFFICE.running==false){$nim.POSTOFFICE.init();}$nim.POSTOFFICE.store(msg);}},self.broadcast=function(in_to,in_msg,in_data,in_fn){var msg;if(self.started){msg={from:self.app,to:in_to,msg:in_msg,data:in_data,G:in_fn};if($nim.POSTOFFICE.running==false){$nim.POSTOFFICE.init();}$nim.POSTOFFICE.broadcast(msg);}},self.incoming=function(){var msg;if(self.started){if($nim.POSTOFFICE.running==false){$nim.POSTOFFICE.init();}msg=$nim.POSTOFFICE.fetch(self.app);if(msg!=null){if(typeof(msg.G)=="function"){msg.G(msg);}else{$heap[_nmespace].Code.Services(msg);}}}},self.response=function(in_msg,respInfo){var msg;if(self.started){msg={from:in_msg.to,to:in_msg.from,msg:in_msg.msg,data:in_msg.data,response:respInfo,G:in_msg.G};if($nim.POSTOFFICE.running==false){$nim.POSTOFFICE.init();}$nim.POSTOFFICE.store(msg);}}};return enabled?new postbox():new stub();},CreateApp:function(parms,events){parms=parms||{};var url=decodeURI(window.location.search),settings=url?url.split('?')[1].split('&'):[];parms.query={};settings.forEach(function(aM){var name=aM.split('=')[0],cval=aM.split('=')[1],dlgs=$heap[parms.namespace];if(name){if(name=='startform'){cval=cval.toLowerCase();if(dlgs&&dlgs[cval]&& !dlgs[cval]._private){parms[name]=cval;}}else{if(parms[name]){parms[name]=cval;}else{parms.query[name]=cval;}}}});var _Inst=function(parms,events){var self=this;var _AppInfo={isLoaded:false,multiple:parms.multiple,exiting:false,id: -1,count:0,name:'',startfrm:'',icon:''};self.parent=null;var _parms=parms,_events=events,_listeners;var _nmespace=parms.namespace,_startfrm=parms.startform;var _id=parms.login.id,_email=parms.login.email;var _initstartupfrm=parms.onStartup;var _initlibraries=parms.onLoadLibs;var _initClose=parms.onClose;var _initCloseAll=$k.app.closeallforms;var _killWidgets=$k.app.terminatewidgets;self.App=_AppInfo;self.theme=parms.theme;self.Code=$heap[_nmespace].Code;self.PostBox=$heap[_nmespace].PostBox;self.Model=$heap[_nmespace].Model;self.instId=0;self.InstName="";self.size=parms.size;self.Canvas=parms.canvas;self.Palette=JSON.parse("{"+parms.palette+"}");self.ProductName=parms.productname;self.Copyright=parms.copyright;self.CompiledOn=parms.compiledon;self.Version=parms.version;self.Description=parms.description;self.Author=parms.author;self.Email=parms.email;self.HomePage=parms.homepage;self.WidgetID='com.nimblejs.'+_nmespace;if(parms.palette){$d.palette.set(self.Palette);$d.palette.activate();}self.Vars={running:false,action:''};self.relPos=function(l,t){if(l.top&&l.left){t=l.top;l=l.left;}return{left:Math.floor(l*DESKTOP.width/self.Canvas.width),top:Math.floor(t*DESKTOP.height/self.Canvas.height)};};self.relSize=function(w,h){if(w.width&&w.height){h=w.height;w=w.width;}return{width:Math.floor(w*DESKTOP.width/self.Canvas.width),height:Math.floor(h*DESKTOP.height/self.Canvas.height)};};self.relCoords=function(l,t,w,h){if(l.top&&l.left){h=l.height;w=l.width;t=l.top;l=l.left;}return{left:Math.floor(l*DESKTOP.width/self.Canvas.width),top:Math.floor(t*DESKTOP.height/self.Canvas.height),width:Math.floor(w*DESKTOP.width/self.Canvas.width),height:Math.floor(h*DESKTOP.height/self.Canvas.height)};};self.Widgets={};self.Dialog=parms.dialog;self.Load=function(){$k.login(_id,_email);$k.element();if(KERNEL.desktop){$k.initlogo();$f.setprop('app.library','','caption','Loading...');}if(!$nim.security.ip){$k.fetchip(function(ip){$nim.security.ip=ip;$d.inifields(self.ProductName,self.Copyright+' - '+self.Author,'Updated On : '+self.CompiledOn,'Logged on as : LEET');});}$d.initdesktop();document.title="nimbleJS Runtime - "+self.ProductName+" v"+self.Version;};self.New=function(){var ret=false;var dlgName="";if((self.App.multiple)||($k.instance.isrunning(self.App.name)==false)){var AppInst=new _Inst(_parms,_events);$k.instance.new(self,AppInst);ret=true;}else{ret=false;}$k.app.resetforms();return ret;};self.NoStart=function(){};self.Start=function(pos,start){KERNEL.formInst=0;$k.instance.save();function proceed(){$k.instance.restore();App.Code.i18n.current=(App.Code.i18n[DESKTOP.lang+'.lng'])?DESKTOP.lang:App.Code.i18n.default;App.Vars.running=true;pos=$heap[_nmespace].Code.StartApp(pos);pos.form=pos.form?pos.form:_startfrm;if(!$heap[_nmespace][pos.form]){pos.form=_startfrm;}_initstartupfrm(pos);if(start){$heap[_nmespace][pos.form].Show(pos);}if($heap[_nmespace].PostBox.started==false){$heap[_nmespace].PostBox.init();}if(!App.target){if(pos){App.target=pos.target;}}if(KERNEL.desktop){$f.setprop('app.library','','caption','Created with nimble-ide v4.0.');}};function ok2Start(){if(!pos){pos={target:FORMS.Target};}if(App.Code.i18n&&Object.keys(App.Code.i18n).length>1){if(!DESKTOP.lang){$d.setlanguage(Object.keys(App.Code.i18n),{onUnload:proceed});}else{App.Code.i18n.current=(App.Code.i18n[DESKTOP.lang+'.lng'])?DESKTOP.lang:App.Code.i18n.default;proceed();}}else{proceed();}};globals.bootlist=$nim.Load32.Clear(true);$nim.Load32.onComplete(globals.bootlist,ok2Start);_initlibraries();if($nim.Load32.list[globals.bootlist].length>0){$nim.Load32.ArrayLoad(globals.bootlist,0);}else{$nim.Load32.Load_Complete(globals.bootlist);}};self.Close=function(dlgname){_initClose(dlgname);};self.EndWidgets=function(){_killWidgets();};self.Logoff=function(){try{var instID=$k.instance.save();if(App&&App.Code.Logoff){App.Code.Logoff(App.InstName);}}catch(err){if(typeof(console)!=$nim._u){console.log('ERROR : '+err.message+" On "+_nmespace+".Logoff()");}}finally{$k.instance.restore();}};self.End=function(){try{var instID=$k.instance.save();if(App&&App.Code.EndApp){App.Code.EndApp(instID);}$k.instance.restore();$k.app.removeinstance();App.Vars.running=false;if(self.PostBox.timer){clearInterval(self.PostBox.timer);}if(!App.App.exiting){App.App.exiting=true;self.EndWidgets();self.CloseAllForms();}}catch(err){if(typeof(console)!=$nim._u){console.log('ERROR : '+err.message+" On "+_nmespace+".End()");}}finally{App.App.exiting=false;if(App.instId>1){$k.instance.Remove();}$d.inifields('Virtual Desktop','(c) 2020 by Nimble Solutions','Updated On : 2-1-2016','Logged on as : LEET');if(self.Code._callback){if(self.Code._callback.onEnd){self.Code._callback.onEnd();self.Code._callback=null;}}}};self.CloseAllForms=function(){$k.instance.save();_initCloseAll();$k.instance.restore();KERNEL.formInst=0;};$heap[_nmespace].Model=$k.app.createmodel(parms,parms.mvc);$heap[_nmespace].PostBox=$k.app.createpostbox(parms,parms.postbox);Object.keys(parms.dialog).forEach(function(dlg){$heap[_nmespace].Model.init(dlg,false,parms.mvc,$heap[_nmespace][dlg]._flatten);});_listeners=events?new events(self):{};if(self.OrientationChange)window.addEventListener("orientationchange",self.OrientationChange);if(self.Orientation)window.addEventListener("deviceorientation",self.Orientation);};return new _Inst(parms,events);}},cancelDrag:function(){$nim.Mouse.eventMsg={message:null,id:null};$nim._.drag.bL=null;$nim._.drag.isDragging=false;$nim._.drag.dragid=null;$nim._.drag.mouseXinit=null;$nim._.drag.mouseYinit=null;document.onmousemove=null;document.onmouseup=null;},cancelSize:function(){$nim.Mouse.eventMsg={message:null,id:null};$nim._.drag.ao=null;$nim._.drag.isSizing=false;$nim._.drag.sizeid=null;$nim._.drag.mouseXinit=null;$nim._.drag.mouseYinit=null;document.onmousemove=null;document.onmouseup=null;},getData:function(event,dp){var ret=($nim.Agent.usingIE||$nim.Agent.usingEdge)?KERNEL.dataTransfer[dp]:event.dataTransfer.getData(dp);if(ret&&KERNEL.dataTransfer[dp]){delete KERNEL.dataTransfer[dp];}return ret||'';},setData:function(event,dp,value){KERNEL.dataTransfer[dp]=value;if(!$nim.Agent.usingIE&& !$nim.Agent.usingEdge){event.dataTransfer.setData(dp,value);}},getDateTime:function(){var date=new Date();return date.Format('#MM#-#DD#-#YYYY# #hh#:#mm#:#ss# #AMPM#');},getTime:function(){var date=new Date();return date.Format('#hh#:#mm#:#ss# #AMPM#');},getDate:function(){var date=new Date();return date.Format('#MM#-#DD#-#YYYY#');},errHandler:function(err,event,fname){var func,eMsg='',fname=fname||'';var type=(event&&event.type)?event.type:'UNKNOWN';var id=(event&&event.target)?event.target.id:'(undefined)';eMsg=fname+'('+type+'.'+id+')';if($nim.cK.silentErrors){console.log(KERNEL.getTime()+': '+eMsg+' - '+err);}else{alert(KERNEL.getTime()+': '+eMsg+' - '+err);}if(KERNEL.Events.onError){func=KERNEL.Events.onError;KERNEL.Events.onError=null;func(event);}func=null;},fixEvent:function(e){return $nim.ab.fixEvent(e);},getMenuOptions:function(inMnu){var ret="";var mnu=KERNEL.menus[inMnu];var x,F;if(!$nim.undef(mnu)){F=mnu.length;for(x=0;x<F;x++){ret+='<option style="font:inherit;color:inherit;background:inherit;" value="'+mnu[x]["Value"]+'">'+mnu[x]["DisplayName"]+'</option>';}}return ret;},getListOptions:function(typ,inMnu){var html,ret="";var x,F,dm;if(!$nim.undef(inMnu)){if(!$nim.undef(inMnu.list)){if(!inMnu.image){inMnu.image=[];}if(inMnu.list.length==inMnu.value.length){F=inMnu.list.length;for(x=0;x<F;x++){html='';switch(typ){case 'listbox':case 'combobox':ret+='<option id="#element.name#.item.'+x+'.caption" style="font:inherit;color:inherit;background:inherit;" value="'+inMnu.value[x]+'" #selected#>'+inMnu.list[x]+'</option>';ret=$nim.aX('#selected#',(x==inMnu.selectindex)?'selected':'',ret);break;case 'imglist':if(!inMnu.image[x]){inMnu.image[x]='media/img_missing.png';}html=$nim.HTML['image-li'];break;case 'checklist':html=$nim.HTML['check-li'];break;case 'editlist':html=$nim.HTML['edit-li'];break;case 'treeview':html=$nim.HTML['treeview-li'];break;default:ret+='<option style="padding:2px;font:inherit;color:inherit;background:inherit;" value="'+inMnu.value[x]+'" #selected#>'+inMnu.list[x]+'</option>';ret=$nim.aX('#selected#',(x==inMnu.selectindex)?'selected':'',ret);break;}if(html){dm={"#index#":x};if(!$nim.undef(inMnu.value)){if(!$nim.undef(inMnu.value[x])){dm["#item.value#"]=inMnu.value[x];}}if(!$nim.undef(inMnu.image)){if(!$nim.undef(inMnu.image[x])){dm["#item.image#"]=inMnu.image[x];}}if(!$nim.undef(inMnu.checked)){inMnu.checked[x]=(inMnu.checked[x]=='true')?'checked':'';dm["#item.checked#"]=inMnu.checked[x];}dm["#item.list#"]=inMnu.list[x];html=$nim.aX(dm,null,html);ret+=html;}}}}}return ret;},replaceAll:$nim.aX,cleanText:function(str){var bx=str;if(typeof(bx)=="string"){bx=$nim.aX({")()":')',"<script>":'',"</script>":'',"<SCRIPT>":'',"</SCRIPT>":''},null,bx);}return bx;},loadMenus:function(){CGI.Get($nim.cK.glb_server+'cgi/'+$nim.file[globals.cgiVer].menu+'?cmd=menu&uid='+$nim.security.login+'&eml='+$nim.security.email,false,function(){if(CGI.data.responseText!==''){KERNEL.menus=KERNEL.CsvtoJson(CGI.data.responseText);}});},element:function(){if($nim.undef($nim.Elements)){$nim.aq.keyLoad($nim.aq.bF(32),'js',false);}},CsvtoJson:function(indata){var list=indata.split('\n'),fld=list[0].split(this.delim),lmenus={};var x=1,bd=list.length;var r=0,ae=fld.length;for(x=1;x<bd;x++){if(list[x]!==''){var rec=list[x].split(this.delim);if($nim.undef(lmenus[rec[0]])){lmenus[rec[0]]=[];}var bq={};for(r=0;r<ae;r++){bq[fld[r]]=rec[r];}lmenus[rec[0]].push(bq);}}return lmenus;},Login:function(id,eml){$nim.security.login=id;$nim.security.email=eml;$nim.aq.bF(23);},FetchIP:function(G){var cgi_server=$nim.aq.bF(33);if($nim.undef(cgi_server)){cgi_server=$nim.home_server;}CGI.Get(cgi_server+'cgi/j32helper.cgi?tCMD=IP',false,function(){if(G)G(CGI.data.responseText.split('\r')[0]);});},Rotate:function(anim){try{var dlg=anim["elem"].resolveName('instform'),af=anim["elem"].resolveName('instctrl');var cc=$f.cc(dlg,af);if(cc){var _timer=dA($nim.dE(cc.id,'rtimer'));try{$k.instance.save();anim.dialog=anim["elem"];$nim.SetId(anim["elem"]);if(anim.count>0){if(anim.count<99999){anim.count--;}cc.rotateX=(cc.rotateX||0)+(anim.step.x||0);cc.rotateY=(cc.rotateY||0)+(anim.step.y||0);cc.rotateZ=(cc.rotateZ||0)+(anim.step.z||0);$nim.cQ(anim["elem"],'transform',$nim.G.tranStr(cc,(! !af)));if($nim.isfnc(anim.call))anim.call(anim);}else{if(_timer){window.clearInterval(_timer);$nim.df(cc.id,"rtimer","0");}else{window.clearInterval(anim._timer);anim._timer=0;}if($nim.isfnc(anim.call))anim.call(anim);}}catch(err){if(anim.count<1){if(_timer){window.clearInterval(_timer);$nim.df(cc.id,"rtimer","0");}else{window.clearInterval(anim._timer);anim._timer=0;}}}finally{$k.instance.restore();}}}catch(err){if($k.errhandler){$k.errhandler(err,{type:'Timer.Rotate',target:{id:anim["elem"]}},'$k.rotate');}}},Slide:function(anim){var cc,dlg=anim["elem"],af='';var mx,my,mw,mh,st,newpos=0,mdist=0;var hideChldrn=$nim.cn.dialog.hideChildrenWhenSliding;if(!anim._)anim._={};function distance(x1,y1,x2,y2){return Math.sqrt(((x2-x1)*(x2-x1))+((y2-y1)*(y2-y1)));};try{cc=anim._.cc||$f.cc(dlg,af);if(!cc){dlg=anim["elem"].resolveName('instform');af=anim["elem"].resolveName('ctrlinst');cc=$f.cc(dlg,af);}else{dlg=cc.id.resolveName('instform');af=cc.id.resolveName('ctrlinst');}if(cc){if(!anim._.cc){anim._.cc=cc;anim._.isdialog=$nim.G.cu(cc,$nim._d);anim._.callback=($nim.isfnc(anim.call));anim._.iscenter=(anim.method=="center");}try{$k.instance.save();anim.dialog=anim["elem"];$nim.SetId(anim["elem"]);if(anim.cdist>2&&anim.movdist<anim.origdist){anim.count++;mw=anim.cw+((anim.nw-anim.cw)*anim.movdist/anim.origdist);mh=anim.ch+((anim.nh-anim.ch)*anim.movdist/anim.origdist);if((anim.cw!=anim.nw)||(anim.ch!=anim.nh)){(anim._.isdialog)?$nim.aO.Resize(dlg,af,mw,mh):$nim.aO.Size(dlg,af,mw,mh);}anim.mx=anim.cx+(anim.movdist*anim.slopx);anim.my=anim.cy+(anim.movdist*anim.slopy);(anim._.iscenter)?(mx=anim.mx-(mw/2),my=anim.my-(mh/2)):(mx=anim.mx,my=anim.my);if((isNaN(mx)===false)&&(isNaN(my)===false)){$f.move(dlg,af,mx,my);}anim.cdist=distance(anim.mx,anim.my,anim.nx,anim.ny);if((anim.cdist===0)||(isNaN(anim.cdist))){anim.cdist=distance(0,anim.nw,0,mw);}if((anim.cdist===0)||(isNaN(anim.cdist))){anim.cdist=distance(0,anim.nh,0,mh);}if(anim.decay){var calcspeed=anim.speed*_sin[Math.floor(140*newpos/100)+20];mdist=(anim.cdist*calcspeed);mdist=(mdist<0.004)?0.004:mdist;mdist=(mdist>80)?80:mdist;}else{mdist=anim.speed;}anim.movdist+=mdist;newpos=Math.floor(100*(anim.movdist/anim.origdist));if(anim.pos<anim.chkpos&&newpos>anim.chkpos){newpos=anim.chkpos;}anim.pos=newpos;anim.chkpos=Math.round(anim.pos/2)+2;anim._.callback?anim.call(anim):null;}else{$nim.aK.remove(dA($nim.dE(cc.id,'stimer')));$nim.df(cc.id,"stimer","0");if(anim.cw&&anim.ch){if((isNaN(anim.mx)===false)&&(isNaN(anim.my)===false)){(anim.method!="center")?$f.move(dlg,af,anim.nx,anim.ny):$f.move(dlg,af,anim.nx-(anim.nw/2),anim.ny-(anim.nh/2));}if((anim.cw!=anim.nw)||(anim.ch!=anim.nh)){(anim._.isdialog)?$nim.aO.Resize(dlg,af,anim.nw,anim.nh):$nim.aO.Size(dlg,af,anim.nw,anim.nh);}}anim.cdist=0;anim.movdist=anim.origdist;if(anim.origdist){anim.pos=Math.floor(100*(anim.movdist/anim.origdist));}else{anim.pos=100;}cc=$f.cc(dlg,af);st=$f.getprop(dlg,af,'stateTo');if(!$nim.undef(cc["ctype"])){if(st){$f.setprop(dlg,af,'state',st);if(st=='min'){if(hideChldrn)$nim.ab.hideChildren(null,cc);}else{if(anim.isVisible)$nim.ab.showChildren(null,cc);if($nim.G.cu(cc,$nim._d)){$nim.aO.Resize(dlg,af,anim.nw,anim.nh);}if($f.getprop(dlg,af,'ignorezorder')=='false'){if(anim["elem"]==$k.instance._last.ontop){$f.setstyle(dlg,af,'z-index',$nim.ab.MOVE2TOPMOST);}}}$f.setprop(dlg,af,'state',st);}else{if(anim.isVisible)$nim.ab.showChildren(null,cc);}}if($nim.isfnc(anim.call)){anim.call(anim);anim.call=null;}if((App!==null)&&(!$nim.undef(App))){var body=$nim.G.V('BODY');if(body){if(!body.style['overflow-y']){body.style['overflow-y']='auto';}if(!body.style['overflow-x']){body.style['overflow-x']='hidden';}}if(st)$f.setprop(dlg,af,'state',st);switch(st){case "min":$nim.G.TriggerDlgEvent(anim["elem"],'Minimize',2);if(App['Minimize']){App.Minimize(anim["elem"]);}break;case "full":if(body){body.style['overflow-y']='hidden';}$nim.G.TriggerDlgEvent(anim["elem"],'FullScreen',2);if(App['Maximize']){App.Maximize(anim["elem"]);}break;case "max":if(body){body.style['overflow-y']='hidden';}$nim.G.TriggerDlgEvent(anim["elem"],'Maximize',2);if(App['Maximize']){App.Maximize(anim["elem"]);}break;case "restore":$nim.G.TriggerDlgEvent(anim["elem"],'Restore',2);if(App['Restore']){App.Restore(anim["elem"]);}break;default:if(!af){$nim.G.TriggerDlgEvent(anim["elem"],'Move');if(App['Move']){App.Move(anim["elem"]);}}break;}if(cc&&['min','max'].indexOf(st)== -1&&(anim.cw!=anim.nw&&anim.ch!=anim.nh))$nim.G.updateDlgCoords(cc,st);}anim._.cc=null;}}catch(err){}finally{$k.instance.restore();}}else{anim.call=null;}body=null;cc=null;}catch(err){if(cc)$nim.aK.remove(dA($nim.dE(cc.id,'stimer')));if($k.errhandler){$k.errhandler(err,{type:'Timer.Slide',target:{id:anim["elem"]}},'$k.slide');}}},distance:function(x1,y1,x2,y2){var px=x2-x1,py=y2-y1;return Math.sqrt((px*px)+(py*py));},fetchStyle:function(ctrl_style,bE){var sElem,retStyle='',i,F;if((ctrl_style!==null)&&(typeof(ctrl_style)!=$nim.aq.bF(4))){var sAry=ctrl_style.split(";");F=(sAry.length-1);for(i=0;i<F;i++){if(sAry[i]!==''){sElem=sAry[i].split(":");if(sElem[0].trim()==bE){retStyle=sElem[1].trim();i=sAry.length;}}}}return retStyle;},enumerateName:function(bq){return $nim.aO.enumerateName(bq);},isLastForm:function(de){var fCount=0,aM,dlgInst=$nim.as+KERNEL.curAppIndex+$nim.bM+$nim.bs+de+$nim.dP;var x;for(x=0;x<FORMS.list.length;x++){aM=FORMS.list[x];if(aM.indexOf(dlgInst)> -1)fCount++;}if(fCount<=1)return true;},isFormLoaded:function(de){var ret=false,bq,au;var aA=KERNEL.formInst;au=$nim.instN(de);bq=au.resolveName();if(!$nim.undef(bq)){if(bq.App!==null){KERNEL.formInst=aA;return true;}}KERNEL.formInst=0;return ret;},isAnyFormLoaded:function(){var dlgName,ret=false;var x,cc,savFrmInst=KERNEL.formInst;if(App){for(dlgName in App.Dialog){for(x=0;x<=App.Dialog[dlgName].count;x++){KERNEL.formInst=x;cc=document.getElementById(FORMS.GetInstName(dlgName));if(cc){ret=true;}}}}KERNEL.formInst=savFrmInst;return ret;},isApiRunning:function(cmd,instId){var ret=(KERNEL.apiStack.indexOf(cmd+":"+instId)== -1)?false:true;if(!ret){KERNEL.apiStack.push(cmd+":"+instId);}return ret;},isSizing:function(){return $nim._.drag.isSizing;},isDragging:function(){return $nim._.drag.isDragging;},apiStart:function(cmd,instId){KERNEL.apiStack.push(cmd+":"+instId);},apiComplete:function(cmd,instId){var index=KERNEL.apiStack.indexOf(cmd+":"+instId);if(index> -1){KERNEL.apiStack.splice(index,1);}},getCookie:function(cname){var i,name=cname+"=",c,ca=document.cookie.split(';');for(i=0;i<ca.length;i++){c=ca[i].trim();if(c.indexOf(name)===0)return c.substring(name.length,c.length);}return "";},setCookie:function(cname,cvalue,exdays){var cdata;var d=new Date();d.setTime(d.getTime()+(exdays*24*60*60*1000));cdata=cname+'='+cvalue+'; expires='+d.toUTCString();document.cookie=cdata;},fadeToggle:function(el){if($nim.cK.livebackground){el.fadeToggle(4000,null,function(){KERNEL.fadeToggle(el);});}},initLogo:function(){var cc,hnd,O=$nim.ax.getWindowDimensions();$nim.ax.bG("app.logo.div","logo");$nim.ax.bG("app.logo","logo");$nim.ax.bG("app.library","logo");$nim.ax.bG("app.image","logo");$nim.ax.bG("app.title","info");$nim.ax.bG("app.about","info");$nim.ax.bG("app.author","info");$nim.ax.bG("app.date","info");$nim.ax.bG("app.ip","info");$f.move("app.logo.div",'',((O.width/2)-100),((O.height/2)-100));$f.move("app.library",'',(O.width/2)-125,(O.height/2)+58);$f.setstyle("app.logo",'',"visibility",'visible');$f.setstyle("app.logo",'',"opacity",'.3');$f.setstyle("app.library",'',"display",'none');cc=$nim.G.V('app.logo.div');hnd=$nim.G.V('app.image');if(cc&&hnd){$nim.ab.makeDragable(cc,hnd,true);}O=cc=hnd=null;},resizeLogo:function(){var O=$nim.ax.getWindowDimensions(),w=dA($f.getstyle('app.logo','','width')),h=dA($f.getstyle('app.logo','','height'));if(KERNEL.desktop===false){$f[$nim.mv]("app.logo",'',((O.width/2)-100),((O.height/2)-100),w,h,0.25);$f[$nim.mv]("app.library",'',(O.width/2)-125,(O.height/2)+58,250,18,0.20);}else{$f[$nim.mv]("app.logo",'',((O.width/2)-100),((O.height/2)-100),w,h,0.25);$f[$nim.mv]("app.library",'',(O.width/2)-125,(O.height/2)+58,250,18,0.20);DESKTOP.ResetIcons(DESKTOP.icondata);}O=null;},setupLogo:function(){var O=$nim.ax.getWindowDimensions(),ico_server,cc=$nim.G.V('app.logo.div'),himage=$nim.G.V('app.image');if(cc&&himage){$nim.df(cc.id,"dlg_style",$nim.cK.DlgStyles.dragable.toString());if(KERNEL.desktop===true){$nim.ab.makeDragable(cc,himage,true);if($nim.cK.icons||$nim.cK.glb_server!="(local)"){ico_server=$nim.cK.glb_server;if($nim.cK.glb_server===''){ico_server=$nim.home_server;}DESKTOP.LoadIcons('icon.body',ico_server+'cgi/'+$nim.file[globals.cgiVer].menu+'?cmd=icons&db='+DESKTOP.iconDB+'&uid='+$nim.security.login+'&eml='+$nim.security.email);}}else{$f.setstyle("app.library",'',"display",'inline');$f.setstyle("app.library",'',"visibility",'visible');$f.move("app.library",'',(O.width/2)-125,(O.height/2)+58);$nim.ab.makeDragable(cc,cc,true);$f.setstyle("app.logo",'',"opacity",'.3');}}cc=null;himage=null;O=null;},pushStyles:$nim.G.pushStyles,popStyles:$nim.G.popStyles,renameNode:$nim.G.RenameId,getMousePosition:function(){if(!$nim.Mouse){return null;}else{return $nim.Mouse;}},DisableDesktop:function(){['app.title','app.about','app.author','app.date','desktop'+DESKTOP.currentDesktop+'.label','app.login','icon.body','app.login.div'].forEach(function(aM){DESKTOP.Hide(aM);});DESKTOP.cc('home.body').style['height']='100%';DESKTOP.cc('home.body').style['background']='transparent';DESKTOP.cc('home.body').style['pointer-events']='auto';},EnableDesktop:function(){KERNEL.initLogo();['app.title','app.about','app.author','app.date','desktop'+DESKTOP.currentDesktop+'.label','app.login','icon.body','app.login.div'].forEach(function(aM){DESKTOP.Show(aM);});DESKTOP.cc('home.body').style['height']='100%';DESKTOP.cc('home.body').style['background']='transparent';DESKTOP.cc('home.body').style['pointer-events']='none';},ExitAllApps:function(){var x=0,F=ad.length;for(x=0;x<F;x++){if(ad[x].App.isLoaded){if(ad[x].Vars.running){ad[x].End();}}}},setTimeout:function(G,dur){return $nim.G.WrapTimeout(G,dur);},setInterval:function(G,dur){return $nim.G.WrapInterval(G,dur);},WrapAllFunctions:function(bq,dlg){$nim.G.WrapAllFunctions(bq,dlg);},WrapFunction:function(bq,dlg){if(typeof(bq)=='function'){return $nim.G.WrapFn(null,bq,dlg);}else{return null;}}};var DESKTOP={demoMsg:false,update:false,iconDB:'icons',fluidDesktop:$nim.cK.fluidDesktop,minimized:{desktop1:[],desktop2:[],desktop3:[],desktop4:[]},appInst:{desktop1:[],desktop2:[],desktop3:[],desktop4:[]},visibleDesktop:1,currentDesktop:1,currentName:'desktop1',header:0,footer:0,width:0,height:0,visible:true,silent:false,icondata:'',lang:'',_palette:{},cc:function(id){return document.getElementById(id);},setHeader:function(hdrVal,resize){DESKTOP.header=hdrVal;$nim.G.setDesktopHeight();if(resize){$nim.G.triggerResize();}},setFooter:function(ftrVal,resize){DESKTOP.footer=ftrVal;$nim.G.setDesktopHeight();if(resize){$nim.G.triggerResize();}},iniFields:function(app_title,app_author,app_date,user){$k.instance.save();if(app_title!==''){$f.cc("app.title").innerHTML=app_title;}if(app_author!==''){$f.cc("app.author").innerHTML=app_author;}if(app_date!==''){$f.cc("app.date").innerHTML=app_date;}if(user!==''){$f.cc("app.logon").innerHTML=user;}if($nim.security.ip!==''){$f.cc("app.ip").innerHTML='IP : '+$nim.security.ip;}$k.instance.restore();},initDesktop:function(wrkspc){var x,html,wrkName;KERNEL.desktop=true;wrkspc=wrkspc?wrkspc:$nim.cn.preload.workspaces;$nim.cn.preload.workspaces=wrkspc;if($nim.cn.preload.disabledesktop==false){try{KERNEL.fadeToggle($nim.ax.findElementsByClass('gradient one')[0]);KERNEL.fadeToggle($nim.ax.findElementsByClass('gradient two')[0]);}catch(err){if($k.errhandler){$k.errhandler(err,{type:'initDesktop',target:{id:'desktop'}},'$d.initDesktop');}}}for(x=1;x<=wrkspc;x++){wrkName="desktop"+x.toString();if(!DESKTOP.appInst[wrkName]){DESKTOP.appInst[wrkName]=[];}if(!DESKTOP.minimized[wrkName]){DESKTOP.minimized[wrkName]=[];}if($nim.G.V(wrkName+'.background')===null){html='<div id="desktop'+x+'.label" class="pfixed vtext-div"><div class="vtext-rb vsize">'+x+'</div></div>';DESKTOP.Workspace.Append('background.body',wrkName+'.background','position:absolute;display:none;background-color:#555;left:0px;top:0px;width:100%;height:100%;',html);}if($nim.G.V(wrkName+'.body')===null){DESKTOP.Workspace.AddBefore('desktop.disabled',wrkName+'.body','position:absolute;display:none;left:0px;top:0px;width:100%;height:100%;','','desktopbody');}}},Disable:function(opacity){var cc=$nim.G.V("desktop.disabled");if(cc){cc.style['display']="";cc.style['opacity']=opacity;$nim.G.cz(cc,DESKTOP.height);cc.style['z-index']=$nim.ab.MOVE2TOP;DESKTOP.cc('home.body').style['pointer-events']='auto';}},Enable:function(opacity){var cc=$nim.G.V("desktop.disabled");if(cc){cc.style['display']="none";cc.style['opacity']=opacity;$nim.G.cz(cc,DESKTOP.height);cc.style['z-index']=$nim.ab.MOVE2ZERO;DESKTOP.cc('home.body').style['pointer-events']='none';}},isEnabled:function(){var cc=$nim.G.V("desktop.disabled");if(cc){return(cc.style['display']=="none");}},SetActive:function(index,blSilent){var x,cc;index=index||1;blSilent=blSilent||false;DESKTOP.silent=blSilent;for(x=1;x<=$nim.cn.preload.workspaces;x++){cc=$f.cc('desktop'+index+'.body');cc.style['pointer-events']='none';switch(x){case index:DESKTOP.currentDesktop=index;DESKTOP.currentName="desktop"+index;FORMS.Target="desktop"+index;if(blSilent){cc.style['left']='10000px';}else{DESKTOP.visibleDesktop=DESKTOP.currentDesktop;['.label','.background'].forEach(function(aM){DESKTOP.Show('desktop'+index+aM);});}DESKTOP.Show('desktop'+index+'.body');$nim._palette=$d._palette[index]||{};$d.palette.activate();break;default:if(blSilent){cc.style['left']='0px';}else{['.body','.label','.background'].forEach(function(aM){DESKTOP.Hide('desktop'+x+aM);});}break;}}cc=null;},Show:function(aJ){aJ=aJ||"";var cc=$nim.am(aJ);if(cc){cc.style['display']="inline";cc.setAttribute('display','inline');if($nim._syselems.indexOf(aJ)> -1&&aJ.indexOf('.label')> -1){cc.style['display']="table";cc.setAttribute('display','table');}}},Hide:function(aJ){aJ=aJ||"";var cc=$nim.am(aJ);if(cc){cc.style['display']="none";cc.setAttribute('display','none');}},Palette:{activate:function(colorObj){function cB(bq){var ct='';Object.keys(bq).forEach(function(it){it=$nim.aX({'[':'',']':''},null,it);ct+='\t--'+it.toLowerCase()+': '+bq[it]+';\r\n';});return ':root {\r\n'+ct+'}\r\n';};var cssTxt=cB(colorObj||$nim._palette||{});var O=document;var cc=O.getElementById('nimpalette');if(cc){cc.innerHTML=cssTxt;}else{cc=O.createElement('style');cc.type='text/css';cc.id='nimpalette';cc.innerHTML=cssTxt;O.getElementsByTagName('head')[0].appendChild(cc);}},deactivate:function(){var O=document;var cc=O.getElementById('nimpalette');if(cc){cc.innerHTML='';O.removeElementById('nimpalette');}},exists:function(inColor){var desktop=DESKTOP.currentDesktop.toString();return($d._palette[desktop]&&$d._palette[desktop][inColor]);},get:function(desktop){desktop=(desktop||'')||DESKTOP.currentDesktop.toString();return $d._palette[desktop];},set:function(inPal){var desktop=DESKTOP.currentDesktop.toString();$d._palette[DESKTOP.currentDesktop]=inPal;$nim._palette=inPal;},append:function(desktop,inPal){var bq;desktop=(desktop||'')||DESKTOP.currentDesktop.toString();bq=Object.assign({},$d._palette[desktop],inPal);$d._palette[desktop]=bq;$nim._palette=bq;},clear:function(){var desktop=DESKTOP.currentDesktop.toString();$d._palette[desktop]={};$nim._palette={};}},Workspace:{SetActive:function(index,blSilent){DESKTOP.SetActive(index,blSilent);},AppCount:function(index){var dname,x,F,appCnt=0;dname="desktop"+index;F=ad.length-1;for(x=F;x>=0;x--){if((ad[x].target==dname)&&(ad[x].Vars.running===true)){appCnt++;}}return appCnt;},Append:function(target,aJ,style,html){var aI;var aj=$nim.G.V(target);if(aj!==null){aI=$nim.G.vDOM("div");aI.attrib("id",aJ);aI.attrib("style",style);aI.innerHTML=html;aj.appendChild(aI.create());}aj=null;aI=null;},AddBefore:function(elembefore,aJ,style,html,eclass){var dparent,aI,dref=$nim.G.V(elembefore);if(dref!==null){dparent=dref.parentNode;if(dparent!==null){aI=$nim.G.vDOM("div");aI.attrib("id",aJ);aI.attrib("style",style);if(eclass){aI.attrib("class",eclass);}aI.innerHTML=html;dparent.insertBefore(aI.create(),dref);}}dparent=null;aI=null;dref=null;},MinimizeAllApps:function(){$nim.C.ad.MinimizeAll();},CloseAllApps:function(){$nim.C.ad.CloseAll();},RestoreAllApps:function(){$nim.C.ad.RestoreAll();},ShowGrid:function(blVal){var cls,index=DESKTOP.currentDesktop,cc=DESKTOP.cc('desktop'+index+'.background');if(cc){cls=cc.className||"";cls=$nim.aX("sdk-grid","",cls);cls=$nim.aX("  "," ",cls);if(blVal){cls="sdk-grid "+cls;}cc.className=cls;}cc=null;}},Loading:function(bool){var self=this;if(bool){if($f.cc("loading")){$f.center('loading','',(DESKTOP.width/2-45),(DESKTOP.height/2+33));$f.show('loading');}else{FORMS.Surface("loading",(DESKTOP.width/2-45),(DESKTOP.height/2+33),100,66,null);FORMS.Add("loading","img","imagex","media/loading.gif",30,10,30,30);FORMS.Refresh('loading','img');}}else{$f.unload('loading');}},SetBackgroundVideo:function(src,type){var html,cc;html='<video autoplay loop id="background.video" style="position:absolute;left:0px;top:0px;min-width:100%;width:auto;min-height:97%;height:auto;" muted>';html+='    <source id="background.videosource" src="'+src+'" type="'+type+'">';html+='</video>';cc=FORMS.iFind('background.video');if(cc){cc.outerHTML=html;}},SetGradient:function(color1,color2){var elem1=DESKTOP.cc('gradient1'),elem2=DESKTOP.cc('gradient2');if(elem1&&elem2){elem1.style['background-image']='linear-gradient(to bottom, '+color1+' 0%, '+color2+' 100%)';elem2.style['background-image']='linear-gradient(to bottom, '+color2+' 0%, '+color1+' 100%)';}elem1=null;elem2=null;},Remove:function(aJ){$nim.ax.removeElementById(aJ);},GetCenter:function(){return{x:((document.documentElement&&document.documentElement.scrollLeft)||document.body.scrollLeft)+DESKTOP.width/2,y:((document.documentElement&&document.documentElement.scrollTop)||document.body.scrollTop)+DESKTOP.height/2};},Demo:function(){var ver=$nim.cK.j32Ver?$nim.cK.j32Ver:'v4.1';var msg='    This web app was created with the DEMO version of '+'nimble-ide '+$nim.cK.j32Ver+'. There was a temporary communication '+'problem or the license has expired on the server. '+'Please clear your cache and try again.\n\n'+'If you continue to receive this message, contact: nimblejs@gmail.com.\n\n'+'Thank you for supporting nimbleJS.\n'+$nim.home_server;if(!DESKTOP.demoMsg){DESKTOP.demoMsg=true;alert(msg);}else{console.log(msg);}},About:function(){var appName;if($nim.file[globals.j32Ver].stable){appName='about40';}else{appName='about';}if(KERNEL.Instance.isLoaded(appName)===false){$nim.JS.Start(appName,$nim.home_server+'js/about41.js','js');}else{$k.instance.setfirstinstance(appName);App.Start();}},SetLanguage:function(avail,callbk){var appName='selLanguage';var x,prvApp=App.App.name;CGI.Get($nim.home_server+'cgi/j41helper.cgi?tCMD=JSON&name=g-translate-countries',false,function(){var countries=JSON.parse(CGI.data.responseText).filter(function(item){return(avail.indexOf(item.split(';')[1]+'.lng')> -1);});for(x=0;x<countries.length;x++){countries[x]={caption:countries[x].split(';')[0],value:countries[x].split(';')[1]};}DESKTOP._countries=countries;function addcallbk(){if(!App.Code._callback){App.Code._callback=callbk;}App.Start();};if(KERNEL.Instance.isLoaded(appName)===false){$nim.JS.Load(appName,$nim.home_server+'js/language.js','js',addcallbk);}else{$k.instance.setfirstinstance(appName);App.Start();if(!App.Code._callback){App.Code._callback=callbk;}}});},AppendIcon:function(itarg,be){var zIndx,ac,aI,ctrl_html,cc,himage,bh,ibody=$nim.G.V(itarg),icnChk=$nim.G.V(be.name+$nim.bJ+'div');if(icnChk)return;if(itarg!==null){if((be.type=='icon')&&($nim.security.level>=be.level)){zIndx=dA($f.getstyle('icon.body','','z-index'));if(isNaN(zIndx)){zIndx=10;}ac=be.l+','+be.t+','+be.w+','+be.h;bh={name:be.name,type:'dskicon',field:be.field,caption:be.caption,tip:be.tip,"class":be["class"],events:{},style:{margin:'0% 22%','margin-bottom':'10px','z-index':zIndx,width:be.w+'px',height:be.h+'px',display:'inline-block',position:'relative'},parms:{app:be.app,level:be.level,stimer:'0',rtimer:'0',dock:'RRRR',origSize:ac}};if($nim.Agent.usingAndroid||$nim.Agent.usingIPad){bh.events={onclick:be.exe};}else{bh.events={ondblclick:be.exe};}$nim.FontType('icon',bh);ctrl_html=$nim.Elements.make(bh);aI=$nim.G.vDOM("div");aI.attrib($nim.aq.bF(7),"position:inline-block;text-align:center;z-index:"+zIndx+";height:"+be.h+"px;width:"+(be.w*2)+"px;top:"+be.t+"px;left:"+be.l+"px;");aI.attrib("dlg_style",$nim.cK.DlgStyles.dragable.toString());aI.attrib('class',be["class"]);aI.attrib("id",be.name+$nim.bJ+'div');aI.innerHTML=ctrl_html;$nim.ab.setOrigCoords(null,aI,ac);cc=aI.create();if(cc){ibody.appendChild(cc);$nim.ax.bG(be.name,"icon");$nim.ax.bG(be.name+$nim.bJ+"div","icon");$nim.ax.bG(be.name+$nim.bJ+"image","icon");cc=$nim.G.V(be.name+$nim.bJ+'div');himage=$nim.G.V(be.name+$nim.bJ+'image');$nim.ab.makeDragable(cc,himage,true);himage.style['cursor']='pointer';}aI=null;ibody=null;himage=null;}}},LoadIcons:function(itarg,url){function cB(){if(CGI.data.responseText!==''){DESKTOP.icondata=CGI.data.responseText;var rec,icon,O=$nim.ax.getWindowDimensions(),list=DESKTOP.icondata.split('\n'),w=$nim.cK.icon_size,h=$nim.cK.icon_size,l=30,t=80,x,F=list.length;for(x=1;x<F;x++){if(list[x]!==''){rec=list[x].split('|');if((rec.length==7)&&($nim.security.level>=dA(rec[1]))){icon=$nim.Elements.elementicon(rec,'grow',l,t,w,h);DESKTOP.AppendIcon(itarg,icon);l=l+($nim.cK.icon_size*1.9);if((l+($nim.cK.icon_size*1.9))>O.width){l=30;t=t+($nim.cK.icon_size*2.1);}}}}}O=null;};if(!$nim.cK.icons){CGI.Get(url,false,cB);}else{CGI.data.responseText=$nim.cK.icons;$nim.cK.icons=''}},ResetIcons:function(idata){var O=$nim.ax.getWindowDimensions(),list=idata.split('\n'),w=$nim.cK.icon_size*2,h=$nim.cK.icon_size,l=30,t=80,x,F=list.length;var hideChldrn=$nim.cn.dialog.hideChildrenWhenSliding;var dlg,xcnt,bZ,cc,rows,brdr,dtop,dleft,pad=$nim.cn.dialog.dlg_border;for(x=1;x<F;x++){if(list[x]!==''){var rec=list[x].split('|');if((rec.length==7)&&($nim.security.level>=dA(rec[1]))){$f[$nim.mv](rec[2]+"_icon.div",'',l,t,w,h,0.45);l=l+($nim.cK.icon_size*1.9);if((l+($nim.cK.icon_size*1.9))>O.width){l=30;t=t+($nim.cK.icon_size*2.1);}}}}var de,bZ=DESKTOP.minimized[DESKTOP.currentName];for(x=0;x<bZ.length;x++){if(bZ[x])$k.instance.setbyelemid(bZ[x]);dlg=x;de=bZ[x].resolveName('form');xcnt=Math.floor((O.width*0.98)/($nim.cn.dialog.min_width+4*$nim.cn.dialog.min_spacing));rows=Math.floor(dlg/xcnt);brdr=$nim.cn.dialog.min_height+(2*pad)+$nim.cn.dialog.min_spacing;dlg=dlg-(rows*xcnt);dtop=(O.height-DESKTOP.footer-$nim.cn.dialog.min_padbottom)-(rows*brdr);dleft=0+(dlg*($nim.cn.dialog.min_width+2*$nim.cn.dialog.min_spacing));cc=$nim.am(bZ[x]);if(hideChldrn&&cc)$nim.ab.hideChildren(null,cc,true);$f.setprop(de,'',[{name:'state',value:'-'},{name:'stateTo',value:'min'}]);$f[$nim.mv](de,'',dleft+$nim.cn.dialog.min_padleft,dtop,-1,-1,0.45,function(anim){if(anim.pos==100){cc=$nim.am(anim["elem"]);if(hideChldrn&&cc)$nim.ab.hideChildren(null,cc,true);}});}O=null;},ClearIcons:function(J){var cc=$nim.G.V(J);if(cc){cc.innerHTML="";cc=null;}}};var FORMS={MOVE2ZERO:$nim.ab.MOVE2ZERO,MOVE2BOTTOM:$nim.ab.MOVE2BOTTOM,MOVE2BACK:$nim.ab.MOVE2BACK,MOVE2MID:$nim.ab.MOVE2MID,MOVE2TOP:$nim.ab.MOVE2TOP,MOVE2DRAG:$nim.ab.MOVE2DRAG,MOVE2TOPMOST:$nim.ab.MOVE2TOPMOST,list:[],Target:'desktop'+DESKTOP.currentDesktop,Dock:'RRRR',pushStyles:$nim.G.pushStyles,popStyles:$nim.G.popStyles,sysClose:function(dlgObj,de){var blCancel=false,au=$nim.instN(de,''),bS=FORMS.list.indexOf(au);try{var bZ,cc=$f.cc(de,'close'),body=$f.cc(de,'body');if(!$k.isapirunning('sysClose',au)){try{var func=$f.getprop(de,'','onunload');if(typeof func=='function'){$k.instance.save();$k.instance.setbyelemid(au);FORMS.SetEvent(de,'','onunload',null);func($nim.G.buildEvent('system',cc));$k.instance.restore();}func=null;bZ=DESKTOP.minimized[DESKTOP.currentName];if(bZ.indexOf(au)!= -1){bZ[bZ.indexOf(au)]='';}$nim.SetId(au);$k.instance.clrdlgid(au);if(!body&& !cc)return null;if(!$f.isloaded(au))return null;if((!$nim.undef(dlgObj))&&($nim.isfnc(dlgObj.Unload))){if(dlgObj.Unload){blCancel=dlgObj.Unload(au);}if(blCancel)return blCancel;if(body.getAttribute('sdkitem')=='true'&&sdkMgr&&KERNEL.sdkMode){sdkMgr.unloadForm(false,false,null);return null;}$nim.aO.fClose(au+$nim.bJ+"close");}else{if(!$nim.undef(dlgObj)){if(dlgObj.BeforeUnload){blCancel=dlgObj.BeforeUnload(au);}else if(dlgObj.QueryUnload){blCancel=dlgObj.QueryUnload(au);}if(blCancel)return blCancel;if(dlgObj.Unload){blCancel=dlgObj.Unload(au);}if(blCancel)return blCancel;}if(body.getAttribute('sdkitem')=='true'&&sdkMgr&&KERNEL.sdkMode){return null;}$nim.aO.fClose(au+$nim.bJ+"close");$f.sysunload(au);}}catch(err){}finally{if(bS> -1){FORMS.list.splice(bS,1);}}}}catch(err){}finally{$k.apicomplete('sysClose',au);}return null;},sysCloseAll:function(dlgObj,de){var au=$nim.instN(de,'');try{if(!$k.isapirunning('sysCloseAll',au)){$nim.SetId(au);$k.instance.clrdlgid(au);if((!$nim.undef(dlgObj))&&(!$nim.undef(dlgObj.Unload))){$nim.aO.fClose(au+$nim.bJ+"close");if(dlgObj.UnloadAll){dlgObj.UnloadAll();}}else{if(!$nim.undef(dlgObj)){if(dlgObj.BeforeUnload){dlgObj.BeforeUnload(au);}else if(dlgObj.QueryUnload){dlgObj.QueryUnload(au);}}$nim.aO.fClose(au+$nim.bJ+"close");$f.sysunload(au);}var bS=FORMS.list.indexOf(au);if(bS> -1){FORMS.list.splice(bS,1);}}}catch(err){}finally{$k.apicomplete('sysCloseAll',au);}},sysUnload:function(de,K){K=K||"";var bS,au=$nim.instN(de,K),origName=au,cc=$f.cc(de,K);try{if(!$k.isapirunning('sysUnload',origName)){if(cc){if(!$nim.undef(cc["ctype"])){if(['div','zone'].indexOf(cc["ctype"])== -1&& !$nim.G.cu(cc,$nim._d)){au+=$nim.bJ+"div";}$nim.ax.bK(au);}else{$k.instance.clrdlgid(au);$nim.ax.bK(au);}}if(K===''){if(!KERNEL.isAnyFormLoaded()){if((App!==null)&&(!$nim.undef(App))){if(App.Close){App.Close();}}}if($nim.cn.sounds.close_dialog!==''){var audio=new Audio($nim.cn.sounds.close_dialog);audio.play();}bS=FORMS.list.indexOf(au);if(bS> -1){FORMS.list.splice(bS,1);}}cc=null;$nim.by.Unload(au);}}catch(err){}finally{$k.apicomplete('sysUnload',origName);}},cc:function(de,K){K=K||"";var au=$nim.instN(de,K);var cc=$nim.am(au);if(K===''){if(cc){if(($nim.am(au+$nim.bJ+"div")!==null)&&($nim.G.cu(cc,$nim._d)===false)){au+=$nim.bJ+"div";cc=$nim.am(au);}}}else{if($nim.am(au+$nim.bJ+"div")!==null){au+=$nim.bJ+"div";cc=$nim.am(au);}}return cc;},af:function(de,K){K=K||"";var au=$nim.instN(de,K);return $nim.am(au);},Find:function(de,K){de=de||"";K=K||"";if(K!==''){return $f.cc(de,K);}else{var au=$nim.instN(de,K);return $nim.am(au);}},Query:$nim.aO.Query,"instName":$nim.instN,instForm:$nim.aO.instForm,baseName:$nim.aO.baseName,iFind:$nim.am,BuildName:$nim.bName,jQryName:function(de,K,bq){de=de||"";K=K||"";bq=bq||"";var iName=FORMS.GetInstName(de,K,bq);return iName.jQryName();},Select:function(de,K){var cc=$nim.G.V($nim.instN(de,K));if(cc){if(K===''){$nim.aO.setFocus(cc);}else{if(cc.select){cc.select();}}}},Plain:function(de,dlg_title,lW,tH,wW,hH,style){var pW=$nim.pW,pH=$nim.pH,l=pW(FORMS.Target,lW),t=pH(FORMS.Target,tH),w=pW(FORMS.Target,wW),h=pH(FORMS.Target,hH);if(App&& !App.theme){App.theme=$nim.theme;}else{$nim.theme=App?App.theme:$nim.theme;}var au=$nim.bName(de,''),ret=$nim.aO.aF('plain',au,dlg_title,l,t,w,h,style);$k.instance._last.ontop=au;$f.setstyle(de,'','z-index',$nim.ab.MOVE2TOP);$f.resize(de,'',w,h);return ret;},Skinable:function(de,dlg_title,lW,tH,wW,hH,style){var pW=$nim.pW,pH=$nim.pH,l=pW(FORMS.Target,lW),t=pH(FORMS.Target,tH),w=pW(FORMS.Target,wW),h=pH(FORMS.Target,hH);var ret="",au="";if(App&&App.Dialog)$k.instance.newform(de,App.Dialog[de]);if(App&& !App.theme){App.theme=$nim.theme;}else{$nim.theme=App?App.theme:$nim.theme;}au=$nim.bName(de,'');ret=$nim.aO.aF('skin32',au,dlg_title,l,t,w,h,style);$k.instance._last.ontop=au;$f.setstyle(de,'','z-index',$nim.ab.MOVE2TOP);$f.resize(de,'',w,h);return ret;},Surface:function(de,lW,tH,wW,hH,style){var pW=$nim.pW,pH=$nim.pH,l=pW(FORMS.Target,lW),t=pH(FORMS.Target,tH),w=pW(FORMS.Target,wW),h=pH(FORMS.Target,hH);if(App&&App.Dialog)$k.instance.newform(de,App.Dialog[de]);var au=$nim.bName(de,''),ret=$nim.aO.aC(au,l,t,w,h,style);$k.instance._last.ontop=au;$f.setstyle(de,'','z-index',$nim.ab.MOVE2TOP);$f.resize(de,'',w,h);return ret;},DivHtml:function(de,K,html){de=de.resolveName('form')||de;var au=$nim.instN(de,K);var cc=$f.cc(de,K)||DESKTOP.cc(au);if(cc){cc.innerHTML=$nim.aX('<<INST.NAME>>',au,html);}},Children:function(de,K,indx,val,blNest){var au=$nim.instN(de,K||'body');var cc=$nim.am(au);var isObj,ct=[];function objCreate(aM,bq,str,lVal){var _retval=Object.assign({},bq),ret=_retval;var arr=str.split('/');arr.forEach(function(it,bS,arr){if(it.indexOf('(')> -1)it=it.split('(')[0];if(it){if(arr.length==1){if(ret)ret[it]=lVal;}else if(bS==arr.length-1){if(ret)ret[it]=lVal;}else{if(!ret[it])ret[it]={};if(typeof(ret[it])=='object'){ret=ret[it];}else{console.warn('NIMJS:Invalid BindKey on ('+de+', '+aM.id.resolveName('control')+'): '+str);}}}});return _retval;};function getSetValue(aM,fld,lVal){var act= !$nim.undef(lVal)?'set':'get';var fnmap={set:{'(selected)':'selected','(selectindex)':'selectindex','(selectvalues)':'selectvalues','(selectvalue)':'selectvalue','(selectcaption)':'selectcaption'},get:{'(getallselected)':'getallselected','(getallvalues)':'getallvalues','(getallchecked)':'getallchecked','(getallcaptions)':'getallcaptions','(listindex)':'listindex','(selecteditem)':'selecteditem','(selectedcaption)':'selectedcaption'}};var af,typ="(text)",key,last,arr=fld.split('/');if(arr.length>0){last=arr.pop();if(last.indexOf('(')> -1){key=last.split('(')[1].split(')')[0];typ='('+key+')';}}if(act=='set'&&$nim.undef(lVal))return null;switch(typ){case '(image.class)':case '(image.title)':case '(image.src)':lVal=$f[act+'prop'](aM.Form,aM.Control,key,lVal);break;case '(video.src)':lVal=$f[act+'prop'](aM.Form,aM.Control,'src',lVal);break;case '(prop)':lVal=$f[act+'prop'](aM.Form,aM.Control,last.split('(')[0],lVal);break;case '(style)':lVal=$f[act+'style'](aM.Form,aM.Control,last.split('(')[0],lVal);break;case '(html)':af=$f.af(aM.Form,aM.Control+'.caption');if(af){if(act=='set'){af.innerHTML=lVal;}else{lVal=af.innerHTML;}}else{lVal='';}break;case '(tooltip)':if(act=='get'){lVal=$f.tooltip(aM.Form,aM.Control);}else{$f.tooltip(aM.Form,aM.Control,lVal);}break;case '(text)':lVal=$f[act+'text'](aM.Form,aM.Control,lVal);break;case '(title)':if(!aM.Control){lVal=$f[act+'title'](aM.Form,aM.Control,lVal);}else{lVal=$f[act+'prop'](aM.Form,aM.Control,last.split('(')[0],lVal);}break;case '(value)':lVal=$f[act+'value'](aM.Form,aM.Control,lVal);break;case '(tag)':lVal=$f[act+'prop'](aM.Form,aM.Control,'tag',lVal);break;case '(json)':lVal=$f[act+'prop'](aM.Form,aM.Control,'json',lVal);break;case '(checked)':lVal=$f[act+'checked'](aM.Form,aM.Control,lVal);break;case '(selectvalues)':lVal=Array.isArray(lVal)?lVal:[lVal];lVal.forEach(function(v){$f.list.selectvalue(aM.Form,aM.Control,v);});break;case '(itemdata)':lVal=$f.list.itemdata(aM.Form,aM.Control,$f.list.listindex(aM.Form,aM.Control));break;default:if(fnmap[act][typ]){lVal=$f.list[fnmap[act][typ]](aM.Form,aM.Control,lVal);}else{lVal=$f[act+'prop'](aM.Form,aM.Control,key,lVal);}}return(act=='get')?(typeof(lVal)=='boolean')?lVal:(lVal||""):null;};function processKey(it,indx){var _itm=isObj?ct:{},id=it.id.resolveName(),bq=$f.getprop(id.Form,id.Control,'bind,bindmap,bindkey'),flds=bq.bindmap.split(','),keys=bq.bindkey.split(',');keys.forEach(function(key,bS){var digVal,name=id.Control;var fld,fnl;if(key){fld=key.split('/').pop().split('(')[0];if(indx=='map'){if(fld.left(1)=='_'){fnl=flds[bS]||fld;}else{if(flds.length>1){fnl=flds[bS]||name.split(':')[1]||fld||name;}else{fnl=flds[bS]||name.split(':')[1]||fld||name;}}_itm[fnl]=key;}else if(indx=='digest'){digVal=key.split('(')[0].nav(val,'/');if(!$nim.undef(digVal))getSetValue(id,key,digVal);}else{_itm=objCreate(id,_itm,key,(indx=='struct')?'':(indx=='keys')?key:getSetValue(id,key));}}});if(isObj){ct=$nim.G.deepMerge(ct,_itm)}else{if(Object.keys(_itm).length>0){_itm=Object.assign({_ctrl:id.Control},_itm);ct.push(_itm);}}if(it.ctype=='div'){it.childNodes.forEach(function(itelm){if(itelm.id){processKey(itelm,indx);}});}};if(cc){if(blNest){isObj=indx.indexOf('[]')== -1&&['map','keys','struct','consume'].indexOf(indx)> -1;if(isObj)ct={};indx=$nim.aX('[]','',indx);processKey(cc,indx);cc.childNodes.forEach(function(it,ix){var id=it.id.resolveName(),res=$f.children(de,id.Control,indx,val?val[ix]||val:null);if(indx!='digest'){if(isObj){ct=$nim.G.deepMerge(ct,res)}else{if(Object.keys(res).length>0){res=Object.assign({_ctrl:id.Control},res);ct.push(res);}}}else{ct=true;}});return ct;}else{if(indx=='*'){return cc.childNodes;}else if(indx=='ids'){cc.childNodes.forEach(function(it){ct.push(it.id);});return ct;}else if(['hide','show','enable','disable'].indexOf(indx)> -1){ct=Array.from(cc.childNodes);while(ct.length>0){var it=ct.pop(),aM=it.id.resolveName();$f[indx](aM.Form,aM.Control);}return true;}else if(indx=='clear'){ct=Array.from(cc.childNodes);while(ct.length>0){var aM,it=ct.pop();if(it.id){aM=it.id.resolveName();$f.unload(aM.Form,aM.Control);}}return true;}else if(indx=='items'){cc.childNodes.forEach(function(it){if(it.id){ct.push({id:it.id,item:it.id.resolveName()});}});return ct;}else if(['map','keys','struct','consume'].indexOf(indx)> -1){ct={};isObj=true;processKey(cc,indx);cc.childNodes.forEach(function(it){if(it.id){processKey(it,indx);}});return ct;}else if(indx=='digest'){processKey(cc,indx);cc.childNodes.forEach(function(it){if(it.id){processKey(it,indx);}});return true;}else if(typeof(indx)=='string'&&['set','get'].indexOf(indx.left(3))> -1){cc.childNodes.forEach(function(it,cidx){var setVal;var bq={},res,id=it.id.resolveName();var route=id.Control+'.'+indx.substr(3);if($f[indx]){if(Array.isArray(val)){if(['setpos','setsize'].indexOf(indx)> -1){res=$f[indx](id.Form,id.Control,val[cidx]);}else if(['setpos','setsize','setvalue','settext','settitle','settitle','settooltip'].indexOf(indx)> -1){res=$f[indx](id.Form,id.Control,(typeof(val[cidx])=='string')?val[cidx]:(route.nav(val[cidx],'.',true)||''));}}else{if(['getpos','getsize','getvalue','gettext','gettitle','gettitle','gettooltip'].indexOf(indx)> -1){res=$f[indx](id.Form,id.Control);}else{res=$f[indx](id.Form,id.Control,(typeof(val)=='string')?val:(route.nav(val,'.',true)||''));}if($nim.G.type(res)=='object'){bq=res;}else{bq[val]=res;}}ct.push(Object.assign({id:it.id},bq));}});return(indx.left(3)=='get')?ct:true;}else{if(!isNaN(indx)){return cc.childNodes[indx];}else{return cc.childNodes.length;}}}}},InsertHtml:function(id,html){var cc=$nim.am(id)||DESKTOP.cc(id);if(cc){cc.innerHTML=html+cc.innerHTML;}},Html:function(de,K,html){de=de.resolveName('form')||de;var au=$nim.instN(de,K);var cc=$nim.am(au)||$f.cc(de,K);if(cc){cc.innerHTML=$nim.aX('<<INST.NAME>>',au,html);}},InsertStatic:function(dlg,af,suffix,type,blFirst,l,t,w,h){var parentElm=FORMS.af(dlg,af);var newnode=document.createElement(type);if(newnode){$nim.G.setAttrs(newnode,{id:FORMS.BuildName(dlg,af+suffix),'lock-pos':'!!!!','lock-size':'!!!!','dock':'!!!!'});$nim.G.lockFlags(newnode);newnode.style['position']='relative';newnode.style['left']=l+'px';newnode.style['top']=t+'px';newnode.style['width']=w+'px';newnode.style['height']=h+'px';if(blFirst){parentElm.insertBefore(newnode,parentElm.children[0]||null);}else{parentElm.insertBefore(newnode,null);}}},Acquire:function(de,K,orientation){var au=$nim.instN(de,K);try{if(!$k.isapirunning('Acquire',au)){$nim.aO.Acquire(au,orientation);}}catch(err){}finally{$k.apicomplete('Acquire',au);}},Release:function(de,K,orientation){var au=$nim.instN(de,K);try{if(!$k.isapirunning('Release',au)){$nim.aO.Release(au,orientation);}}catch(err){}finally{$k.apicomplete('Release',au);}},Consume:function(de,K){var ret,au=$nim.instN(de,K);try{if(!$k.isapirunning('Consume',au)){ret=$nim.aO.Consume(au);}}catch(err){}finally{$k.apicomplete('Consume',au);}return ret;},Digest:function(de,K,digestParams,data,clear){var ret,au=$nim.instN(de,K);try{if(!$k.isapirunning('Digest',au)){ret=$nim.aO.Digest(au,digestParams,data,clear);}}catch(err){}finally{$k.apicomplete('Digest',au);}return ret;},Hide:function(de,K){var au=$nim.instN(de,K),cc=$f.cc(de,K);try{if(!$k.isapirunning('Hide',au)){var func=$f.getprop(de,K,'onhide');if(typeof func=='function'){FORMS.SetEvent(de,K,'onhide',null);func($nim.G.buildEvent('system',cc));}func=null;$nim.aO.Hide(de,K);}}catch(err){}finally{$k.apicomplete('Hide',au);}},Load:function(de,pos,show){de=de||"";if(App&&App.Dialog&&App.Dialog[de]){if(!$f.cc(de)&&App.Dialog[de].isLoaded)App.Dialog[de].isLoaded=0;}var ret='',au=$nim.instN(de);try{if(!$k.isapirunning('Load',au)){if(App){if(App.Dialog&&App.Dialog[de]){if(!App.Dialog[de].isLoaded){ret=App.Dialog[de].Load(pos,show);}else{ret=$nim.instN(de,'');}}}if(show){$f.show(de);}}}catch(err){}finally{$k.apicomplete('Load',au);}return ret;},New:function(de,pos,show){de=de||"";var ret='',au=$nim.instN(de);try{if(!$k.isapirunning('New',au)){if(App){if(App.Dialog&&App.Dialog[de]){ret=App.Dialog[de].New(pos,show);}}}}catch(err){}finally{$k.apicomplete('New',au);}return ret;},Show:function(de,K){var au=$nim.instN(de,K);var zOrdr=$f.getprop(de,'','zorder');try{if(!$k.isapirunning('Show',au)){$nim.aO.Show(de,K);if(!K&& !zOrdr)$f.zorder(de,1);if($f.model(de).enabled){$f.pull(de);}}}catch(err){}finally{$k.apicomplete('Show',au);}},isSliding:function(de,K){var ret;K=K||"";var cc=$f.cc(de,K);if(cc){if(dA($nim.dE(cc.id,'stimer'))===0){ret=false;}else{ret=true;}}return ret;},isFading:function(de,K){var ret;K=K||"";var cc=$f.cc(de,K);if(cc){if(dA($nim.dE(cc.id,'ftimer'))===0){ret=false;}else{ret=true;}}return ret;},isLoaded:function(de,K){var ret,cc=FORMS.Find(de,K);ret=cc?true:false;cc=null;return ret;},MakeSizeable:function(de,style){var au,handle,sVal,cVal,cc;if(style&&Number.isInteger(style)===false){style=(typeof(style)=='undefined')?'xy':(style&&typeof(style)=='boolean')?'xy':style;sVal=sVal|((style.indexOf('x')> -1)?$nim.cK.DlgStyles.sizablex:0);sVal=sVal|((style.indexOf('y')> -1)?$nim.cK.DlgStyles.sizabley:0);}else{sVal=style?$nim.cK.DlgStyles.sizable:0;}au=$nim.instN(de,'');au=$nim.aX('.div','',au);handle=$nim.am(au+'.resize');cc=$nim.am(au+'.div')||$nim.am(au);if(cc){if(sVal){cVal=dA($nim.dE(au,'dlg_style'))&(~$nim.cK.DlgStyles.sizable);$nim.df(au,'dlg_style',cVal|sVal);}if(handle){$nim.ab.makeSizeable(cc,handle);handle.setAttribute('display','inline');$nim.G.setDisplay(handle,'inline',false);$nim.ax.bG(au+'.resize',"resize");$nim.G.setVisibility(handle,style?'visible':'hidden');}}},MakeDragable:function(de,K,style){var au,handle,sVal,cVal,cc,key;var uGlb=$nim.cK.DlgStyles;if(style&&Number.isInteger(style)===false){style=style||'xy';sVal=sVal|((style.indexOf('x')> -1)?uGlb.dragablex:0);sVal=sVal|((style.indexOf('y')> -1)?uGlb.dragabley:0);}else{sVal=style||uGlb.dragable;style=(sVal&uGlb.dragablex)?'x':'';style+=(sVal&uGlb.dragabley)?'y':'';}au=$nim.instN(de,K);key=(K)?au.resolveName('component'):'dlgtitle';key=(key)?'.'+key:'';au=$nim.aX({'.div':'',key:''},null,au);handle=$nim.am(au+key)||$nim.am(au+'.body');cc=$nim.am(au+'.div')||$nim.am(au);if(cc){if(cc&& !handle){handle=cc;}else if(handle&& !cc){cc=handle;}if(sVal){cVal=dA($nim.dE(au,'dlg_style'))&(~uGlb.dragable);$nim.df(au,'dlg_style',cVal|sVal);}$nim.df(cc.id,'dragable',style);$nim.ab.makeDragable(cc,handle,sVal?true:false);}},ToggleState:function(dlg,G){var au=$nim.instN(dlg),de=au.resolveName('form'),dState=$nim.dE(au,'state');if(['min','max'].indexOf(dState)> -1){$f.restore(de,G);}else{$f.max(de,G);}},ClearState:function(dlg){$nim.df($nim.instN(dlg),[{name:'stateTo',value:''},{name:'state',value:'restore'}]);},State:function(dlg){return $nim.dE($nim.instN(dlg),'state');},AddWidget:function(de,K,type,fld,lW,tH,wW,hH){var pW=$nim.pW,pH=$nim.pH;var instForm=$nim.instN(de,''),bC=$nim.bName(de,K),l=pW(de,lW),t=pH(de,tH),w=pW(de,wW),h=pH(de,hH);if($nim.am(instForm+$nim.bJ+"body")===null){$nim.by.AddWidget(instForm,bC,type,fld,l,t,w,h);}else{$nim.by.AddWidget(instForm+$nim.bJ+"body",bC,type,fld,l,t,w,h);}},Add:function(de,K,type,fld,lW,tH,wW,hH){var pW=$nim.pW,pH=$nim.pH;var instForm=$nim.instN(de,''),bC=$nim.bName(de,K),l=pW(de,lW),t=pH(de,tH),w=pW(de,wW),h=pH(de,hH);if(bC.indexOf('.disabled')!= -1){$nim.by.Add(instForm,bC,type,fld,l,t,w,h);}else{if($nim.am(instForm+$nim.bJ+"body")===null){$nim.by.Add(instForm,bC,type,fld,l,t,w,h);}else{$nim.by.Add(instForm+$nim.bJ+"body",bC,type,fld,l,t,w,h);}}},Clone:function(de,K,new_ctrl,target,blSkipChild,blSkipEvents){return $nim.by.Clone(de,K,new_ctrl,target,blSkipChild,blSkipEvents);},ConsumeTargets:function(de,K,blStruct){var ret,au=$nim.instN(de,K);try{if(!$k.isapirunning('ConsumeTarget',au)){ret=$nim.by.ConsumeTargets(de,K,blStruct);}}catch(err){}finally{$k.apicomplete('ConsumeTarget',au);}return ret;},DigestTargets:function(clone_dlg,clone_ctrl,new_ctrl,target,data,clear){var ret,au=$nim.instN(de,K);try{if(!$k.isapirunning('DigestTarget',au)){ret=$nim.by.DigestTargets(clone_dlg,clone_ctrl,new_ctrl,target,data,clear);}}catch(err){}finally{$k.apicomplete('DigestTarget',au);}return ret;},Next:function(de,K,target,blSkipChild,blSkipEvents){return $nim.by.Next(de,K,target,blSkipChild,blSkipEvents);},UpdateCoords:function(de,K){var blRes=false,cc=$f.cc(de,K);if(cc)$nim.G.updateDlgCoords(cc,'restore');},Scale:function(de,K,scale){var au=$nim.instN(de,K);var cc=$f.cc(de,K);if(cc){$nim.C.fC(cc);if(!$nim.undef(scale.x)){cc.ba=scale.x;}if(!$nim.undef(scale.y)){cc.bA=scale.y;}$nim.cQ(au,'transform',$nim.G.tranStr(cc,(! !K)));}},Translate:function(de,K,pos){var au=$nim.instN(de,K);var cc=$f.cc(de,K);if(cc){$nim.C.fC(cc);if(!$nim.undef(pos.x)){cc.az=pos.x;}if(!$nim.undef(pos.y)){cc.ar=pos.y;}if(!$nim.undef(pos.z)){cc.bj=pos.z;}$nim.cQ(au,'transform',$nim.G.tranStr(cc,(! !K)));}},Origin:function(de,K,pos){var au=$nim.instN(de,K);var cc=$f.cc(de,K);if(cc){if(typeof(cc.originX)==$nim.aq.bF(4)){cc.originX='50%';}if(typeof(cc.originY)==$nim.aq.bF(4)){cc.originY='50%';}if(typeof(cc.originZ)==$nim.aq.bF(4)){cc.originZ='0';}if(!$nim.undef(pos.x)){cc.originX=pos.x;}if(!$nim.undef(pos.y)){cc.originY=pos.y;}if(!$nim.undef(pos.z)){cc.originZ=pos.z;}if(pos===''||pos=='initial'||pos=='inherit'){$nim.cQ(au,'transform-origin',pos);}else{$nim.cQ(au,'transform-origin',pos);}}},Rotate:function(de,K,deg){var au=$nim.instN(de,K);var cc=$f.cc(de,K);if(cc){$nim.C.fC(cc);if(!$nim.undef(deg.x)){cc.rotateX=deg.x;}if(!$nim.undef(deg.y)){cc.rotateY=deg.y;}if(!$nim.undef(deg.z)){cc.rotateZ=deg.z;}$nim.cQ(au,'transform',$nim.G.tranStr(cc,(! !K)));}},CenterSize:function(de,K,wval,hval){var pW=$nim.pW,pH=$nim.pH,J='',center=$f.getcenter(de,K);if(wval.width){hval=wval.height;wval=wval.width;}if(center!==null){var cc=$f.cc(de,K);if(cc){J=(K)?$nim.instN(de):cc.getAttribute('parent');}var w=pW(J,wval),h=pH(J,hval);$f.size(de,K,w,h);$f.center(de,K,center.x,center.y);}},Size:function(de,K,wval,hval){if(wval.width){hval=wval.height;wval=wval.width;}$nim.aO.Size(de,K,wval,hval);},Resize:function(de,K,w,h){if(w.width){h=w.height;w=w.width;}if(K){$nim.aO.Size(de,K,w,h);}else{$nim.aO.Resize(de,K,w,h);}},Caption:function(de,K,txt){if($nim.undef(txt)){return $f.getcaption(de,K,txt);}else{$f.setcaption(de,K,txt);}},Tooltip:function(de,K,txt){var au=$nim.instN(de,K);if(txt){$nim.df(au,'title',txt);}else{return $nim.dE(au,'title');}},GetTooltip:function(de,K){var au=$nim.instN(de,K);return $nim.dE(au,'title');},SetTooltip:function(de,K,txt){var au=$nim.instN(de,K);$nim.df(au,'title',txt);},Unload:function(de,K){var func=$f.getprop(de,K,'onunload'),cc=$f.cc(de,K);if(typeof func=='function'){FORMS.SetEvent(de,K,'onunload',null);func($nim.G.buildEvent('system',cc));}func=null;$nim.aO.Unload(de,K);},zIndex:function(de,zVal){var au=$nim.instN(de,'');au=(au.indexOf(']~')== -1)?$nim.bName(de,''):au;$f.setprop(de,'','zorder',zVal);$nim.cQ(au,'z-index',$nim.G.zindex[zVal.toString()]);if(zVal>2)$k.instance._last.ontop=au;},zOrder:function(de,zVal,blForce){var x,cc;var au=$nim.instN(de,'');$f.setprop(au,'','zorder',zVal);$k.instance.save();for(x=0;x<FORMS.list.length;x++){cc=$f.cc(FORMS.list[x],'');$k.instance.setbyelemid(FORMS.list[x]);if(au.resolveName('instform')==FORMS.list[x].resolveName('instform')){if(blForce||$nim.dE(FORMS.list[x],'ignorezorder')=='false'){$nim.cQ(FORMS.list[x],'z-index',$nim.G.zindex[zVal.toString()]);if(zVal>2)$k.instance._last.ontop=au;}}else{if($nim.dE(FORMS.list[x],'ignorezorder')=='false'){if($nim.dj(FORMS.list[x],'z-index')!=$nim.ab.MOVE2TOPMOST){if($nim.dE(FORMS.list[x],'state')=='min'){$nim.cQ(FORMS.list[x],'z-index',$nim.ab.MOVE2BOTTOM);}else{$nim.cQ(FORMS.list[x],'z-index',$nim.ab.MOVE2BACK);}}}}}$k.instance.restore();},RemoveEvent:function(de,K,eventType,handler){var au=$nim.instN(de,K);$nim.by.removeEvent(au,eventType,handler);},AddEvent:function(de,K,eventType,handler){var au=$nim.instN(de,K);$nim.by.addEvent(au,eventType,handler);},Interface:function(dlg){if(USER){dlg=dlg.resolveName('form')||dlg;if(!USER._interfaces){USER._interfaces={};}return(USER._interfaces[dlg])?USER._interfaces[dlg]:null;}else{return null;}},Events:function(dlg,G){var evt;if(App&&App.Dialog){if(App.Dialog[dlg]){if(G){evt=$f.getprop(dlg,'','event-'+G.toLowerCase());if(evt){if(typeof(AppEvents)!='undefined'&&evt.nav(AppEvents)){return evt.nav(AppEvents)||App.Dialog[dlg].Events[G]||App.Dialog[dlg].Events['form_'+G]||$nim.by.defaultEvent;}else{console.warn('NIMJS:'+dlg+'.Events missing: "'+G+': '+evt+'".');return $nim.by.noEvent;}}else if(App.Dialog[dlg].Events['form_'+G]){return App.Dialog[dlg].Events['form_'+G];}else if(App.Dialog[dlg].Events[G]){return App.Dialog[dlg].Events[G];}else{return $nim.by.noEvent;}}else{return App.Dialog[dlg].Events;}}}return{};},Ini:function(res){var ret;res=res.toLowerCase();if(App&&App.Code&&App.Code.Ini){ret=App.Code.Ini[res]||'';ret=$nim.aX({"<CR>":"\r\n","<SQ>":"'","<DQ>":'"'},null,ret);}return ret;},Csv:function(res){var ret;res=res.toLowerCase();if(App&&App.Code&&App.Code.Csv){ret=App.Code.Csv[res]||'';ret=$nim.aX({"<CR>":"\r\n","<SQ>":"'","<DQ>":'"'},null,ret);}return ret;},Data:function(res){var ret;res=res.toLowerCase();if(App&&App.Code&&App.Code.Data){if(App.Code.Data[res]){ret=App.Code.Data[res].data||'';ret=$nim.aX({"<CR>":"\r\n","<SQ>":"'","<DQ>":'"'},null,ret);}}return ret;},Code:function(dlg){if(App&&App.Dialog){if(App.Dialog[dlg]){return App.Dialog[dlg].Code;}}return{};},Model:function(dlg){if(App&&App.Dialog){if(App.Dialog[dlg]&&App.Model&&App.Model.enabled[dlg]){if(!App.Model)App.Model=App.Dialog[dlg].Model;App.Model._focus=dlg;return App.Model;}}return{};},Bind:function(de,K,bindNme){var cc,au=$nim.instN(de,K);au=(au.indexOf(']~')== -1)?$nim.bName(de,K+$nim.bJ+"div"):au;cc=FORMS.Find(au);if(cc){$nim.df(cc.id,"bindid",bindNme);}},SetFocus:function(de,K){var id,last,cc=$nim.G.V($nim.instN(de,K));if(cc){if(!K||cc["ctype"]=='imagex'){$nim.aO.setFocus(cc);if(!K)$k.instance.setbyelemid(cc.id);}else{id=$nim._.core.lastFocus;if(id){last=FORMS.af(id.resolveName('form'),id.resolveName('control'));if(last)last.blur();}cc.focus();$nim._.core.lastFocus=cc.id;}}},SetFirstInstance:function(appname){$k.instance.setfirstinstance(appname);},SetInstanceByModuleName:function(appname,de){KERNEL.Instance.SetByModule(appname,de);if(App){$nim.G.AssignInstance(App,FORMS.GetInstName(de));}},SetEvent:function(de,K,event,G){var au=$nim.instN(de,K);$nim.by.setEvent(au,event,G);},SetProp:function(de,K,bE,val){var au=$nim.instN(de,K);au=$nim._syselems.indexOf(de)> -1?de:(au.indexOf(']~')== -1)?$nim.bName(de,K):au;$nim.df(au,bE,val);},SetStyle:function(de,K,bE,val){var au=$nim.instN(de,K);au=$nim._syselems.indexOf(de)> -1?de:(au.indexOf(']~')== -1)?$nim.bName(de,K):au;$nim.cQ(au,bE,val);},Config:function(de,K,props){var au=$nim.instN(de,K);au=(au.indexOf(']~')== -1)?$nim.bName(de,K):au;$nim.config(au,props);},GetDigestMgr:function(de,K){var instFrm=$nim.instN(de,K).resolveName('instform');if(App&&App.Dialog){if(App.Dialog[de]){if(App.Dialog[de].Digest&&App.Dialog[de].Digest[instFrm]){if(!K){return App.Dialog[de].Digest[instFrm];}else{return App.Dialog[de].Digest[instFrm][K];}}}}return null;},GetInstName:function(de,K,bq){K=K||"";bq=bq||"";if(KERNEL.isFormLoaded(de)){return $nim.instN(de,K,bq);}else{return $nim.instN(de.resolveName('form'),K,bq);}},GetProp:function(de,K,bE){var au=$nim.instN(de,K);au=$nim._syselems.indexOf(de)> -1?de:(au.indexOf(']~')== -1)?$nim.bName(de,K):au;return $nim.dE(au,bE);},GetStyle:function(de,K,bE){var au=$nim.instN(de,K);au=$nim._syselems.indexOf(de)> -1?de:(au.indexOf(']~')== -1)?$nim.bName(de,K):au;return $nim.dj(au,bE);},GetClientSize:function(de){return FORMS.GetSize(de,'body');},GetScreenCoords:function(dlg,af){return $nim.by.GetScreenPos(dlg,af,true);},Enable:$nim.by.Enable,Disable:$nim.by.Disable,DisableContent:$nim.by.DisableContent,CreateTab:$nim.by.Tab.CreateTab,GetPos:$nim.by.dH,SetPos:$nim.by.cL,Move:$nim.by.cL,Caption:$nim.by.Caption,GetCaption:$nim.by.Caption,SetCaption:$nim.by.Caption,Text:$nim.by.Text,GetText:$nim.by.Text,SetText:$nim.by.Text,Checked:$nim.by.Checked,GetChecked:$nim.by.Checked,SetChecked:$nim.by.Checked,PushTarget:$nim.by.PushTarget,PullTarget:$nim.by.PullTarget,Value:$nim.by.Value,GetValue:$nim.by.Value,SetValue:$nim.by.Value,Left:$nim.by.Left,Top:$nim.by.Top,GetScreenPos:$nim.by.GetScreenPos,CalcCoordsRelative:$nim.by.CalcCoordsRelative,FadeIn:$nim.by.fadeIn,FadeOut:$nim.by.fadeOut,Type:$nim.aO.Type,isWidget:$nim.aO.isWidget,isVisible:$nim.aO.isVisible,isEnabled:$nim.aO.isEnabled,SetInstanceByElemId:$nim.aO.setInstance,Title:$nim.aO.Title,GetTitle:$nim.aO.Title,SetTitle:$nim.aO.Title,DockTop:$nim.aO.DockTop,DockBottom:$nim.aO.DockBottom,DockLeft:$nim.aO.DockLeft,DockRight:$nim.aO.DockRight,Min:$nim.aO.Min,Max:$nim.aO.Max,Restore:$nim.aO.Restore,Full:$nim.aO.FullScreen,FullScreen:$nim.aO.FullScreen,Height:$nim.aO.Height,Width:$nim.aO.Width,WidthRange:$nim.aO.WidthRange,HeightRange:$nim.aO.HeightRange,Refresh:$nim.aO.Refresh,Push:$nim.aO.Push,Pull:$nim.aO.Pull,GetCenter:$nim.aO.GetCenter,Visible:$nim.aO.Visible,GetVisible:$nim.aO.Visible,SetVisible:$nim.aO.Visible,GetParent:$nim.aO.GetParent,BoxSize:$nim.aO.BoxSize,NaturalSize:$nim.aO.NaturalSize,GetSize:$nim.aO.GetSize,SetSize:$nim.aO.Size,GetCoords:$nim.aO.GetCoords,SetCoords:$nim.aO.SetCoords,MoveTo:$nim.aO.MoveTo,SlideTo:$nim.aO.SlideTo,CenterTo:$nim.aO.CenterTo,RotateTo:$nim.aO.RotateTo,Center:$nim.aO.Center,hCenter:$nim.aO.hCenter,vCenter:$nim.aO.vCenter,Flip:$nim.aO.Flip,Switch:$nim.aO.Switch,eachForm:$nim.aO.eachForm,eachControl:$nim.aO.eachControl,UnloadAll:$nim.aO.UnloadAll,Forms:function(){return(App&&App.Dialog)?Object.keys(App.Dialog):[];},FormInstances:function(){return(App&&App.Dialogs)?App.Dialogs:[];},Widgets:function(dlg){if(App&&App.Dialog){return(App.Dialog[dlg])?Object.keys(App.Dialog[dlg].Widgets):[];}},Controls:function(dlg,af){var au=$nim.instN(dlg,af);var cc=$nim.am(au);if(!af){if(App&&App.Dialog){return(App.Dialog[dlg])?App.Dialog[dlg].Controls:[];}}else{if(cc){return Array.from(cc.childNodes).map(function(it){return it.id.resolveName('control')||it.id||"";});}}},Class:{get:function(de,K){var au=$nim.instN(de,K);return $nim.dE(au,'class');},set:function(de,K,newCls){var au=$nim.instN(de,K);$nim.df(au,'class',newCls);},add:function(de,K,newCls){de=de||"";K=K||"";var au=$nim.bName(de,K),cls=$nim.dE(au,'class')||"";if(cls.indexOf(newCls)== -1){cls+=' '+newCls;cls=$nim.aX("  "," ",cls);$nim.df(au,'class',cls);}},toggle:function(de,K,newCls){var au=$nim.instN(de,K),cls=$nim.dE(au,'class')||"";if(cls.indexOf(newCls)== -1){cls+=' '+newCls;cls=$nim.aX("  "," ",cls);}else{cls=$nim.aX(newCls,"",cls);cls=$nim.aX("  "," ",cls);}$nim.df(au,'class',cls);},remove:function(de,K,remCls){var au=$nim.instN(de,K),cls=$nim.dE(au,'class')||"";cls=$nim.aX(remCls,"",cls);cls=$nim.aX("  "," ",cls);$nim.df(au,'class',cls);},swap:function(de,K,src,des){var au=$nim.instN(de,K),cls=$nim.dE(au,'class')||"";cls=$nim.aX(src,des,cls);cls=$nim.aX("  "," ",cls);$nim.df(au,'class',cls);},invert:function(de,K,curCls){curCls=curCls||"";if(curCls){var au=$nim.instN(de,K),cls=$nim.dE(au,'class')||"",invCls=curCls.split('').reverse().join('');if(cls.indexOf(curCls)> -1){cls=$nim.aX(curCls,invCls,cls);cls=$nim.aX("  "," ",cls);}else if(cls.indexOf(invCls)> -1){cls=$nim.aX(invCls,curCls,cls);cls=$nim.aX("  "," ",cls);}$nim.df(au,'class',cls);}},list:function(de,K){var au=$nim.instN(de,K),cls=$nim.dE(au,'class')||"";cls=$nim.aX("  "," ",cls);return cls.split(" ");},exists:function(de,K,chkCls){de=de||"";K=K||"";var au=$nim.instN(de,K),cls=$nim.dE(au,"class")||"";cls=$nim.aX("  "," ",cls);return(cls.indexOf(chkCls)> -1)?true:false;}},Menu:{AddItem:$nim.Menu.AddItem,RemoveItem:$nim.Menu.RemoveItem,Hide:$nim.Menu.Hide,Unload:$nim.Menu.Unload,Open:$nim.Menu.Open,Show:$nim.Menu.Show,CloseAll:$nim.Menu.CloseAll},StatusBar:{Show:$nim.StatusBar.Show,Unload:$nim.StatusBar.Unload},ToolBar:{Show:$nim.ToolBar.Show,Unload:$nim.ToolBar.Unload},Tab:{cc:function(de,K,pageNum){K=K||"";var au=$nim.instN(de,K);if(pageNum){au=$nim.instN(de,K,'page'+pageNum);}return $nim.G.V(au);},Create:$nim.by.Tab.CreateTab,Page:function(de,K){return Number($f.getprop(de,K,'page'))||1;},Pages:function(de,K){K=K||"";var ai=0,au=$nim.instN(de,K),cc=$nim.G.V(au);if(cc){ai=$nim.dE(cc.id,"pages");}return ai;},Select:function(de,K,pageNum){K=K||"";var au=$nim.instN(de,K,'page'+pageNum+$nim.bJ+'caption');$nim.ax.triggerEvent(au,'mousedown');$nim.ax.triggerEvent(au,'click');},Add:$nim.by.Tab.Add,Remove:$nim.by.Tab.Remove,Position:$nim.by.Tab.Position,TabScroll:function(de,K,enble){K=K||"";var au=$nim.instN(de,K),cc=$nim.G.V(au);if(cc){switch(enble){case true:$nim.cQ(au+$nim.bJ+'left','display','block');$nim.cQ(au+$nim.bJ+'right','display','block');$f.move(de,K+$nim.bJ+'clip',45,0);$f.move(de,K+$nim.bJ+"tabs",0,0);break;default:$nim.cQ(au+$nim.bJ+'left','display','none');$nim.cQ(au+$nim.bJ+'right','display','none');$f.move(de,K+$nim.bJ+'clip',0,0);$f.move(de,K+$nim.bJ+"tabs",0,0);break;}}}},List:{Get:$nim.by.List.Get,item:$nim.by.List.item,AddList:$nim.by.List.AddList,AddChild:$nim.by.List.AddChild,Add:$nim.by.List.Add,Insert:$nim.by.List.Insert,Remove:$nim.by.List.Remove,RemoveSelected:$nim.by.List.RemoveSelected,Clear:$nim.by.List.Clear,ClearNode:$nim.by.List.ClearNode,ListIndex:$nim.by.List.ListIndex,ListCount:$nim.by.List.ListCount,SelectValue:$nim.by.List.SelectValue,SelectCaption:$nim.by.List.SelectCaption,SelectIndex:$nim.by.List.SelectIndex,SelectCheck:$nim.by.List.SelectCheck,GetText:$nim.by.List.GetText,SetText:$nim.by.List.SetText,GetValue:$nim.by.List.GetValue,GetItemData:$nim.by.List.GetItemData,SetItemData:$nim.by.List.SetItemData,Selected:$nim.by.List.Selected,SetSelected:$nim.by.List.SetSelected,SelectedItem:$nim.by.List.SelectedItem,SelectedValue:$nim.by.List.SelectedItem,SelectedCaption:$nim.by.List.SelectedCaption,GetAllSelected:$nim.by.List.GetAllSelected,GetAllValues:$nim.by.List.GetAllValues,GetAllChecked:$nim.by.List.GetAllChecked,GetAllCaptions:$nim.by.List.GetAllCaptions,GetItemName:$nim.by.List.GetItemName,GetItemParent:$nim.by.List.GetItemParent,GetItemCaption:$nim.by.List.GetItemCaption,Exists:$nim.by.List.Exists,Find:$nim.by.List.Find,FindExact:$nim.by.List.FindExact},PicClip:{SetRows:$nim.by.PicClip.Rows,GetRows:$nim.by.PicClip.Rows,SetCols:$nim.by.PicClip.Cols,GetCols:$nim.by.PicClip.Cols,SetGraphicCell:$nim.by.PicClip.GraphicCell,GetGraphicCell:$nim.by.PicClip.GraphicCell,GetCellCount:$nim.by.PicClip.GetCellCount,ResetCellSize:$nim.by.PicClip.ResetCellSize,SetCellSize:$nim.by.PicClip.SetCellSize,GetCellSize:$nim.by.PicClip.GetCellSize,GetImageSize:$nim.by.PicClip.GetImageSize,GetCellWidth:$nim.by.PicClip.GetCellWidth,GetCellHeight:$nim.by.PicClip.GetCellHeight},Alter:{View:{Hide:function(de,trans){var au=$nim.instN(de,'');var cc=$nim.am(au+$nim.bJ+"body");if(cc){$nim.C.View.Hide(null,cc,trans);}},Set:function(de,vwName,trans,blMatch,blAdd){$nim.C.View.Set(de,vwName,trans,blMatch,blAdd);}},Gradient:function(de,K,dir,start,end){var cc=$f.cc(de,K);if(cc){switch(dir){case 'bottom-top':end=[start,start=end][0];case 'top-bottom':cc.style.background='-webkit-linear-gradient('+start+', '+end+')';cc.style.background='-o-linear-gradient('+start+', '+end+')';cc.style.background='-moz-linear-gradient('+start+', '+end+')';cc.style.background='linear-gradient('+start+', '+end+')';break;case 'right-left':end=[start,start=end][0];case 'left-right':cc.style.background='-webkit-linear-gradient(left, '+start+', '+end+')';cc.style.background='-o-linear-gradient(right, '+start+', '+end+')';cc.style.background='-moz-linear-gradient(right, '+start+', '+end+')';cc.style.background='linear-gradient(right, '+start+', '+end+')';break;default:break;}}},Link:function(de,K,txt,url){var cap=$f.caption(de,K);var href='<a href="'+url+'">'+txt+'</a>';cap=$nim.aX(txt,href,cap);$f.caption(de,K,cap);}}};$nim.stateCheck=setInterval(function(){if(document.readyState=='complete'){clearInterval($nim.stateCheck);if(DESKTOP&&(!DESKTOP.width|| !DESKTOP.height)){$nim._.core.docDimensions=$nim.ax.findDocumentDimensions();$nim._.core.winDimensions=$nim.ax.findWindowDimensions();DESKTOP.width=$nim._.core.winDimensions.width;$nim.G.setDesktopHeight();}$nim.ax.mobileVersion();}},100);$nim.SetId=KERNEL.Instance.SetByElemId;$nim.SetFI=KERNEL.Instance.SetFirstInstance;DESKTOP["elem"]=DESKTOP.cc;FORMS["ctrl"]=FORMS.af;FORMS["elem"]=FORMS.cc;FORMS.Tab["elem"]=FORMS.Tab.cc;var CSV=$nim.cG;var CGI=$nim.dF;var AJAX=$nim.dR;var KEYBOARD=$nim.Key;var MOUSE=$nim.Mouse;var FACTORY=$nim.serviceFACTORY;var SERVICE=$nim.serviceSERVICES;var NOTIFY=$nim.serviceNOTIFY;var JS=$nim.JS;var DB={SORTER:$nim.SORTER,FILTER:$nim.FILTER};if(typeof(USER)=='undefined'){var USER={};}if(!USER._libs){USER._libs={};}function cP(des,src){function containsFunction(bq){for(var f2 in bq){if(typeof bq[f2]=='function')return true;}return false;};if(typeof des=='undefined')des={};for(var fld in src){var nfld=fld.toLowerCase();if(typeof src[fld]=='function'){des[nfld]=src[fld];}else if(!Array.isArray(src[fld])&&typeof src[fld]=='object'&&containsFunction(src[fld])){des[nfld]={};var newDes=des[nfld],newSrc=src[fld];cP(newDes,newSrc);}else if(typeof src[fld]=='object'){des[nfld]=src[fld];}}cU(des);};var $f={},$k={},$g={},$d={app:{},key:{}},$ntfy={},$fctry={},$cgi={},$ajx={},$svc={},$jcsv={},$jsort={},$jfltr={},$me=null;var shMap=[$f,$k,$d.app,$d.key,$d.mouse,$d,$ntfy,$fctry,$cgi,$ajx,$svc,$jcsv,$jsort,$jfltr];[FORMS,KERNEL,JS,KEYBOARD,MOUSE,DESKTOP,NOTIFY,FACTORY,CGI,AJAX,SERVICE,CSV,DB.SORTER,DB.FILTER].forEach(function(src,index){cP(shMap[index],src);});var $with=function(bq,G,inArgs){var arg,ret=[],blShift=Array.isArray(G),inArgs=blShift?G:inArgs,args=inArgs.slice()||[];$k.instance.save();if(blShift||(bq&&G&&$nim.isobj(bq)&&$nim.isfnc(bq[G]))){for(var i=0;i<args.length;i++){try{arg=Array.isArray(args[i])?args[i]:args[i]?[args[i]]:[];if(!blShift||bq&&arg[0]&&$nim.isobj(bq)&&$nim.isfnc(bq[arg[0]])){G=blShift?arg.shift():G;if(typeof(arg[0])=='string'&&arg[0].resolveName('forminst'))$k.instance.setbyelemid(arg[0]);ret.push(bq[G].apply(bq[G],arg));}}catch(err){}}}$k.instance.restore();return ret;};$nim._keys=$nim.aq.bF;shMap.length=0;shMap=null; 
if(typeof($nim)=='undefined'){var $nim={};}if(typeof($nim.HTML)=='undefined'){$nim.HTML={};}$nim.HTML["tbar-icon"]='<img class="iconimg sdk-itm" id="#element.name#.#icon#.image" form="<dlg.form>" src="<icon.img>">'+'<span class="iconcaption sdk-itm" id="#element.name#.#icon#.caption" form="<dlg.form>" style="color:#color#"><caption></span>';$nim.HTML["canvas"]='<canvas id="#element.name#" type="canvas" form="<dlg.form>" width="#var.w#" height="#var.h#" #class# #parms# #events# #style#></canvas>';$nim.HTML["imgbuttonx"]='<button id="#element.name#" type="imgbuttonx" form="<dlg.form>" #class# #parms# #events# #style#>'+'<img id="#element.name##cdelim#image" form="<dlg.form>" index="#element.name#" src="#element.field.image#" style="width:100%;height:100%;#parent.zindex#" #events#>'+'<div id="#element.name##cdelim#caption" form="<dlg.form>" style="width: 100%;left: 0px;">#element.field.caption#</div>'+'</button>';$nim.HTML["multilist"]='<div id="#element.name#" type="list" form="<dlg.form>" #class# #parms# #events# #style#>'+'<select multiple id="#element.name#.items" size="99" type="list" direction="vertical" form="<dlg.form>" style="overflow:auto;font:inherit;width:100%;height:100%;border:none;">'+'#element.menu#'+'</select>'+'</div>';$nim.HTML["tab-pan"]='<div id="#element.name##cdelim#page#x##cdelim#body" type="tab-page" form="<dlg.form>" #parms# index="#x#" class="tab-content #element.active#" origSize="#element.osize#" style="box-sizing:border-box;background-color:inherit;text-overflow:clip;overflow:hidden;left:0px;top:2px;width:99.6%;height:99.6%;"></div>';$nim.HTML["tab-li"]='<li id="#element.name##cdelim#page#x##cdelim#div" type="tab-item" form="<dlg.form>" style="opacity:1;background-color:inherit;color:inherit;height:#title.h#px;width:auto;float:left;cursor:pointer;" type="tab-item" form="<dlg.form>" #parms# index="#x#" pages="#element.titles.length#" class="#element.active#">'+'<div id="#element.name##cdelim#page#x#" type="tab-item" form="<dlg.form>" #parms# index="#x#" pages="#element.titles.length#" style="background-color:inherit;color:inherit;padding: 10px 10px 0px 10px"><div id="#element.name##cdelim#page#x##cdelim#caption" class="tab-caption item_center" form="<dlg.form>" #parms# index="#x#" pages="#element.titles.length#">#element.titles#</div></div></li>';$nim.HTML["tab"]='<div id="#element.name#" type="tab" form="<dlg.form>" #parms# style="position:absolute;left:0px;top:0px;width:100%;height:100%;">'+'<div id="#element.name##cdelim#container" form="<dlg.form>" #parms# class="tab-container" style="position:absolute;left:0px;top:0px;width:100%;height:100%;">'+'<div id="#element.name##cdelim#pages" form="<dlg.form>" class="tab-pages" style="position:absolute;left:0px;top:1px;width:100%;height:#title.h#px;z-index:6;">'+'<div id="#element.name##cdelim#left" form="<dlg.form>" class="tab-buttons" style="background-color:inherit;left:0px;top:0px;width:15px;height:#btn.h#px;"><</div>'+'<div id="#element.name##cdelim#right" form="<dlg.form>" class="tab-buttons" style="background-color:inherit;left:0px;top:0px;width:15px;height:#btn.h#px;">></div>'+'<div id="#element.name##cdelim#clip" form="<dlg.form>" dock="TTTT" style="background-color:inherit;overflow:hidden;position:absolute;left:45px;top:0px;width:#clip.w#px;height:#title.h#px;z-index:6;">'+'<div id="#element.name##cdelim#tabs" form="<dlg.form>" class="tab-pages" style="position:absolute;left:0px;top:0px;width:auto;height:#title.h#px;z-index:6;">'+'<ul id="#element.name##cdelim#items" form="<dlg.form>" class="tab-items">'+'<li id="!#element.name##cdelim#page#x##cdelim#div" style="display:none;height:#title.h#px;width:auto;float:left;cursor:pointer;" form="<dlg.form>" #parms# index="#x#" pages="#element.titles.length#" class="#element.active#">'+'<div id="#element.name##cdelim#page#x#" type="tab-item" form="<dlg.form>" #parms# index="#x#" pages="#element.titles.length#" style="background-color:inherit;color:inherit;padding: 10px 10px 0px 10px">'+'<div id="#element.name##cdelim#page#x##cdelim#caption" class="tab-caption item_center" form="<dlg.form>" #parms# index="#x#" pages="#element.titles.length#">#new.caption#</div>'+'</div>'+'</li>'+'#element.tabs#'+'</ul>'+'</div>'+'</div>'+'</div>'+'<div id="#element.name##cdelim#panes" form="<dlg.form>" class="tab-panes" #parms# style="position:absolute;left:0px;top:#panes.t#px;width:100%;height:#body.h#px;z-index:1;">'+'<div id="!#element.name##cdelim#page#x##cdelim#body" form="<dlg.form>" #parms# index="#x#" class="tab-content #element.active#" origSize="#element.osize#" style="display:none;box-sizing:border-box;text-overflow:clip;overflow:hidden;left:0px;top:2px;width:99.6%;height:99.6%;">'+'</div>'+'#element.tabpanes#'+'</div>'+'</div>'+'</div>';$nim.HTML["date"]='<div id="#element.name#" type="date" form="<dlg.form>" #class# #parms# #events# #style#><input type="date" id="#element.name##cdelim#edit" form="<dlg.form>" #element.field# style="font:inherit;width:100%;height:100%;" #parms#></input></div>';$nim.HTML["image"]='<img id="#element.name#" type="image" form="<dlg.form>" src="#element.field#" #class# #parms# #events# #style# style="pointer-events:none;"><img id="#element.name#" form="<dlg.form>" src="#element.field#" #class# #parms# #events# #style# style="pointer-events:none;">';$nim.HTML["audio"]='<audio controls><source id="#element.name#" form="<dlg.form>" src="#element.field.source#" type="#element.field.filetype#" #parms#></audio>';$nim.HTML["video"]='<video controls style="width:100%;height:100%"><source id="#element.name#" form="<dlg.form>" width="#var.w#" height="#var.h#" src="#element.field.source#" type="#element.field.filetype#"></video>';$nim.HTML["icon"]='<div id="#element.name#" type="icon" form="<dlg.form>" #class# #parms# #style#><i id="#element.name##cdelim#image" form="<dlg.form>" title="#element.tip#" index="#element.name#" src="#element.field#" style="width:100%;height:100%;#parent.zindex#" #events#></i><span id="#element.name##cdelim#caption" form="<dlg.form>" style="display:block;color:inherit;font-family:Verdana;font-size:9pt;">#element.caption#</span></div>';$nim.HTML["up-down"]='<div id="#element.name#" type="up-down" form="<dlg.form>" #class# #parms# #events# #style#><input type="number" id="#element.name##cdelim#range" #element.field# form="<dlg.form>" style="font:inherit;width:100%;height:100%;" #parms#></input></div>';$nim.HTML["slider"]='<div id="#element.name#" type="slider" form="<dlg.form>" #class# #parms# #events# #style#><input type="range" id="#element.name##cdelim#range" #element.field# form="<dlg.form>" style="font:inherit;width:100%;height:100%;" #parms#></input></div>';$nim.HTML["customdate"]='<div id="#element.name#" type="customdate" form="<dlg.form>" #class# #parms# #events# #style#><input id="#element.name##cdelim#edit" form="<dlg.form>" #element.field# style="font:inherit;width:100%;height:100%;" #parms#></input></div>';$nim.HTML["custominput"]='<div id="#element.name#" type="custominput" form="<dlg.form>" #class# #parms# #events# #style#><input id="#element.name##cdelim#edit" form="<dlg.form>" #element.field# style="font:inherit;width:100%;height:100%;" #parms#></input></div>';$nim.HTML["label"]='<div id="#element.name#" type="label" dock="!!!!" #class# #parms# #events# #style#><div id="#element.name##cdelim#caption" style="font:inherit;position:relative;display:table-cell;text-align:left;width:100%;vertical-align:middle;">#element.field#</div></div>';$nim.HTML["label-left"]='<div id="#element.name#" type="label" dock="!!!!" #class# #parms# #events# #style#><div id="#element.name##cdelim#caption" style="font:inherit;position:relative;display:table-cell;text-align:left;width:100%;vertical-align:middle;">#element.field#</div></div>';$nim.HTML["label-right"]='<div id="#element.name#" type="label" #class# #parms# #events# #style#><div id="#element.name##cdelim#caption" style="font:inherit;position:relative;display:table-cell;text-align:right;width:100%;vertical-align:middle;">#element.field#</div></div>';$nim.HTML["label-center"]='<div id="#element.name#" type="label" #class# #parms# #events# #style#><div id="#element.name##cdelim#caption" style="font:inherit;position:relative;display:table-cell;text-align:center;width:100%;vertical-align:middle;">#element.field#</div></div>';$nim.HTML["date"]='<input type="date" id="#element.name##cdelim#date" #element.field# class="date_picker" style="height:100%;width:100%;" #parms# />';$nim.HTML["date-picker"]='<input type="date" id="#element.name##cdelim#date" #element.field# class="date_picker" style="height:100%;width:100%;" #parms# />';$nim.HTML["image"]='<div id="#element.name#" type="image" #class# #parms# #events# #style#><img id="#element.name##cdelim#image" form="<dlg.form>" src="#element.field#" #class# #parms# style="pointer-events: none;"></div>';$nim.HTML["imagex"]='<div id="#element.name#" type="imagex" #class# #parms# #events# #style#><img id="#element.name##cdelim#image" src="#element.field#" form="<dlg.form>" style="pointer-events:none;width:100%;height:100%;"></div>';$nim.HTML["picclip"]='<div id="#element.name#" type="picclip" #class# #parms# #events# #style#><img id="#element.name##cdelim#image" src="#element.field#" form="<dlg.form>" style="pointer-events:none;visibility: hidden;"></div>';$nim.HTML["textbox"]='<input id="#element.name#" type="textbox" #class# #parms# #events# #style#>#element.field#</input>';$nim.HTML["textarea"]='<textarea id="#element.name#" type="textarea" #class# #parms# #events# #style#>#element.field#</textarea>';$nim.HTML["button"]='<button id="#element.name#" type="button" #class# #parms# #events# #style#><div id="#element.name##cdelim#caption">#element.field#</div></button>';$nim.HTML["imgbutton"]='<button id="#element.name#" type="imgbutton" #class# #parms# #events# #style# style="overflow:hidden;"><img id="#element.name##cdelim#image" index="#element.name#" src="#element.field.image#" form="<dlg.form>" style="#parent.zindex#" #events#><br><div id="#element.name##cdelim#caption">#element.field.caption#</div></button>';$nim.HTML["combobox"]='<div id="#element.name#" type="combobox" form="<dlg.form>" #class# #parms# #events# style="width:100%;height:100%;"><select id="#element.name#.items" type="list" direction="vertical" size="0" form="<dlg.form>" style="overflow:auto;padding:2px;font:inherit;width:100%;height:100%;border:none;">#element.list#</select></div>';$nim.HTML["listbox"]='<div id="#element.name#" type="list" form="<dlg.form>" #class# #parms# #events# #style#><select id="#element.name#.items" type="list" direction="vertical" size="#element.listsize#" #element.multiselect# form="<dlg.form>" style="overflow:auto;padding:2px;font:inherit;width:100%;height:100%;border:none;">#element.list#</select></div>';$nim.HTML["imglist"]='<div id="#element.name#" type="imglist" form="<dlg.form>" #class# #parms# #events# #style#><ul id="#element.name#.items" class="img_list" type="image" rowheight="#element.rowheight#" size="#element.listsize#" #element.multiselect# form="<dlg.form>" style="font:inherit;width:auto;height:99.6%;">#element.list#</ul></div>';$nim.HTML["image-li"]='<li id="#element.name#.item.#index#" class="img_item" type="imglist-item" form="<dlg.form>" style="color:inherit;background:inherit;height:auto;font:inherit;" value="#item.value#"><img id="#element.name#.item.#index#.image" style="width:#element.rowheight#;height:#element.rowheight#;" class="img_icon" src="#item.image#"> '+'<span id="#element.name#.item.#index#.caption" style="line-height:#element.rowheight#">#item.list#</span></li>';$nim.HTML["checklist"]='<div id="#element.name#" type="checklist" form="<dlg.form>" #class# #parms# #events# #style#><ul id="#element.name#.items" class="check_list item_center" type="check" rowheight="#element.rowheight#" size="#element.listsize#" #element.multiselect# form="<dlg.form>" style="font:inherit;width:auto;height:99.6%;">#element.list#</ul></div>';$nim.HTML["check-li"]='<li id="#element.name#.item.#index#" class="check_item" type="checklist-item" form="<dlg.form>" style="color:inherit;background:inherit;height:auto;font:inherit;" value="#item.value#"><input type="checkbox" id="#element.name#.item.#index#.check" class="check_icon" '+' #item.checked# /><span id="#element.name#.item.#index#.caption" style="line-height:#element.rowheight#">#item.list#</span></li>';$nim.HTML["editlist"]='<div id="#element.name#" type="editlist" form="<dlg.form>" #class# #parms# #events# #style#><ul id="#element.name#.items" class="edit_list item_center" type="edit" rowheight="#element.rowheight#" size="#element.listsize#" #element.multiselect# form="<dlg.form>" style="font:inherit;width:auto;height:99.6%;">#element.list#</ul></div>';$nim.HTML["edit-li"]='<li id="#element.name#.item.#index#" class="edit_item" type="editlist-item" form="<dlg.form>" style="color:inherit;height:auto;font:inherit;" value="#item.value#"><input type="textbox" id="#element.name#.item.#index#.edit" value="#item.list#" style="display:none;" class="edit_text" '+' /><span id="#element.name#.item.#index#.caption" style="color:inherit;background:inherit;line-height:#element.rowheight#">#item.list#</span></li>';$nim.HTML["treeview"]='<div id="#element.name#" type="treeview" form="<dlg.form>" #parms# #events# #style#><ul id="#element.name#.items" class="treeview_list" type="treeview" rowheight="#element.rowheight#" size="#element.listsize#" form="<dlg.form>" style="font:inherit;width:auto;height:99.6%;">#element.list#</ul></div>';$nim.HTML["treeview-group"]='<ul id="#element.name#.item.#index#.group" type="treeview" value="group" class="treeview_group" style="display:none;"></ul>';$nim.HTML["treeview-li"]='<li id="#element.name#.item.#index#" state="hide" type="treeview-item" form="<dlg.form>" style="display:block;color:inherit;background:inherit;height:auto;font:inherit;" itemData="" key="#index#" value="#item.value#">'+'<div id="#element.name#.item.#index#.selector" style="display:block;"><div id="#element.name#.item.#index#.folder" class="treeview_folder" style="display:inline-block;width:#element.rowheight#;height:#element.rowheight#;">'+'<div id="#element.name#.item.#index#.image" class="folder_image folder_item"></div></div>'+'<span id="#element.name#.item.#index#.caption" class="treeview_item" style="vertical-align:top;line-height:#element.rowheight#;">'+'#item.list#</span></div></li>';$nim.HTML["checkbox-center"]='<div id="#element.name#" type="checkbox" form="<dlg.form>" #class# #parms# #events# #style#><div id="#element.name#.grp" style="vertical-align:inherit;"><input id="#element.name##cdelim#check" type="checkbox" form="<dlg.form>" style="cursor:pointer;display:inline-block;vertical-align:inherit;">'+'<span id="#element.name##cdelim#caption" onclick="$nim.defaultTick(event)" form="<dlg.form>" style="font:inherit;pointer-events:none;display:inline;vertical-align:inherit;">#element.field#</span></div></div>';$nim.HTML["checkbox-right"]='<div id="#element.name#" type="checkbox" form="<dlg.form>" #class# #parms# #events# #style#><div id="#element.name#.grp" style="vertical-align:inherit;"><span id="#element.name##cdelim#caption" onclick="$nim.defaultTick(event)" type="checkbox" form="<dlg.form>" style="font:inherit;pointer-events:none;display:inline;vertical-align:inherit;">#element.field#</span>'+'<input id="#element.name##cdelim#check" type="checkbox" form="<dlg.form>" style="cursor:pointer;display:inline-block;vertical-align:inherit;"></div></div>';$nim.HTML["checkbox-left"]='<div id="#element.name#" type="checkbox" form="<dlg.form>" #class# #parms# #events# #style#><div id="#element.name#.grp" style="vertical-align:inherit;"><input id="#element.name##cdelim#check" type="checkbox" form="<dlg.form>" style="cursor:pointer;display:table-cell;vertical-align:inherit;">'+'<span id="#element.name##cdelim#caption" onclick="$nim.defaultTick(event)" form="<dlg.form>" style="font:inherit;pointer-events:none;display:inline;vertical-align:inherit;">#element.field#</span></div></div>';$nim.HTML["checkbox"]='<div id="#element.name#" type="checkbox" form="<dlg.form>" #class# #parms# #events# #style#><div id="#element.name#.grp" style="vertical-align:inherit;"><input id="#element.name##cdelim#check" type="checkbox" form="<dlg.form>" style="cursor:pointer;display:table-cell;vertical-align:inherit;">'+'<span id="#element.name##cdelim#caption" onclick="$nim.defaultTick(event)" form="<dlg.form>" style="font:inherit;pointer-events:none;display:inline;vertical-align:inherit;">#element.field#</span></div></div>';$nim.HTML["option-center"]='<div id="#element.name#" type="option" form="<dlg.form>" #class# #parms# #events# #style#><div id="#element.name#.grp" style="vertical-align:inherit;"><input id="#element.name##cdelim#tick" type="radio" form="<dlg.form>" #parms# style="cursor:pointer;display:table-cell;vertical-align:inherit;">'+'<span id="#element.name##cdelim#caption" onclick="$nim.defaultTick(event)" form="<dlg.form>" style="font:inherit;pointer-events:none;display:inline;vertical-align:inherit;">#element.field#</span></div></div>';$nim.HTML["option-right"]='<div id="#element.name#" type="option" form="<dlg.form>" #class# #parms# #events# #style#><div id="#element.name#.grp" style="vertical-align:inherit;"><span id="#element.name##cdelim#caption" onclick="$nim.defaultTick(event)" form="<dlg.form>" style="font:inherit;pointer-events:none;display:inline;vertical-align:inherit;">#element.field#</span>'+'<input id="#element.name##cdelim#tick" type="radio" form="<dlg.form>" #parms# style="cursor:pointer;display:inline-block;vertical-align:inherit;"></div></div>';$nim.HTML["option-left"]='<div id="#element.name#" type="option" form="<dlg.form>" #class# #parms# #events# #style#><div id="#element.name#.grp" style="vertical-align:inherit;"><input id="#element.name##cdelim#tick" type="radio" form="<dlg.form>" #parms# style="cursor:pointer;display:table-cell;vertical-align:inherit;">'+'<span id="#element.name##cdelim#caption" onclick="$nim.defaultTick(event)" form="<dlg.form>" style="font:inherit;pointer-events:none;display:inline;vertical-align:inherit;">#element.field#</span></div></div>';$nim.HTML["option"]='<div id="#element.name#" type="option" form="<dlg.form>" #class# #parms# #events# #style#><div id="#element.name#.grp" style="vertical-align:inherit;"><input id="#element.name##cdelim#tick" type="radio" form="<dlg.form>" #parms# style="cursor:pointer;display:table-cell;vertical-align:inherit;">'+'<span id="#element.name##cdelim#caption" onclick="$nim.defaultTick(event)" form="<dlg.form>" style="font:inherit;pointer-events:none;display:inline;vertical-align:inherit;">#element.field#</span></div></div>';$nim.HTML["optiongrp-center"]='<div id="#element.name#" type="optiongrp" form="<dlg.form>" #class# #parms# #events# #style#>#element.option#</div>';$nim.HTML["optiongrp-right"]='<div id="#element.name#" type="optiongrp" form="<dlg.form>" #class# #parms# #events# #style#>#element.option#</div>';$nim.HTML["optiongrp-left"]='<div id="#element.name#" type="optiongrp" form="<dlg.form>" #class# #parms# #events# #style#>#element.option#</div>';$nim.HTML["optiongrp"]='<div id="#element.name#" type="optiongrp" form="<dlg.form>" #class# #parms# #events# #style#>#element.option#</div>';$nim.HTML["progress"]='<div id="#element.name#" type="progress" form="<dlg.form>" #class# #parms# #events# #style#><progress id="#element.name##cdelim#bar" #element.field# style="position:relative;height:100%;left:-1px;width:calc(100% + 2px);vertical-align:top;" #parms#></progress></div>';if($nim.ab){$nim.HTML["demo"]='<img id="#element.name#.demo" dock="!!!!" src="'+$nim.home_server+'media/demo.png" style="position:relative;left:-10%;top:40%;height:20%;width:120%;opacity:.3;transform:rotate(-25deg);pointer-events:none;z-index:'+$nim.ab.MOVE2TOP+'">';} 


