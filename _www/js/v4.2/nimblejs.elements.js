// NimbleJS Build #381 on 05/02/2024 10:02 AM.
'use strict';$nim.Elements=cU({attachList:function(id,val){if(!id|| !val)return;var arr=$f.list.get(val),bq=id.resolveName();var html,name,ok=false;var cc=$f.af(bq.Form,bq.Control);var tmp=(arr.length>0)?arr:(Array.isArray(val)&&val[0].caption)?val:[];if(tmp.length>0){arr=tmp.map(function(aM){return aM.caption;});ok=true;}else if(Array.isArray(val)){arr=val;ok=true;}else if(val.indexOf(';')> -1){arr=val.split(';');ok=true;}if(ok&&cc&&cc.tagName=='INPUT'&&arr.length>0){name=(bq.Form+'-'+bq.Control+'.data').toLowerCase();html="<datalist id='"+name+"'>";arr.forEach(function(aM){html+="<option value = '"+aM+"'>";});html+="</datalist>";$f.inserthtml(id,html);cc.setAttribute("list",name);}},elementicon:function(rec,icls,ilft,itop,iwid,ihgt){return{app:rec[0],level:rec[1],type:'icon',name:rec[2]+"_icon",field:rec[3],caption:rec[4],"class":icls,exe:rec[5],tip:rec[6],l:ilft,t:itop,w:iwid,h:ihgt};},fetchElement:function(elmTyp){if(typeof($nim.HTML[elmTyp])==$nim._u){var cgi_server=$nim.cK.glb_server;if($nim.cK.glb_server=="(local)"){cgi_server="";}if(cgi_server===''){cgi_server=$nim.home_server;}CGI.Get(cgi_server+'cgi/'+$nim.file[globals.cgiVer].menu+'?cmd=template&elm='+elmTyp+'&uid='+$nim.security.login+'&eml='+$nim.security.email,false,function(){var bx=CGI.data.responseText;bx=KERNEL.cleanText(bx);if(CGI.data.responseText!==''){$nim.HTML[elmTyp]=bx;}});}},load:function(){DESKTOP.Hide('icon.body');if($nim.cn.preload.disabledesktop==true){KERNEL.DisableDesktop();}CGI.Clear();function dz(elmTyp){if(typeof($nim.HTML[elmTyp])==$nim._u){var cgi_server=$nim.cK.glb_server;if($nim.cK.glb_server=="(local)"){cgi_server="";}if(cgi_server===''){cgi_server=$nim.home_server;}var func=function(cur,max){var pos=Math.round(cur/max*100);FORMS.SetProp('loading','prg.bar','value',pos);FORMS.Refresh('loading','prg');};CGI.Add(elmTyp,cgi_server+'cgi/'+$nim.file[globals.cgiVer].menu+'?cmd=template&elm='+elmTyp+'&uid='+$nim.security.login+'&eml='+$nim.security.email,false,'element',func);}};if($nim.cn.preload.extendedcontrols==true){if(typeof($nim.HTML['audio'])==$nim._u){dz("audio");}if(typeof($nim.HTML['video'])==$nim._u){dz("video");}if(typeof($nim.HTML['icon'])==$nim._u){dz("icon");}if(typeof($nim.HTML['up-down'])==$nim._u){dz("up-down");}if(typeof($nim.HTML['slider'])==$nim._u){dz("slider");}if(typeof($nim.HTML['iframe'])==$nim._u){dz("iframe");}if(typeof($nim.HTML['customdate'])==$nim._u){dz("customdate");}if(typeof($nim.HTML['custominput'])==$nim._u){dz("custominput");}}if($nim.cn.preload.standardcontrols==true){if(typeof($nim.HTML['tab-pan'])==$nim._u){dz("tab-pan");}if(typeof($nim.HTML['tab-li'])==$nim._u){dz("tab-li");}if(typeof($nim.HTML['image'])==$nim._u){dz("image");}if(typeof($nim.HTML['embed'])==$nim._u){dz("embed");}if(typeof($nim.HTML['canvas'])==$nim._u){dz("canvas");}if(typeof($nim.HTML['imgbuttonx'])==$nim._u){dz("imgbuttonx");}if(typeof($nim.HTML['multilist'])==$nim._u){dz("multilist");}if(typeof($nim.HTML['tab'])==$nim._u){dz("tab");}}CGI.data.LoadComplete=function(){FORMS.Unload("loading");if($nim.Start_Desktop){$nim.Start_Desktop();CGI.Clear();if($nim.cn.preload.disabledesktop==false){KERNEL.EnableDesktop();}else{KERNEL.DisableDesktop();}}};var O=$nim.ax.getWindowDimensions();FORMS.Surface("loading",(O.width/2-45),(O.height/2-33),100,66,null);FORMS.Add("loading","img","imagex","media/loading.gif",30,10,30,30);FORMS.Refresh('loading','img');FORMS.Add("loading","prg","progress","",10,50,70,6);FORMS.SetProp('loading','prg.bar','value','0');FORMS.Refresh('loading','prg');if(CGI.data.list.length>0){CGI.LoadItem(0);}else{var func=CGI.data.LoadComplete;CGI.data.LoadComplete=null;func();}},make:function(bh){var dm,x=0,pos=0,w=0,h=0,prnt_zindx='',ecaption,key,eid,etyp,eCfg,eCls,eEvnt,cV,elem_sel='',elem_ftr='',bQ='',aN='',elem_event='',bv='',aP='',bI='',actionAry=[],hotkeyAry=[],ct='',tabH=$nim.cn.dialog.tab_height;var cD=$nim.G.V(bh.parent);var sprop,pprop,cprop;if(typeof(bh.parms['origSize'])!=$nim._u){pos=bh.parms['origSize'].split(',');w=dA(pos[2]);h=dA(pos[3]);}if(['zone','div'].indexOf(bh.type)== -1){if(typeof($nim.HTML[bh.type])==$nim._u){$nim.Elements.fetchElement(bh.type);}}cV=$nim.HTML[bh.type];cV=$nim.aX("#element.osize#",'',cV);if(typeof(cV)!=$nim._u){switch(bh.type){case "tab":if(typeof($nim.HTML['tab-li'])==$nim._u){$nim.Elements.fetchElement('tab-li');}bv='';dm={};for(x=1;x<=bh.titles.length;x++){bv+=$nim.HTML['tab-li'];dm["#x#"]=x;if(x==1){dm["#element.active#"]='nim-active';}else{dm["#element.active#"]='';}dm["#element.name#"]=bh.name;dm["#element.title.length#"]=bh.titles.length;dm["#element.titles#"]=bh.titles[x-1];dm["#title.h#"]=(tabH);dm["#element.osize#"]='';bv=$nim.aX(dm,null,bv);}if(typeof($nim.HTML['tab-pan'])==$nim._u){$nim.Elements.fetchElement('tab-pan');}aP='';dm={};for(x=1;x<=bh.titles.length;x++){aP+=$nim.HTML['tab-pan'];dm["#x#"]=x;if(x==1){dm["#element.active#"]='nim-active';}else{dm["#element.active#"]='';}dm["#element.name#"]=bh.name;dm["#element.form#"]=bh.parms['form'];dm["#element.osize#"]='';aP=$nim.aX(dm,null,aP);}dm={};dm["#element.tabs#"]=bv;dm["#element.tabpanes#"]=aP;dm["#var.w#"]=w;dm["#var.h#"]=h;dm["#btn.t#"]=(tabH/2);dm["#btn.h#"]=(tabH-6);dm["#title.h#"]=(tabH);dm["#panes.t#"]=(tabH-1);dm["#body.h#"]=(h-(tabH+2));dm["#clip.w#"]=(w>h)?w:h;cV=$nim.aX(dm,null,cV);break;case "menu":var blDisable=false,barCfg='000',blAutoHide=false;bI='';for(x=0;x<bh.field.length;x++){ecaption=bh.field[x].caption;key=(ecaption.indexOf('&')> -1&&ecaption.split('&')[1])?ecaption.split('&')[1].left(1):'';if(key){ecaption=$nim.aX('&'+key,'<u>'+key+'</u>',ecaption);key='Alt+'+key;}eid=bh.name+"-"+bh.field[x].id;eCls="item";etyp='menu';eCfg=bh.field[x].settings?bh.field[x].settings:'000';eEvnt=bh.field[x].click.toLowerCase();if(eEvnt.indexOf('.open')> -1){etyp='submenu';}if(ecaption=="-"){eCls="sub-vdivider";ecaption="&nbsp;&nbsp;";bI+='<li type="'+etyp+'" id="'+eid+'.item" class="'+eCls+'" settings="'+eCfg+'" onclick="'+bh.field[x].click+'" style="font-family:#menu.font#;font-size:#menu.fontsize#;opacity:1;color:#menu.forecolor#;">';bI+=ecaption+'</li>';}else{bI+='<li type="'+etyp+'" id="'+eid+'.item" class="'+eCls+'" settings="'+eCfg+'" onclick="'+bh.field[x].click+'" style="font-family:#menu.font#;border-radius:11px;font-size:#menu.fontsize#;opacity:1;color:#menu.forecolor#;">';bI+=(eCfg.split('')[0]=='1')?'<input id="'+eid+'.check" type="checkbox" style="cursor:pointer;display:table-cell;padding-right:8px;vertical-align:inherit;">':'';bI+=(bh.field[x].image)?'<img id="'+eid+'.image" src="'+bh.field[x].image+'" style="pointer-events:none;float:left;position:relative;margin-right:8px;top:0px;width:'+(defaults.menus.menu_height-4)+'px;height:'+(defaults.menus.menu_height-4)+'px;">':'';bI+=ecaption;if(eEvnt.indexOf('.open')> -1){bI+='<img type="'+etyp+'" id="'+eid+'.arrow" src="media/icons/panel_open.gif" onclick="'+bh.field[x].click+'" style="pointer-events:none;float:right;position:relative;left:8px;top:3px;width:'+Math.floor(defaults.menus.menu_height/2)+'px;height:'+Math.floor(defaults.menus.menu_height/2)+'px;"></li>';}else{bI+='</li>';}if(bh.field.length==1){if(eCfg.split('')[1]=='1'){blDisable=true;}if(eCfg.split('')[2]=='1'){blAutoHide=true;barCfg=eCfg;}}else{if(blDisable){actionAry.push({action:'disable',item:(eid+".item").resolveName()});}if(eCfg.split('')[2]=='1'){blAutoHide=true;barCfg=eCfg;}}if(key){hotkeyAry.push({key:key,item:(eid+".item").resolveName()});}}}if(bh.field.length==1){if(blDisable){actionAry.push({action:'disable',item:bh.name.resolveName()});}}if(blAutoHide){actionAry.push({action:'autohide',item:bh.name.resolveName()});}if(blAutoHide){actionAry.push({action:'settings',item:bh.name.resolveName(),value:barCfg});}cV=$nim.aX({"#element.menu#":bI,"#menu.height#":defaults.menus.menu_height+'px'},null,cV);break;case "submenu":var cssadj='';bI='';for(x=0;x<bh.field.length;x++){ecaption=bh.field[x].caption;key=(ecaption.indexOf('&')> -1&&ecaption.split('&')[1])?ecaption.split('&')[1].left(1):'';if(key){ecaption=$nim.aX('&'+key,'<u>'+key+'</u>',ecaption);key='Alt+'+key;}eid=bh.name+"-"+bh.field[x].id;eCls="sub-item";etyp='menu';eCfg=bh.field[x].settings?bh.field[x].settings:'000';eEvnt=bh.field[x].click.toLowerCase();if(eEvnt.indexOf('.open')> -1){etyp='submenu';}if(ecaption=="-"){eCls="sub-hdivider";ecaption="&nbsp;&nbsp;";bI+='<li type="'+etyp+'" id="'+eid+'.item" class="'+eCls+'" settings="'+eCfg+'" depth="'+bh.field[x].depth+'" onclick="'+bh.field[x].click+'" style="#highlight#;font-family:#subitem.font#;opacity:1;font-size:#subitem.fontsize#;">';bI+=ecaption+'</li>';}else{bI+='<li type="'+etyp+'" id="'+eid+'.item" class="'+eCls+'" settings="'+eCfg+'" depth="'+bh.field[x].depth+'" onclick="'+bh.field[x].click+'" style="#highlight#;font-family:#subitem.font#;border-radius:11px;opacity:1;font-size:#subitem.fontsize#;">';bI+=(eCfg.split('')[0]=='1')?'<input id="'+eid+'.check" type="checkbox" style="cursor:pointer;display:table-cell;float:right;margin-right:-9px;vertical-align:inherit;">':'';bI+=(bh.field[x].image)?'<img id="'+eid+'.image" src="'+bh.field[x].image+'" style="pointer-events:none;float:left;position:relative;margin-right:8px;top:0px;width:'+(defaults.menus.menu_height-6)+'px;height:'+(defaults.menus.menu_height-6)+'px;">':'';bI+=ecaption;if(eEvnt.indexOf('.open')> -1){bI+='<img type="'+etyp+'" id="'+eid+'.arrow" src="media/icons/panel_close.gif" onclick="'+bh.field[x].click+'" style="pointer-events:none;float:right;position:relative;left:8px;top:1px;width:'+(defaults.menus.menu_height/2)+'px;height:'+(defaults.menus.menu_height/2)+'px;"></li>';}else{bI+='</li>';}cV=$nim.aX("#element.depth#",bh.field[x].depth,cV);}if(eCfg.split('')[1]=='1'){actionAry.push({action:'disable',item:(eid+".item").resolveName()});}if(eCfg.split('')[2]=='1'){cssadj='background-image:linear-gradient(to right, '+defaults.menus.subitem_highlight1+' 0%, '+defaults.menus.subitem_highlight2+' 100%)';bI=$nim.aX('#highlight#',cssadj,bI);}else{bI=$nim.aX('#highlight#','',bI);}if(key){hotkeyAry.push({key:key,item:(eid+".item").resolveName()});}}cV=$nim.aX({"#element.submenu#":bI,"#menu.height#":defaults.menus.menu_height+'px'},null,cV);break;case "option":case "option-center":case "option-right":cV=$nim.aX("#element.name#",bh.name,cV);break;case "optiongrp":case "optiongrp-center":case "optiongrp-right":bI='';for(x=0;x<bh.field.caption.length;x++){bI=$nim.aX("#x#",x,bI);bI+='<div style="display:block;padding-top:4px;line-height:75%;">';if(bh.type=='option-right'){bI+='<input name="'+bh.field.name+'" value="'+bh.field.value[x]+'" type="radio" style="cursor:pointer;display:inline;float:right;vertical-align:inherit;'+$nim.aq.bF(37)+';">'+'<'+$nim.aq.bF(36)+' id="'+bh.name+$nim.aY+'caption" style="display:block;padding-top:4px;vertical-align:inherit;'+$nim.aq.bF(37)+';">'+bh.field.caption[x]+'</'+$nim.aq.bF(36)+'>';}else{bI+='<input name="'+bh.field.name+'" value="'+bh.field.value[x]+'" type="radio" style="cursor:pointer;display:inline;float:left;vertical-align:inherit;'+$nim.aq.bF(37)+';">'+'<'+$nim.aq.bF(36)+' id="'+bh.name+$nim.aY+'caption" style="display:block;padding-top:4px;vertical-align:inherit;'+$nim.aq.bF(37)+';">'+bh.field.caption[x]+'</'+$nim.aq.bF(36)+'>';}bI+='</div>';}cV=$nim.aX("#element.option#",bI,cV);break;case "panellist":case "panel-list":aP='';for(x=0;x<bh.field.titles.length;x++){aP+=$nim.aq.bF(30)+' lock-width="true" style="background-color:#eee;padding:6px 0px;'+$nim.aq.bF(37)+';border:1px solid rgba(20, 20, 20, 0.25);font-weight:bold;height:16px;">';aP+='<'+$nim.aq.bF(36)+' id="'+bh.name+$nim.aY+x+$nim.aY+'caption">'+bh.field.titles[x]+'</'+$nim.aq.bF(36)+'>';aP+=$nim.aq.bF(35)+' id="'+bh.name+$nim.aY+x+$nim.aY+'button" toggle="close" expand="'+(bh.field.height[x]-20)+'" src="media/icons/panel_open.gif" style="float:left;"><'+$nim.aq.bF(36)+'>&nbsp;&nbsp;</'+$nim.aq.bF(36)+'>';aP+=$nim.aq.bF(34);aP+=$nim.aq.bF(30)+' id="'+bh.name+$nim.aY+x+$nim.aY+'body" lock-width="true" style="box-sizing: border-box;width:100%;height:'+(bh.field.height[x]-20)+'px;background-color:#fff;overflow:hidden;padding:0px 6px;border:1px solid rgba(20, 20, 20, 0.25);vertical-align:top;">'+bh.field.caption[x]+$nim.aq.bF(34);}cV=$nim.aX({"#element.panes#":aP,"#var.w#":w,"#var.h#":h},null,cV);break;case "slider":case "date":case "date-picker":case "customdate":case "custominput":case "up-down":cV=$nim.aX({"#element.field#":bh.field,"#var.w#":w,"#var.h#":h},null,cV);break;case "progress":cV=$nim.aX({"#element.field#":bh.field,"#var.w#":w,"#var.h#":h},null,cV);break;case "panel":if(!bh.field.height||bh.field.height>h){bh.field.height=h-42;}cV=$nim.aX({"#x#":"","#var.w#":w,"#var.h#":h},null,cV);break;case "video":case "embed":case "canvas":cV=$nim.aX({"#x#":"","#var.w#":w,"#var.h#":h},null,cV);break;default:break;}if(cV.indexOf('#element.menu#')> -1){bI=KERNEL.getMenuOptions(bh.field);dm={"#element.menu#":bI,"#element.listsize#":'6'};cV=$nim.aX(dm,null,cV);}if(cV.indexOf('#element.list#')> -1){bI=KERNEL.getListOptions(bh.type,bh.field);bh.field.rowheight=bh.field.rowheight?bh.field.rowheight:24;if(bh.field.multiselect){elem_sel='multiple';}cV=$nim.aX({"#element.list#":bI,"#element.listsize#":bh.field.listsize,"#element.rowheight#":bh.field.rowheight+'px',"#element.multiselect#":elem_sel},null,cV);}dm={};if(cV.indexOf('#parent.zindex#')> -1){if(cD!==null){prnt_zindx=cD.style['z-index']?cD.style['z-index']:"";if(prnt_zindx!==''){prnt_zindx="z-index:"+prnt_zindx+";";dm["#parent.zindex#"]=prnt_zindx;}}else{dm["#parent.zindex#"]="";}}dm["#element.name#"]=bh.name;cV=$nim.aX("#element.name#",bh.name,cV);if(typeof(bh.parms['form'])!=$nim._u){dm["<dlg.form>"]=bh.parms['form'];}if(bh.type=='menu'||bh.type=='submenu'){if(cV.indexOf('#cdelim#')> -1){dm["#cdelim#"]=$nim.aY;}if(cV.indexOf('#menu.bordercolor#')> -1){dm["#menu.bordercolor#"]=$nim.cn.menus.menu_bordercolor;}if(cV.indexOf('#menu.backcolor#')> -1){dm["#menu.backcolor#"]=$nim.cn.menus.menu_backcolor;}if(cV.indexOf('#menu.forecolor#')> -1){dm["#menu.forecolor#"]=$nim.cn.menus.menu_forecolor;}if(cV.indexOf('#menu.font#')> -1){dm["#menu.font#"]=$nim.cn.menus.menu_fontfamily;}if(cV.indexOf('#menu.fontsize#')> -1){dm["#menu.fontsize#"]=$nim.cn.menus.menu_fontsize;}if(cV.indexOf('#submenu.backcolor#')> -1){dm["#submenu.backcolor#"]=$nim.cn.menus.submenu_backcolor;}if(cV.indexOf('#submenu.bordercolor#')> -1){dm["#submenu.bordercolor#"]=$nim.cn.menus.submenu_bordercolor;}if(cV.indexOf('#subitem.backcolor#')> -1){dm["#subitem.backcolor#"]=$nim.cn.menus.subitem_backcolor;}if(cV.indexOf('#subitem.forecolor#')> -1){dm["#subitem.forecolor#"]=$nim.cn.menus.subitem_forecolor;}if(cV.indexOf('#subitem.font#')> -1){dm["#subitem.font#"]=$nim.cn.menus.subitem_fontfamily;}if(cV.indexOf('#subitem.fontsize#')> -1){dm["#subitem.fontsize#"]=$nim.cn.menus.subitem_fontsize;}}else{if(cV.indexOf('#cdelim#')> -1){dm["#cdelim#"]=$nim.aY;}if(cV.indexOf('#element.form#')> -1){dm["#element.form#"]=bh.parent;}if(cV.indexOf('#element.tip#')> -1){dm["#element.tip#"]=bh.tip;}if(cV.indexOf('#element.caption#')> -1){dm["#element.caption#"]=bh.caption;}if(cV.indexOf('#element.field#')> -1){dm["#element.field#"]=bh.field;}if(cV.indexOf('#element.field.filetype#')> -1){dm["#element.field.filetype#"]=bh.field.filetype;}if(cV.indexOf('#element.field.source#')> -1){dm["#element.field.source#"]=bh.field.source;}if(cV.indexOf('#element.field.image#')> -1){dm["#element.field.image#"]=bh.field.image;}if(cV.indexOf('#element.field.caption#')> -1){dm["#element.field.caption#"]=bh.field.caption;}if(cV.indexOf('#element.field.titles#')> -1){dm["#element.field.titles#"]=bh.field.titles;}if(cV.indexOf('#element.field.height#')> -1){dm["#element.field.height#"]=bh.field.height||h;}}if(cV!==''){var inval;if(!bh.style.left)bh.style.left='0px';if(!bh.style.top)bh.style.top='0px';for(sprop in bh.style){inval=bh.style[sprop];aN+=sprop+':'+bh.style[sprop]+';';}aN='style="'+aN+'"';dm[$nim.aq.bF(28)]=aN;for(pprop in bh.parms){inval=bh.parms[pprop];switch(pprop){case "origsize":case "dlg_style":case "crlf":break;default:bQ+=pprop+'="'+bh.parms[pprop]+'" ';break;}}dm[$nim.aq.bF(29)]=bQ;inval="";if(typeof(bh["class"])!=$nim.aq.bF(4)){inval=bh["class"];}dm[$nim.aq.bF(27)]=inval;for(cprop in bh.events){inval=bh.events[cprop];elem_event+=cprop+'="'+bh.events[cprop]+'" ';}dm[$nim.aq.bF(25)]=bh.name;dm[$nim.aq.bF(26)]=elem_event;cV=$nim.aX(dm,null,cV);ct=cV+elem_ftr;}}if(actionAry.length>0||hotkeyAry.length>0){$nim.Menu._configure(actionAry,hotkeyAry);}return ct;}});$nim.FontType=function(ctype,bh){switch(ctype){case "table-header":bh.style['font-family']='verdana';bh.style['font-style']='normal';bh.style['font-size']='0.875em';bh.style['color']='rgb(100,100,100)';break;case "table-content":bh.style['font-family']='courier';bh.style['font-style']='normal';bh.style['font-size']='0.675em';bh.style['color']='rgb(100,100,100)';break;case "panellist":case "panel-list":case "panel":bh.style['font-family']='verdana';bh.style['font-style']='normal';bh.style['font-size']='0.575em';bh.style['color']='rgb(20,20,20)';break;default:break;}};cU($nim.G); 
